<!DOCTYPE html><html lang="en"><head><!-- hexo injector head_begin start --><!-- Google tag (gtag.js) begins-->
    <script async="" src="https://www.googletagmanager.com/gtag/js?id=G-3DZR3TQYCY"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
    
      gtag('config', 'G-3DZR3TQYCY');
    </script>
    <!-- Google tag (gtag.js) ends-->
    <!-- hexo injector head_begin end -->
    <meta charset="utf-8">
    <!-- security headers starts -->
    <!-- meta http-equiv="content-security-policy" content="script-src 'sha256-B5nfCL2Dym3Ba4YJFI7wB3f4vtClbrYJZ32A5erBEdg=' 'sha256-lJjk3/dvd+wXqRFjV7T5L/nXJXr5NjUjmsKSPEe+ass=';" -->
    <!-- security headers ends -->
    <!-- favicon starts -->    
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <!-- favicon ends -->
    

    
    <title>Understanding OAuth 2.0: The Authorization Framework Powering Modern APIs | Decoding Digital Anomalies</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    
    <meta name="keywords" content="API,Authentication,OAuth,Security">
    
    
    <meta name="description" content="OAuth 2.0 enables secure delegated access without sharing passwords. Learn how authorization flows work, common pitfalls, and why OAuth is not authentication.">
<meta property="og:type" content="article">
<meta property="og:title" content="Understanding OAuth 2.0: The Authorization Framework Powering Modern APIs">
<meta property="og:url" content="https://neo01.com/2022/08/Understanding-OAuth-2.0/index.html">
<meta property="og:site_name" content="Decoding Digital Anomalies">
<meta property="og:description" content="OAuth 2.0 enables secure delegated access without sharing passwords. Learn how authorization flows work, common pitfalls, and why OAuth is not authentication.">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2022-08-15T16:00:00.000Z">
<meta property="article:modified_time" content="2025-10-27T14:05:01.632Z">
<meta property="article:author" content="Neo Alienson">
<meta property="article:tag" content="API">
<meta property="article:tag" content="Authentication">
<meta property="article:tag" content="OAuth">
<meta property="article:tag" content="Security">
<meta name="twitter:card" content="summary">
    
            <link rel="alternate" href="/atom.xml" title="Decoding Digital Anomalies" type="application/atom+xml">
    

    

    

    

    

    

    

    
    
        


    
    
        


    

<!-- hexo injector head_end start --><link rel="stylesheet" type="text/css" href="/css/bundle.css"><script type="text/javascript" src="/js/bundle_first.js"></script><!-- hexo injector head_end end --><meta name="generator" content="Hexo 7.3.0">  <link rel="canonical" href="https://neo01.com/2022/08/Understanding-OAuth-2.0">
  <link rel="alternate" hreflang="en" data-canonical="true" href="https://neo01.com/2022/08/Understanding-OAuth-2.0">
  <link rel="alternate" hreflang="zh-TW" href="https://neo01.com/zh-TW/2022/08/Understanding-OAuth-2.0">
  <link rel="alternate" hreflang="zh-CN" href="https://neo01.com/zh-CN/2022/08/Understanding-OAuth-2.0">
  <link rel="alternate" hreflang="ja" href="https://neo01.com/ja/2022/08/Understanding-OAuth-2.0">
<style id="admonition-styles">.admonition {
  margin: 1em 0;
  padding: 0rem;
  border-left: 0.3rem solid;
  border-radius: 0.4rem;
  background-color: #f9f9f9;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.04);
  overflow: hidden;
  page-break-inside: avoid;
}

.admonition-title {
  display: flex;
  align-items: center;
  font-weight: 600;
  padding: 0rem 1rem 0.1rem 0.75rem;
  font-size: 1.05em;
  background-color: rgba(0, 0, 0, 0.03);
  border-top-left-radius: 0.4rem;
  border-top-right-radius: 0.4rem;
  margin: 0 !important;
}

.admonition-icon {
  font-size: 1.2em;
  margin-right: 0.6rem;
  opacity: 0.85;
  margin-top: 0.1rem;
}

/* ÂÜÖÂÆπÂå∫Âüü margin */
.admonition > *:not(.admonition-title) {
  margin: 0.6rem 1rem 0.6rem 1rem;
}

/* NOTE Á±ªÂûã */
.admonition.anote {
  border-color: #448aff;
}
.admonition.anote > .admonition-title {
  background-color: #448aff1a;
  color: #2962ff;
}

/* INFO / TODO Á±ªÂûã */
.admonition.info,
.admonition.todo {
  border-color: #00b8d4;
}
.admonition.info > .admonition-title,
.admonition.todo > .admonition-title {
  background-color: rgba(0, 184, 212, 0.1);
  color: #007c91;
}

/* Ë≠¶ÂëäÁ±ª */
.admonition.warning,
.admonition.attention,
.admonition.caution {
  border-color: #ff9100;
}
.admonition.warning > .admonition-title,
.admonition.attention > .admonition-title,
.admonition.caution > .admonition-title {
  background-color: rgba(255, 145, 0, 0.1);
  color: #c66900;
}

/* ÈîôËØØÁ±ª */
.admonition.failure,
.admonition.missing,
.admonition.fail,
.admonition.error,
.admonition.danger,
.admonition.bug {
  border-color: #ff5252;
}
.admonition.failure > .admonition-title,
.admonition.missing > .admonition-title,
.admonition.fail > .admonition-title,
.admonition.error > .admonition-title,
.admonition.danger > .admonition-title,
.admonition.bug > .admonition-title {
  background-color: rgba(255, 82, 82, 0.1);
  color: #b71c1c;
}

/* TIP Á±ªÂûã */
.admonition.tip {
  border-color: #00bfa5;
}
.admonition.tip > .admonition-title {
  background-color: #00bfa51a;
  color: #00796b;
}

/* SUCCESS Á±ªÂûã */
.admonition.success {
  border-color: #00c853;
}
.admonition.success > .admonition-title {
  background-color: #00c8531a;
  color: #2e7d32;
}

/* QUESTION Á±ªÂûã */
.admonition.question {
  border-color: #64dd17;
}
.admonition.question > .admonition-title {
  background-color: #64dd171a;
  color: #558b2f;
}

/* EXAMPLE Á±ªÂûã */
.admonition.example {
  border-color: #7c4dff;
}
.admonition.example > .admonition-title {
  background-color: #7c4dff1a;
  color: #512da8;
}

/* QUOTE Á±ªÂûã */
.admonition.quote {
  border-color: #9e9e9e;
}
.admonition.quote > .admonition-title {
  background-color: #9e9e9e1a;
  color: #424242;
}

/*ÈªëÊöóÊ®°Âºè*/
/* Â§úÈó¥Ê®°ÂºèÂü∫Á°ÄÊ†∑Âºè */
[data-theme="dark"] .admonition {
  background-color: #1e1e1e;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.4);
}

[data-theme="dark"] .admonition-title {
  background-color: rgba(255, 255, 255, 0.05);
}

/* anote */
[data-theme="dark"] .admonition.anote {
  border-color: #82b1ff;
}
[data-theme="dark"] .admonition.anote > .admonition-title {
  background-color: #82b1ff1a;
  color: #bbdefb;
}

/* tip */
[data-theme="dark"] .admonition.tip {
  border-color: #64ffda;
}
[data-theme="dark"] .admonition.tip > .admonition-title {
  background-color: #64ffda1a;
  color: #1de9b6;
}

/* success */
[data-theme="dark"] .admonition.success {
  border-color: #69f0ae;
}
[data-theme="dark"] .admonition.success > .admonition-title {
  background-color: #69f0ae1a;
  color: #00e676;
}

/* question */
[data-theme="dark"] .admonition.question {
  border-color: #b2ff59;
}
[data-theme="dark"] .admonition.question > .admonition-title {
  background-color: #b2ff591a;
  color: #aeea00;
}

/* example */
[data-theme="dark"] .admonition.example {
  border-color: #b388ff;
}
[data-theme="dark"] .admonition.example > .admonition-title {
  background-color: #b388ff1a;
  color: #b39ddb;
}

/* quote */
[data-theme="dark"] .admonition.quote {
  border-color: #bdbdbd;
}
[data-theme="dark"] .admonition.quote > .admonition-title {
  background-color: #bdbdbd1a;
  color: #eeeeee;
}

/* warning / attention / caution */
[data-theme="dark"] .admonition.warning,
[data-theme="dark"] .admonition.attention,
[data-theme="dark"] .admonition.caution {
  border-color: #ffb300;
}
[data-theme="dark"] .admonition.warning > .admonition-title,
[data-theme="dark"] .admonition.attention > .admonition-title,
[data-theme="dark"] .admonition.caution > .admonition-title {
  background-color: #ffb3001a;
  color: #ffe082;
}

/* error / fail / failure / bug / danger / missing */
[data-theme="dark"] .admonition.error,
[data-theme="dark"] .admonition.fail,
[data-theme="dark"] .admonition.failure,
[data-theme="dark"] .admonition.bug,
[data-theme="dark"] .admonition.missing,
[data-theme="dark"] .admonition.danger {
  border-color: #ef5350;
}
[data-theme="dark"] .admonition.error > .admonition-title,
[data-theme="dark"] .admonition.fail > .admonition-title,
[data-theme="dark"] .admonition.failure > .admonition-title,
[data-theme="dark"] .admonition.bug > .admonition-title,
[data-theme="dark"] .admonition.missing > .admonition-title,
[data-theme="dark"] .admonition.danger > .admonition-title {
  background-color: #ef53501a;
  color: #ff8a80;
}</style><script id="mermaid-scripts" src="/cache/mermaid.min.local.js"></script>
<script>mermaid.initialize({theme: 'default'});</script></head>

<body>
    <div id="wrap">
        <header id="header">
    <div id="header-outer" class="outer">
        <div class="container">
            <div class="container-inner">
                <div id="header-title">
                    <h1 class="logo-wrap">
                        <a href="/" title="Homepage" class="logo"></a>
                    </h1>
                        <h2 class="subtitle-wrap">
                            <p class="title">Decoding Digital Anomalies</p>
                          <p class="subtitle">Sometimes the feature is the bug in the digital rabbit hole, and vice versa</p>
                        </h2>
                    <div id="lang-selector">
                        <span class="lang-icon">üåê</span>
                        
                                <a href="/zh-TW/2022/08/Understanding-OAuth-2.0/" class="lang-link">ÁπÅÈ´î‰∏≠Êñá</a>
<span class="lang-sep">|</span>                                <a href="/zh-CN/2022/08/Understanding-OAuth-2.0/" class="lang-link">ÁÆÄ‰Ωì‰∏≠Êñá</a>
<span class="lang-sep">|</span>                                <a href="/ja/2022/08/Understanding-OAuth-2.0/" class="lang-link">Êó•Êú¨Ë™û</a>
                    </div>
                </div>
                <div id="header-inner" class="nav-container">
                    <a id="main-nav-toggle" class="nav-icon fa fa-bars"></a>
                    <div class="nav-container-inner">
                        <ul id="main-nav">
                            
                                <li class="main-nav-list-item">
                                    <a class="main-nav-list-link" href="/">Home</a>
                                </li>
                                                                    <ul class="main-nav-list"><li class="main-nav-list-item"><a class="main-nav-list-link" href="/categories/AI/">AI</a><ul class="main-nav-list-child"><li class="main-nav-list-item"><a class="main-nav-list-link" href="/categories/AI/Art-Gallery/">Art Gallery</a></li></ul></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/categories/Architecture/">Architecture</a></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/categories/Cybersecurity/">Cybersecurity</a></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/categories/Development/">Development</a></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/categories/Misc/">Misc</a></li></ul>
                                <li class="main-nav-list-item">
                                    <a class="main-nav-list-link" href="/about-me">About</a>
                                </li>
                            
                        </ul>
                        <nav id="sub-nav">
                            <div id="search-form-wrap">

    <form class="search-form">
        <input type="text" class="ins-search-input search-form-input" id="search-form-input" placeholder="Search">
        <button type="submit" title="Search" class="search-form-submit"></button>
    </form>
    <div class="ins-search">
    <div class="ins-search-mask"></div>
    <div class="ins-search-container">
        <div class="ins-input-wrapper">
            <input type="text" class="ins-search-input" id="ins-search-input" placeholder="Type something...">
            <span class="ins-close ins-selectable"><i class="fa fa-times-circle"></i></span>
        </div>
        <div class="ins-section-wrapper">
            <div class="ins-section-container"></div>
        </div>
    </div>
</div>
<script integrity="sha256-B5nfCL2Dym3Ba4YJFI7wB3f4vtClbrYJZ32A5erBEdg=">
(function (window) {
    var INSIGHT_CONFIG = {
        TRANSLATION: {
            POSTS: 'Posts',
            PAGES: 'Pages',
            CATEGORIES: 'Categories',
            TAGS: 'Tags',
            UNTITLED: '(Untitled)',
        },
        ROOT_URL: '/',
        CONTENT_URL: '/content.json',
        LANG: 'en',
    };
    window.INSIGHT_CONFIG = INSIGHT_CONFIG;
})(window);
</script>




</div>
                        </nav>
                    </div>
                </div>
            </div>
        </div>
    </div>
</header>
        <div class="container">
            <div class="main-body container-inner">
                <div class="main-body-inner">
                    <section id="main">
                        <div class="main-body-header">
    <h1 class="header">
    
    <a class="page-title-link" href="/categories/Development/">Development</a>
    </h1>
</div>

                        <div class="main-body-content">
                            <article id="post-2022/08/Understanding-OAuth-2.0" class="article article-single article-type-post" itemscope="" itemprop="blogPost">
    <div class="article-inner responsive-content">
        
            <header class="article-header">
                
    
        <h1 class="article-title" itemprop="name">
        Understanding OAuth 2.0: The Authorization Framework Powering Modern APIs
        </h1>
    

            </header>
        
        
            <div class="article-meta">
                
    <div class="article-date">
      <i class="fa fa-calendar"></i>
        
          Created <time datetime="2022-08-15T16:00:00.000Z" itemprop="datePublished">2022-08-16</time>
          &nbsp;<i class="fa fa-calendar"></i>
          Updated <time datetime="2025-10-27T14:05:01.632Z" itemprop="datePublished">2025-10-27</time>
        
    </div>


                

                
    <div class="article-tag">
        <i class="fa fa-tag"></i>
        <a class="tag-link" href="/tags/Security/">Security</a> <a class="tag-link" href="/tags/Authentication/">Authentication</a> <a class="tag-link" href="/tags/OAuth/">OAuth</a> <a class="tag-link" href="/tags/API/">API</a>
    </div>

            </div>
        
        
        
        <div class="article-entry" itemprop="articleBody">
            <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#What-OAuth-2-0-Actually-Solves"><span class="toc-text">What OAuth 2.0 Actually Solves</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#OAuth-2-0-Roles-and-Components"><span class="toc-text">OAuth 2.0 Roles and Components</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Authorization-Code-Flow-The-Gold-Standard"><span class="toc-text">Authorization Code Flow: The Gold Standard</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Implicit-Flow-Deprecated-and-Dangerous"><span class="toc-text">Implicit Flow: Deprecated and Dangerous</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#PKCE-Securing-Public-Clients"><span class="toc-text">PKCE: Securing Public Clients</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Client-Credentials-Flow-Service-to-Service"><span class="toc-text">Client Credentials Flow: Service-to-Service</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Common-OAuth-Misconceptions"><span class="toc-text">Common OAuth Misconceptions</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Token-Security-Best-Practices"><span class="toc-text">Token Security Best Practices</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Refresh-Tokens-Extended-Access"><span class="toc-text">Refresh Tokens: Extended Access</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Conclusion"><span class="toc-text">Conclusion</span></a></li></ol>
            <p>OAuth 2.0 has become the de facto standard for API authorization, powering everything from social media logins to enterprise API access. Yet despite its ubiquity, OAuth remains widely misunderstood. Developers often confuse authorization with authentication, implement flows incorrectly, or misuse access tokens in ways that compromise security.</p>
<p>This exploration demystifies OAuth 2.0 by examining its core concepts, authorization flows, and security considerations. We‚Äôll trace the journey of tokens through different grant types, understand the roles of various parties, and identify common implementation mistakes. Through diagrams and real-world scenarios, you‚Äôll gain a practical understanding of how OAuth protects resources while enabling seamless user experiences.</p>
<h2 id="What-OAuth-2-0-Actually-Solves">What OAuth 2.0 Actually Solves</h2>
<p>Before OAuth, applications requiring access to user data on third-party services faced a fundamental problem: they needed users to share their passwords. This created multiple security and usability issues.</p>
<h3 id="The-Pre-OAuth-Problem">The Pre-OAuth Problem</h3>
<p>Consider a photo printing service that needs access to your photos stored on a cloud storage platform:</p>
<div class="admonition error"><p class="admonition-title"><span class="mdi mdi-alert-circle-outline admonition-icon"></span>üö´ The Password Sharing Problem</p><div class="admonition-content"><p><strong>Traditional Approach</strong></p>
<ul>
<li>User provides cloud storage username and password to printing service</li>
<li>Printing service stores credentials (security risk)</li>
<li>Printing service has full access to all user data</li>
<li>No way to limit access scope or duration</li>
<li>Password change breaks all integrated services</li>
<li>No audit trail of which service accessed what</li>
</ul>
<p><strong>Security Implications</strong></p>
<ul>
<li>Credentials exposed to third parties</li>
<li>No granular permission control</li>
<li>Cannot revoke access without changing password</li>
<li>Violates principle of least privilege</li>
<li>Increases attack surface significantly</li>
</ul>
</div></div>
<p>OAuth 2.0 solves this by introducing delegated authorization: users can grant limited access to their resources without sharing credentials.</p>
<h3 id="OAuth‚Äôs-Core-Innovation">OAuth‚Äôs Core Innovation</h3>
<p>OAuth separates authentication (proving who you are) from authorization (granting access to resources):</p>
<div class="admonition success"><p class="admonition-title"><span class="mdi mdi-check-circle-outline admonition-icon"></span>‚úÖ OAuth Authorization Model</p><div class="admonition-content"><p><strong>Delegated Access</strong></p>
<ul>
<li>User authenticates directly with resource owner (e.g., cloud storage)</li>
<li>User authorizes specific permissions for third-party application</li>
<li>Application receives time-limited access token</li>
<li>Token grants only requested permissions</li>
<li>User can revoke access anytime without password change</li>
</ul>
<p><strong>Key Benefits</strong></p>
<ul>
<li>No password sharing required</li>
<li>Granular permission scopes</li>
<li>Time-limited access tokens</li>
<li>Independent revocation per application</li>
<li>Clear audit trail of access grants</li>
</ul>
</div></div>
<p>This model enables the modern API ecosystem where applications can integrate seamlessly while maintaining security boundaries.</p>
<h2 id="OAuth-2-0-Roles-and-Components">OAuth 2.0 Roles and Components</h2>
<p>OAuth defines four distinct roles that participate in the authorization flow:</p>
<div class="admonition anote"><p class="admonition-title"><span class="mdi mdi-note-outline admonition-icon"></span>üé≠ OAuth Roles</p><div class="admonition-content"><p><strong>Resource Owner</strong></p>
<ul>
<li>The user who owns the data</li>
<li>Grants authorization to access their resources</li>
<li>Example: You, granting a printing service access to your photos</li>
</ul>
<p><strong>Client</strong></p>
<ul>
<li>The application requesting access to resources</li>
<li>Must be registered with authorization server</li>
<li>Example: Photo printing service application</li>
</ul>
<p><strong>Authorization Server</strong></p>
<ul>
<li>Issues access tokens after authenticating resource owner</li>
<li>Validates authorization grants</li>
<li>Example: Cloud storage provider's OAuth server</li>
</ul>
<p><strong>Resource Server</strong></p>
<ul>
<li>Hosts the protected resources</li>
<li>Validates access tokens and serves requests</li>
<li>Example: Cloud storage API serving photo files</li>
</ul>
</div></div>
<p>These roles interact through a series of well-defined flows, each optimized for different application types and security requirements.</p>
<h2 id="Authorization-Code-Flow-The-Gold-Standard">Authorization Code Flow: The Gold Standard</h2>
<p>The Authorization Code flow is the most secure OAuth flow, recommended for applications that can securely store client secrets.</p>
<h3 id="Flow-Overview">Flow Overview</h3>
<div class="mermaid">sequenceDiagram
    participant User as üë§ Resource Owner
    participant Browser as üåê Browser
    participant Client as üì± Client Application
    participant AuthServer as üîê Authorization Server
    participant ResourceServer as üíæ Resource Server

    User-&gt;&gt;Browser: 1. Click "Connect Account"
    Browser-&gt;&gt;AuthServer: 2. Authorization Request<br>(client_id, redirect_uri, scope)
    AuthServer-&gt;&gt;User: 3. Show Login &amp; Consent Screen
    User-&gt;&gt;AuthServer: 4. Authenticate &amp; Approve
    AuthServer-&gt;&gt;Browser: 5. Redirect with Authorization Code
    Browser-&gt;&gt;Client: 6. Authorization Code
    Client-&gt;&gt;AuthServer: 7. Exchange Code for Token<br>(code, client_id, client_secret)
    AuthServer-&gt;&gt;Client: 8. Access Token + Refresh Token
    Client-&gt;&gt;ResourceServer: 9. API Request with Access Token
    ResourceServer-&gt;&gt;Client: 10. Protected Resource Data</div>
<h3 id="Step-by-Step-Breakdown">Step-by-Step Breakdown</h3>
<div class="admonition anote"><p class="admonition-title"><span class="mdi mdi-note-outline admonition-icon"></span>üìã Authorization Code Flow Steps</p><div class="admonition-content"><p><strong>1. User Initiates Authorization</strong></p>
<ul>
<li>User clicks "Connect with [Service]" in client application</li>
<li>Client redirects user to authorization server</li>
</ul>
<p><strong>2. Authorization Request</strong>
</p><pre class="language-none"><code class="language-none">GET /authorize?<p></p>
</code></pre></div></div><code class="language-none">

  response_type=code&amp;
  client_id=CLIENT_ID&amp;
  redirect_uri=https://client.app/callback&amp;
  scope=read:photos&amp;
  state=RANDOM_STRING</code>
    - `response_type=code`: Requests authorization code
    - `client_id`: Identifies the client application
    - `redirect_uri`: Where to send authorization code
    - `scope`: Requested permissions
    - `state`: CSRF protection token
<pre><code>**3. User Authentication &amp; Consent**
- Authorization server authenticates user (login screen)
- Shows consent screen with requested permissions
- User approves or denies access

**4. Authorization Code Issued**
<pre class="language-none"><code class="language-none">HTTP/1.1 302 Found
Location: https://client.app/callback?
  code=AUTHORIZATION_CODE&amp;
  state=RANDOM_STRING</code></pre>
- Short-lived authorization code (typically 10 minutes)
- Returned via browser redirect
- Single-use only

**5. Token Exchange**
<pre class="language-none"><code class="language-none">POST /token
Content-Type: application/x-www-form-urlencoded

grant_type=authorization_code&amp;
code=AUTHORIZATION_CODE&amp;
redirect_uri=https://client.app/callback&amp;
client_id=CLIENT_ID&amp;
client_secret=CLIENT_SECRET</code></pre>
- Client exchanges code for tokens
- Includes client secret (server-to-server)
- Authorization code consumed and invalidated

**6. Access Token Response**
<pre class="language-json" data-language="json"><code class="language-json"><span class="token punctuation">{</span>
  <span class="token property">"access_token"</span><span class="token operator">:</span> <span class="token string">"eyJhbGciOiJSUzI1NiIs..."</span><span class="token punctuation">,</span>
  <span class="token property">"token_type"</span><span class="token operator">:</span> <span class="token string">"Bearer"</span><span class="token punctuation">,</span>
  <span class="token property">"expires_in"</span><span class="token operator">:</span> <span class="token number">3600</span><span class="token punctuation">,</span>
  <span class="token property">"refresh_token"</span><span class="token operator">:</span> <span class="token string">"tGzv3JOkF0XG5Qx2TlKWIA"</span><span class="token punctuation">,</span>
  <span class="token property">"scope"</span><span class="token operator">:</span> <span class="token string">"read:photos"</span>
<span class="token punctuation">}</span></code></pre>
- Access token for API requests
- Refresh token for obtaining new access tokens
- Expiration time in seconds

**7. API Access**
<pre class="language-none"><code class="language-none">GET /api/photos
Authorization: Bearer eyJhbGciOiJSUzI1NiIs...</code></pre>
- Client includes access token in requests
- Resource server validates token
- Returns protected resources
</code></pre>
<h3 id="Why-This-Flow-is-Secure">Why This Flow is Secure</h3>
<p>The Authorization Code flow provides multiple security layers:</p>
<div class="admonition success"><p class="admonition-title"><span class="mdi mdi-check-circle-outline admonition-icon"></span>üîí Security Features</p><div class="admonition-content"><p><strong>Separation of Concerns</strong></p>
<ul>
<li>Authorization code exposed to browser (less sensitive)</li>
<li>Access token never exposed to browser</li>
<li>Client secret used only in server-to-server communication</li>
</ul>
<p><strong>Short-Lived Credentials</strong></p>
<ul>
<li>Authorization code expires quickly (10 minutes)</li>
<li>Authorization code single-use only</li>
<li>Access tokens time-limited (typically 1 hour)</li>
</ul>
<p><strong>CSRF Protection</strong></p>
<ul>
<li>State parameter prevents cross-site request forgery</li>
<li>Client validates state matches original request</li>
</ul>
<p><strong>Client Authentication</strong></p>
<ul>
<li>Client secret proves client identity during token exchange</li>
<li>Prevents authorization code interception attacks</li>
</ul>
</div></div>
<p>This flow is appropriate for web applications, mobile apps with backend servers, and any scenario where client secrets can be protected.</p>
<h2 id="Implicit-Flow-Deprecated-and-Dangerous">Implicit Flow: Deprecated and Dangerous</h2>
<p>The Implicit flow was designed for browser-based applications that cannot securely store client secrets. However, it has been deprecated due to security vulnerabilities.</p>
<h3 id="How-Implicit-Flow-Worked">How Implicit Flow Worked</h3>
<div class="mermaid">sequenceDiagram
    participant User as üë§ Resource Owner
    participant Browser as üåê Browser/SPA
    participant AuthServer as üîê Authorization Server
    participant ResourceServer as üíæ Resource Server

    User-&gt;&gt;Browser: 1. Click "Login"
    Browser-&gt;&gt;AuthServer: 2. Authorization Request<br>(response_type=token)
    AuthServer-&gt;&gt;User: 3. Authenticate &amp; Consent
    AuthServer-&gt;&gt;Browser: 4. Redirect with Access Token<br>(in URL fragment)
    Browser-&gt;&gt;Browser: 5. Extract Token from URL
    Browser-&gt;&gt;ResourceServer: 6. API Request with Token
    ResourceServer-&gt;&gt;Browser: 7. Protected Resource</div>
<h3 id="Why-Implicit-Flow-is-Deprecated">Why Implicit Flow is Deprecated</h3>
<div class="admonition error"><p class="admonition-title"><span class="mdi mdi-alert-circle-outline admonition-icon"></span>üö´ Implicit Flow Security Issues</p><div class="admonition-content"><p><strong>Access Token Exposure</strong></p>
<ul>
<li>Token returned in URL fragment</li>
<li>Visible in browser history</li>
<li>Logged in server access logs</li>
<li>Exposed to browser extensions</li>
<li>Vulnerable to XSS attacks</li>
</ul>
<p><strong>No Client Authentication</strong></p>
<ul>
<li>No client secret validation</li>
<li>Cannot verify client identity</li>
<li>Easier to impersonate clients</li>
</ul>
<p><strong>No Refresh Tokens</strong></p>
<ul>
<li>Cannot issue refresh tokens securely</li>
<li>User must re-authenticate when token expires</li>
<li>Poor user experience</li>
</ul>
<p><strong>Token Leakage Vectors</strong></p>
<ul>
<li>Referrer headers may leak tokens</li>
<li>Browser history stores tokens</li>
<li>Shared computers expose tokens</li>
<li>No secure storage mechanism</li>
</ul>
</div></div>
<p>Modern applications should use Authorization Code flow with PKCE instead.</p>
<h2 id="PKCE-Securing-Public-Clients">PKCE: Securing Public Clients</h2>
<p>Proof Key for Code Exchange (PKCE, pronounced ‚Äúpixie‚Äù) extends the Authorization Code flow to secure public clients that cannot store secrets.</p>
<h3 id="The-Public-Client-Problem">The Public Client Problem</h3>
<p>Mobile apps and single-page applications face a fundamental challenge:</p>
<div class="admonition warning"><p class="admonition-title"><span class="mdi mdi-alert-outline admonition-icon"></span>‚ö†Ô∏è Public Client Challenges</p><div class="admonition-content"><p><strong>Cannot Store Secrets Securely</strong></p>
<ul>
<li>Mobile app code can be decompiled</li>
<li>JavaScript source code visible in browser</li>
<li>No secure storage for client secrets</li>
<li>Secrets would be exposed to all users</li>
</ul>
<p><strong>Authorization Code Interception</strong></p>
<ul>
<li>Malicious apps can register same redirect URI</li>
<li>Authorization code intercepted by attacker</li>
<li>Attacker exchanges code for tokens</li>
<li>No client secret to prevent this</li>
</ul>
</div></div>
<p>PKCE solves this by adding dynamic, per-request secrets that cannot be pre-extracted.</p>
<h3 id="PKCE-Flow">PKCE Flow</h3>
<div class="mermaid">sequenceDiagram
    participant User as üë§ Resource Owner
    participant Client as üì± Mobile App/SPA
    participant AuthServer as üîê Authorization Server
    participant ResourceServer as üíæ Resource Server

    Client-&gt;&gt;Client: 1. Generate code_verifier<br>(random string)
    Client-&gt;&gt;Client: 2. Create code_challenge<br>(SHA256 hash of verifier)
    User-&gt;&gt;Client: 3. Initiate Login
    Client-&gt;&gt;AuthServer: 4. Authorization Request<br>(code_challenge, method)
    AuthServer-&gt;&gt;User: 5. Authenticate &amp; Consent
    AuthServer-&gt;&gt;Client: 6. Authorization Code
    Client-&gt;&gt;AuthServer: 7. Token Request<br>(code, code_verifier)
    AuthServer-&gt;&gt;AuthServer: 8. Verify code_challenge<br>matches code_verifier
    AuthServer-&gt;&gt;Client: 9. Access Token
    Client-&gt;&gt;ResourceServer: 10. API Request
    ResourceServer-&gt;&gt;Client: 11. Protected Resource</div>
<h3 id="PKCE-Implementation-Details">PKCE Implementation Details</h3>
<div class="admonition anote"><p class="admonition-title"><span class="mdi mdi-note-outline admonition-icon"></span>üîê PKCE Parameters</p><div class="admonition-content"><p><strong>Code Verifier</strong></p>
<ul>
<li>Random string: 43-128 characters</li>
<li>Cryptographically random</li>
<li>Generated fresh for each authorization request</li>
<li>Example: <code>dBjftJeZ4CVP-mB92K27uhbUJU1p1r_wW1gFWFOEjXk</code></li>
</ul>
<p><strong>Code Challenge</strong></p>
<ul>
<li>SHA256 hash of code verifier (recommended)</li>
<li>Or plain code verifier (not recommended)</li>
<li>Sent in authorization request</li>
<li>Example: <code>E9Melhoa2OwvFrEMTJguCHaoeK1t8URWbuGJSstw-cM</code></li>
</ul>
<p><strong>Authorization Request</strong>
</p><pre class="language-none"><code class="language-none">GET /authorize?<p></p>
</code></pre></div></div><code class="language-none">

  response_type=code&amp;
  client_id=CLIENT_ID&amp;
  redirect_uri=https://app.example.com/callback&amp;
  scope=read:photos&amp;
  code_challenge=E9Melhoa2OwvFrEMTJguCHaoeK1t8URWbuGJSstw-cM&amp;
  code_challenge_method=S256</code>
<pre><code>**Token Request**
<pre class="language-none"><code class="language-none">POST /token

grant_type=authorization_code&amp;
code=AUTHORIZATION_CODE&amp;
redirect_uri=https://app.example.com/callback&amp;
client_id=CLIENT_ID&amp;
code_verifier=dBjftJeZ4CVP-mB92K27uhbUJU1p1r_wW1gFWFOEjXk</code></pre>

**Server Verification**
<pre class="language-none"><code class="language-none">SHA256(code_verifier) == stored_code_challenge</code></pre>
- Authorization server stores code_challenge with authorization code
- Verifies code_verifier matches during token exchange
- Prevents authorization code interception attacks
</code></pre>
<h3 id="Why-PKCE-Works">Why PKCE Works</h3>
<div class="admonition success"><p class="admonition-title"><span class="mdi mdi-check-circle-outline admonition-icon"></span>‚úÖ PKCE Security Benefits</p><div class="admonition-content"><p><strong>Dynamic Secrets</strong></p>
<ul>
<li>Code verifier generated per request</li>
<li>Cannot be pre-extracted from application</li>
<li>Attacker cannot predict or reuse verifiers</li>
</ul>
<p><strong>Authorization Code Binding</strong></p>
<ul>
<li>Code challenge binds authorization code to client instance</li>
<li>Intercepted code useless without code verifier</li>
<li>Only the client that initiated flow can exchange code</li>
</ul>
<p><strong>No Stored Secrets Required</strong></p>
<ul>
<li>No client secret needed</li>
<li>Safe for mobile apps and SPAs</li>
<li>Maintains security without secret storage</li>
</ul>
<p><strong>Backward Compatible</strong></p>
<ul>
<li>Works with existing OAuth servers (if supported)</li>
<li>Can be used alongside client secrets</li>
<li>Recommended for all OAuth clients now</li>
</ul>
</div></div>
<p>PKCE is now recommended for all OAuth clients, including confidential clients that can store secrets, as an additional security layer.</p>
<h2 id="Client-Credentials-Flow-Service-to-Service">Client Credentials Flow: Service-to-Service</h2>
<p>The Client Credentials flow is designed for machine-to-machine communication where no user is involved.</p>
<h3 id="When-to-Use-Client-Credentials">When to Use Client Credentials</h3>
<div class="admonition anote"><p class="admonition-title"><span class="mdi mdi-note-outline admonition-icon"></span>ü§ñ Client Credentials Use Cases</p><div class="admonition-content"><p><strong>Backend Services</strong></p>
<ul>
<li>Microservices communicating with each other</li>
<li>Scheduled jobs accessing APIs</li>
<li>Server-to-server integrations</li>
<li>No user context required</li>
</ul>
<p><strong>Characteristics</strong></p>
<ul>
<li>Client acts on its own behalf</li>
<li>No resource owner involved</li>
<li>Client credentials are the authorization</li>
<li>Typically long-lived or cached tokens</li>
</ul>
</div></div>
<h3 id="Client-Credentials-Flow">Client Credentials Flow</h3>
<div class="mermaid">sequenceDiagram
    participant Client as üñ•Ô∏è Client Service
    participant AuthServer as üîê Authorization Server
    participant ResourceServer as üíæ Resource Server

    Client-&gt;&gt;AuthServer: 1. Token Request<br>(client_id, client_secret, scope)
    AuthServer-&gt;&gt;AuthServer: 2. Validate Client Credentials
    AuthServer-&gt;&gt;Client: 3. Access Token
    Client-&gt;&gt;ResourceServer: 4. API Request with Token
    ResourceServer-&gt;&gt;Client: 5. Protected Resource</div>
<h3 id="Implementation">Implementation</h3>
<div class="admonition anote"><p class="admonition-title"><span class="mdi mdi-note-outline admonition-icon"></span>üìã Client Credentials Request</p><div class="admonition-content"><p><strong>Token Request</strong>
</p><pre class="language-none"><code class="language-none">POST /token<p></p>
</code></pre></div></div><code class="language-none">

Content-Type: application/x-www-form-urlencoded

grant_type=client_credentials&amp;
client_id=CLIENT_ID&amp;
client_secret=CLIENT_SECRET&amp;
scope=api:read api:write</code>
<pre><code>**Token Response**
<pre class="language-json" data-language="json"><code class="language-json"><span class="token punctuation">{</span>
  <span class="token property">"access_token"</span><span class="token operator">:</span> <span class="token string">"eyJhbGciOiJSUzI1NiIs..."</span><span class="token punctuation">,</span>
  <span class="token property">"token_type"</span><span class="token operator">:</span> <span class="token string">"Bearer"</span><span class="token punctuation">,</span>
  <span class="token property">"expires_in"</span><span class="token operator">:</span> <span class="token number">3600</span><span class="token punctuation">,</span>
  <span class="token property">"scope"</span><span class="token operator">:</span> <span class="token string">"api:read api:write"</span>
<span class="token punctuation">}</span></code></pre>

**API Request**
<pre class="language-none"><code class="language-none">GET /api/resources
Authorization: Bearer eyJhbGciOiJSUzI1NiIs...</code></pre>
</code></pre>
<p>This flow is straightforward but requires secure storage of client credentials and should only be used for service-to-service communication.</p>
<h2 id="Common-OAuth-Misconceptions">Common OAuth Misconceptions</h2>
<p>OAuth is frequently misunderstood, leading to security vulnerabilities and implementation errors.</p>
<h3 id="OAuth-is-NOT-Authentication">OAuth is NOT Authentication</h3>
<p>The most common misconception is that OAuth provides authentication. It doesn‚Äôt.</p>
<div class="admonition error"><p class="admonition-title"><span class="mdi mdi-alert-circle-outline admonition-icon"></span>üö´ OAuth ‚â† Authentication</p><div class="admonition-content"><p><strong>What OAuth Provides</strong></p>
<ul>
<li>Authorization: Permission to access resources</li>
<li>Delegated access to APIs</li>
<li>Scoped permissions</li>
</ul>
<p><strong>What OAuth Does NOT Provide</strong></p>
<ul>
<li>User identity verification</li>
<li>User authentication</li>
<li>Identity information</li>
</ul>
<p><strong>The Problem</strong></p>
<ul>
<li>Access token proves authorization, not identity</li>
<li>Token could be issued to different user</li>
<li>No standard way to get user information</li>
<li>Vulnerable to token substitution attacks</li>
</ul>
</div></div>
<h3 id="The-‚ÄúLogin-with-OAuth‚Äù-Anti-Pattern">The ‚ÄúLogin with OAuth‚Äù Anti-Pattern</h3>
<p>Many applications implement ‚ÄúLogin with [Service]‚Äù using OAuth alone:</p>
<div class="admonition warning"><p class="admonition-title"><span class="mdi mdi-alert-outline admonition-icon"></span>‚ö†Ô∏è Insecure OAuth Login Pattern</p><div class="admonition-content"><p><strong>Flawed Implementation</strong>
</p><pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token comment">// INSECURE: Do not do this</span><p></p>
</code></pre></div></div><code class="language-javascript">

app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/callback'</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span> code <span class="token punctuation">}</span> <span class="token operator">=</span> req<span class="token punctuation">.</span>query<span class="token punctuation">;</span>
  <span class="token keyword">const</span> token <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">exchangeCodeForToken</span><span class="token punctuation">(</span>code<span class="token punctuation">)</span><span class="token punctuation">;</span>
  
  <span class="token comment">// Assumes token belongs to legitimate user</span>
  <span class="token keyword">const</span> user <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">getUserFromToken</span><span class="token punctuation">(</span>token<span class="token punctuation">)</span><span class="token punctuation">;</span>
  req<span class="token punctuation">.</span>session<span class="token punctuation">.</span>userId <span class="token operator">=</span> user<span class="token punctuation">.</span>id<span class="token punctuation">;</span> <span class="token comment">// VULNERABLE</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code>
<pre><code>**Attack Scenario**
- Attacker obtains valid access token for their account
- Attacker tricks victim into using attacker's token
- Victim logs in as attacker
- Victim's actions attributed to attacker's account
- Data leakage and account confusion
</code></pre>
<h3 id="Use-OpenID-Connect-for-Authentication">Use OpenID Connect for Authentication</h3>
<p>OpenID Connect (OIDC) extends OAuth 2.0 to provide authentication:</p>
<div class="admonition success"><p class="admonition-title"><span class="mdi mdi-check-circle-outline admonition-icon"></span>‚úÖ OpenID Connect Solution</p><div class="admonition-content"><p><strong>What OIDC Adds</strong></p>
<ul>
<li>ID Token: JWT containing user identity claims</li>
<li>UserInfo endpoint: Standardized user information</li>
<li>Authentication verification</li>
<li>Standardized claims (sub, name, email, etc.)</li>
</ul>
<p><strong>Secure Implementation</strong>
</p><pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token comment">// SECURE: Using OpenID Connect</span><p></p>
</code></pre></div></div><code class="language-javascript">

app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/callback'</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span> code <span class="token punctuation">}</span> <span class="token operator">=</span> req<span class="token punctuation">.</span>query<span class="token punctuation">;</span>
  <span class="token keyword">const</span> tokens <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">exchangeCodeForTokens</span><span class="token punctuation">(</span>code<span class="token punctuation">)</span><span class="token punctuation">;</span>
  
  <span class="token comment">// Verify ID token signature and claims</span>
  <span class="token keyword">const</span> idToken <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">verifyIdToken</span><span class="token punctuation">(</span>tokens<span class="token punctuation">.</span>id_token<span class="token punctuation">)</span><span class="token punctuation">;</span>
  
  <span class="token comment">// ID token contains verified user identity</span>
  req<span class="token punctuation">.</span>session<span class="token punctuation">.</span>userId <span class="token operator">=</span> idToken<span class="token punctuation">.</span>sub<span class="token punctuation">;</span>
  req<span class="token punctuation">.</span>session<span class="token punctuation">.</span>email <span class="token operator">=</span> idToken<span class="token punctuation">.</span>email<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code>
<pre><code>**ID Token Structure**
<pre class="language-json" data-language="json"><code class="language-json"><span class="token punctuation">{</span>
  <span class="token property">"iss"</span><span class="token operator">:</span> <span class="token string">"https://auth.example.com"</span><span class="token punctuation">,</span>
  <span class="token property">"sub"</span><span class="token operator">:</span> <span class="token string">"user123"</span><span class="token punctuation">,</span>
  <span class="token property">"aud"</span><span class="token operator">:</span> <span class="token string">"client_id"</span><span class="token punctuation">,</span>
  <span class="token property">"exp"</span><span class="token operator">:</span> <span class="token number">1661529600</span><span class="token punctuation">,</span>
  <span class="token property">"iat"</span><span class="token operator">:</span> <span class="token number">1661526000</span><span class="token punctuation">,</span>
  <span class="token property">"email"</span><span class="token operator">:</span> <span class="token string">"user@example.com"</span><span class="token punctuation">,</span>
  <span class="token property">"email_verified"</span><span class="token operator">:</span> <span class="token boolean">true</span>
<span class="token punctuation">}</span></code></pre>
</code></pre>
<p>Use OAuth 2.0 for API authorization. Use OpenID Connect for user authentication.</p>
<h2 id="Token-Security-Best-Practices">Token Security Best Practices</h2>
<p>Access tokens are bearer tokens‚Äîanyone possessing the token can use it. Proper token handling is critical.</p>
<div class="admonition anote"><p class="admonition-title"><span class="mdi mdi-note-outline admonition-icon"></span>üîí Token Security Guidelines</p><div class="admonition-content"><p><strong>Storage</strong></p>
<ul>
<li>Never store tokens in localStorage (vulnerable to XSS)</li>
<li>Use httpOnly cookies for web applications</li>
<li>Use secure storage APIs on mobile (Keychain, KeyStore)</li>
<li>Encrypt tokens at rest if stored in databases</li>
</ul>
<p><strong>Transmission</strong></p>
<ul>
<li>Always use HTTPS/TLS</li>
<li>Include tokens in Authorization header, not URL</li>
<li>Never log tokens in application logs</li>
<li>Avoid sending tokens in query parameters</li>
</ul>
<p><strong>Validation</strong></p>
<ul>
<li>Verify token signature (for JWTs)</li>
<li>Check token expiration</li>
<li>Validate token audience and issuer</li>
<li>Verify token scopes match required permissions</li>
</ul>
<p><strong>Lifetime Management</strong></p>
<ul>
<li>Use short-lived access tokens (1 hour typical)</li>
<li>Implement refresh token rotation</li>
<li>Revoke tokens on logout</li>
<li>Monitor for token reuse attempts</li>
</ul>
<p><strong>Scope Principle</strong></p>
<ul>
<li>Request minimum necessary scopes</li>
<li>Validate scopes on resource server</li>
<li>Don't grant excessive permissions</li>
<li>Implement scope-based access control</li>
</ul>
</div></div>
<h2 id="Refresh-Tokens-Extended-Access">Refresh Tokens: Extended Access</h2>
<p>Refresh tokens enable long-term access without requiring users to re-authenticate frequently.</p>
<h3 id="Refresh-Token-Flow">Refresh Token Flow</h3>
<div class="mermaid">sequenceDiagram
    participant Client as üì± Client Application
    participant AuthServer as üîê Authorization Server
    participant ResourceServer as üíæ Resource Server

    Client-&gt;&gt;ResourceServer: 1. API Request with Access Token
    ResourceServer-&gt;&gt;Client: 2. 401 Unauthorized (token expired)
    Client-&gt;&gt;AuthServer: 3. Refresh Token Request<br>(refresh_token, client_id)
    AuthServer-&gt;&gt;AuthServer: 4. Validate Refresh Token
    AuthServer-&gt;&gt;Client: 5. New Access Token + New Refresh Token
    Client-&gt;&gt;ResourceServer: 6. API Request with New Token
    ResourceServer-&gt;&gt;Client: 7. Protected Resource</div>
<h3 id="Refresh-Token-Security">Refresh Token Security</h3>
<div class="admonition warning"><p class="admonition-title"><span class="mdi mdi-alert-outline admonition-icon"></span>‚ö†Ô∏è Refresh Token Risks</p><div class="admonition-content"><p><strong>High-Value Targets</strong></p>
<ul>
<li>Long-lived credentials (days to months)</li>
<li>Can generate new access tokens</li>
<li>More valuable to attackers than access tokens</li>
<li>Require stronger protection</li>
</ul>
<p><strong>Security Measures</strong></p>
<ul>
<li>Refresh token rotation: Issue new refresh token with each use</li>
<li>Detect refresh token reuse (indicates theft)</li>
<li>Bind refresh tokens to clients</li>
<li>Revoke token families on suspicious activity</li>
<li>Store refresh tokens securely (encrypted)</li>
<li>Implement refresh token expiration</li>
</ul>
<p><strong>Refresh Token Rotation</strong>
</p><pre class="language-none"><code class="language-none">Request:  refresh_token=OLD_TOKEN<p></p>
</code></pre></div></div><code class="language-none">

Response: access_token=NEW_ACCESS
          refresh_token=NEW_REFRESH

Old refresh token invalidated immediately
Reuse of old token triggers security alert</code>
<p>Refresh token rotation is now considered best practice, preventing token replay attacks and limiting damage from token theft.</p>
<h2 id="Conclusion">Conclusion</h2>
<p>OAuth 2.0 provides a robust framework for delegated authorization, enabling applications to access user resources without password sharing. By separating authorization from authentication, OAuth creates clear security boundaries while enabling the modern API ecosystem.</p>
<p>The Authorization Code flow with PKCE represents the current best practice for most applications, providing strong security for both confidential and public clients. The deprecated Implicit flow should be avoided entirely. Client Credentials flow serves machine-to-machine scenarios where no user is involved. Each flow addresses specific security requirements and application architectures.</p>
<p>Understanding that OAuth provides authorization, not authentication, is critical. Applications requiring user authentication should use OpenID Connect, which extends OAuth with standardized identity verification. Treating OAuth access tokens as proof of identity creates serious security vulnerabilities.</p>
<p>Token security requires careful attention to storage, transmission, validation, and lifetime management. Access tokens should be short-lived, transmitted over HTTPS, and stored securely. Refresh tokens, being long-lived and powerful, require even stronger protection including rotation and reuse detection.</p>
<p>OAuth 2.0 is not a single protocol but a framework offering multiple flows for different scenarios. Choosing the appropriate flow, implementing it correctly, and following security best practices are essential for building secure, user-friendly applications. The complexity of OAuth reflects the complexity of the security problems it solves‚Äîdelegated access without credential sharing is inherently challenging, and OAuth provides battle-tested solutions to these challenges.</p>

        </div>
        
        <footer class="article-footer">
            
    <a data-url="https://neo01.com/2022/08/Understanding-OAuth-2.0/" data-id="328349b0" class="article-share-link"><i class="fa fa-share"></i>Share</a>
<script>
    (function ($) {
        $('body').on('click', function() {
            $('.article-share-box.on').removeClass('on');
        }).on('click', '.article-share-link', function(e) {
            e.stopPropagation();

            var $this = $(this),
                url = $this.attr('data-url').replace("http://","https://"),
                encodedUrl = encodeURIComponent(url),
                id = 'article-share-box-' + $this.attr('data-id'),
                offset = $this.offset(),
                box;

            if ($('#' + id).length) {
                box = $('#' + id);

                if (box.hasClass('on')){
                    box.removeClass('on');
                    return;
                }
            } else {
                var html = [
                    '<div id="' + id + '" class="article-share-box">',
                        '<input class="article-share-input" value="' + url + '">',
                        '<div class="article-share-links">',
                            '<a href="https://twitter.com/intent/tweet?url=' + encodedUrl + '" class="article-share-twitter" target="_blank" title="Twitter"></a>',
                            '<a href="https://www.facebook.com/sharer.php?u=' + encodedUrl + '" class="article-share-facebook" target="_blank" title="Facebook"></a>',
                            '<a href="http://pinterest.com/pin/create/button/?url=' + encodedUrl + '" class="article-share-pinterest" target="_blank" title="Pinterest"></a>',
                        '</div>',
                    '</div>'
                ].join('');

              box = $(html);

              $('body').append(box);
            }

            $('.article-share-box.on').hide();

            box.css({
                top: offset.top + 25,
                left: offset.left
            }).addClass('on');

        }).on('click', '.article-share-box', function (e) {
            e.stopPropagation();
        }).on('click', '.article-share-box-input', function () {
            $(this).select();
        }).on('click', '.article-share-box-link', function (e) {
            e.preventDefault();
            e.stopPropagation();

            window.open(this.href, 'article-share-box-window-' + Date.now(), 'width=500,height=450');
        });
    })(jQuery);
</script>

        </footer>
    </div>
    <!--script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "BlogPosting",
        "author": {
            "@type": "Person",
            "name": "Neo Alienson"
        },
        "headline": "Understanding OAuth 2.0: The Authorization Framework Powering Modern APIs",
        "image": "https://neo01.com",
        "keywords": "API Authentication OAuth Security",
        "genre": "Development",
        "datePublished": "2022-08-16",
        "dateCreated": "2022-08-16",
        "dateModified": "2025-10-27",
        "url": "https://neo01.com/2022/08/Understanding-OAuth-2.0/",
        "description": "OAuth 2.0 enables secure delegated access without sharing passwords. Learn how authorization flows work, common pitfalls, and why OAuth is not authentication.",
        "wordCount": 2895
    }
</script-->

</article>

                        </div>
                    </section>
                    <aside id="sidebar">
    <a class="sidebar-toggle" title="Expand Sidebar"><i class="toggle icon"></i></a>
    <div class="sidebar-top">
        <p>follow:</p>
        <ul class="social-links">
                <li>
                    <a class="social-tooltip" title="stack-exchange" href="https://stackexchange.com/users/2122053/neo?tab=accounts" target="_blank" rel="noopener">
                        <i class="icon fa-brands fa-stack-exchange"></i>
                    </a>
                </li>
                <li>
                    <a class="social-tooltip" title="stack-overflow" href="https://stackoverflow.com/users/1885105/neo" target="_blank" rel="noopener">
                        <i class="icon fa-brands fa-stack-overflow"></i>
                    </a>
                </li>
                <li>
                    <a class="social-tooltip" title="github" href="https://github.com/neoalienson" target="_blank" rel="noopener">
                        <i class="icon fa-brands fa-github"></i>
                    </a>
                </li>
                <li>
                    <a class="social-tooltip" title="linkedin" href="https://linkedin.com/in/neo01" target="_blank" rel="noopener">
                        <i class="icon fa-brands fa-linkedin"></i>
                    </a>
                </li>
                <li>
                    <a class="social-tooltip" title="rss" href="/atom.xml" target="_blank" rel="noopener">
                        <i class="icon fa fa-rss"></i>
                    </a>
                </li>
        </ul>
    </div>
    <div class="widgets-container">
        
            
                <div class="widget-wrap widget-list">
    <h3 class="widget-title">links</h3>
    <div class="widget">
        <ul><li><a href="/ai">AI Playground</a></li><li><a href="/tools">Tools</a></li><li><a href="/games">Games</a></li><li><a href="/pages/useful-information">Useful Information</a></li><li><a href="/pages/Hexo-Blogging-Cheatsheet">Hexo Blogging Cheatsheet</a></li></ul>
    </div>
</div>

            
                
            
                    <div class="widget-wrap">
        <h3 class="widget-title">recents</h3>
        <div class="widget">
            <ul id="recent-post" class="">
                    <li>
                        <div class="item-thumbnail">
                            <a href="/2025/10/How-I-Use-AI-to-Learn/" class="thumbnail">
        <span style="background-image:url(/assets/learning/thumbnail_80.png)" alt="How I Use AI to Learn: A Personal Journey Through Iterative Knowledge Building" class="thumbnail-image"></span>
</a>
                        </div>
                        <div class="item-inner">
                            <p class="item-category"><a class="article-category-link" href="/categories/AI/">AI</a></p>
                            <p class="item-title"><a href="/2025/10/How-I-Use-AI-to-Learn/" class="title">How I Use AI to Learn: A Personal Journey Through Iterative Knowledge Building</a></p>
                            <p class="item-date"><time datetime="2025-10-18T16:00:00.000Z" itemprop="datePublished">2025-10-19</time></p>
                        </div>
                    </li>
                    <li>
                        <div class="item-thumbnail">
                            <a href="/2025/10/Tools-Games-And-Browser-Built-In-AI/" class="thumbnail">
        <span style="background-image:url(/2025/10/Tools-Games-And-Browser-Built-In-AI/thumbnail.jpeg)" alt="Tools, Games and Browser Built-in AI Playground" class="thumbnail-image"></span>
</a>
                        </div>
                        <div class="item-inner">
                            <p class="item-category"><a class="article-category-link" href="/categories/AI/">AI</a></p>
                            <p class="item-title"><a href="/2025/10/Tools-Games-And-Browser-Built-In-AI/" class="title">Tools, Games and Browser Built-in AI Playground</a></p>
                            <p class="item-date"><time datetime="2025-10-01T16:00:00.000Z" itemprop="datePublished">2025-10-02</time></p>
                        </div>
                    </li>
                    <li>
                        <div class="item-thumbnail">
                            <a href="/2025/09/The_Rise_of_Agentic_Coding_AI_Powered_Software_Engineering/" class="thumbnail">
        <span style="background-image:url(/2025/09/The_Rise_of_Agentic_Coding_AI_Powered_Software_Engineering/thumbnail.jpeg)" alt="The Rise of Agentic Coding: AI-Powered Software Engineering" class="thumbnail-image"></span>
</a>
                        </div>
                        <div class="item-inner">
                            <p class="item-category"><a class="article-category-link" href="/categories/AI/">AI</a></p>
                            <p class="item-title"><a href="/2025/09/The_Rise_of_Agentic_Coding_AI_Powered_Software_Engineering/" class="title">The Rise of Agentic Coding: AI-Powered Software Engineering</a></p>
                            <p class="item-date"><time datetime="2025-09-19T16:00:00.000Z" itemprop="datePublished">2025-09-20</time></p>
                        </div>
                    </li>
                    <li>
                        <div class="item-thumbnail">
                            <a href="/2025/08/Understanding_Ephemeral_Ports_Part2/" class="thumbnail">
        <span style="background-image:url(/assets/ports/thumbnail.png)" alt="Understanding Ephemeral Ports Part 2: Why Server Applications Should Avoid Dynamic Ports" class="thumbnail-image"></span>
</a>
                        </div>
                        <div class="item-inner">
                            <p class="item-category"><a class="article-category-link" href="/categories/Development/">Development</a></p>
                            <p class="item-title"><a href="/2025/08/Understanding_Ephemeral_Ports_Part2/" class="title">Understanding Ephemeral Ports Part 2: Why Server Applications Should Avoid Dynamic Ports</a></p>
                            <p class="item-date"><time datetime="2025-08-30T16:00:00.000Z" itemprop="datePublished">2025-08-31</time></p>
                        </div>
                    </li>
                    <li>
                        <div class="item-thumbnail">
                            <a href="/2025/08/Understanding_Ephemeral_Ports_Part1/" class="thumbnail">
        <span style="background-image:url(/assets/ports/thumbnail.png)" alt="Understanding Ephemeral Ports: The Invisible Workers of Network Communication" class="thumbnail-image"></span>
</a>
                        </div>
                        <div class="item-inner">
                            <p class="item-category"><a class="article-category-link" href="/categories/Development/">Development</a></p>
                            <p class="item-title"><a href="/2025/08/Understanding_Ephemeral_Ports_Part1/" class="title">Understanding Ephemeral Ports: The Invisible Workers of Network Communication</a></p>
                            <p class="item-date"><time datetime="2025-08-29T16:00:00.000Z" itemprop="datePublished">2025-08-30</time></p>
                        </div>
                    </li>
            </ul>
        </div>
    </div>

            
                
    
    
    <div class="widget-wrap widget-list">
        <h3 class="widget-title">archives</h3>
        <div class="widget">
            <ul class="archive-list">
            
                <li class="archive-list-item">
                    <a class="archive-list-link" href="/archives/2025/">2025</a>
                    <span class="archive-list-count">72</span>
                </li>
            
                <li class="archive-list-item">
                    <a class="archive-list-link" href="/archives/2024/">2024</a>
                    <span class="archive-list-count">25</span>
                </li>
            
                <li class="archive-list-item">
                    <a class="archive-list-link" href="/archives/2023/">2023</a>
                    <span class="archive-list-count">15</span>
                </li>
            
                <li class="archive-list-item">
                    <a class="archive-list-link" href="/archives/2022/">2022</a>
                    <span class="archive-list-count">12</span>
                </li>
            
                <li class="archive-list-item">
                    <a class="archive-list-link" href="/archives/2021/">2021</a>
                    <span class="archive-list-count">14</span>
                </li>
            
                <li class="archive-list-item">
                    <a class="archive-list-link" href="/archives/2020/">2020</a>
                    <span class="archive-list-count">13</span>
                </li>
            
                <li class="archive-list-item">
                    <a class="archive-list-link" href="/archives/2019/">2019</a>
                    <span class="archive-list-count">12</span>
                </li>
            
                <li class="archive-list-item">
                    <a class="archive-list-link" href="/archives/2018/">2018</a>
                    <span class="archive-list-count">2</span>
                </li>
            
                <li class="archive-list-item">
                    <a class="archive-list-link" href="/archives/2017/">2017</a>
                    <span class="archive-list-count">5</span>
                </li>
            
                <li class="archive-list-item">
                    <a class="archive-list-link" href="/archives/2016/">2016</a>
                    <span class="archive-list-count">4</span>
                </li>
            
                <li class="archive-list-item">
                    <a class="archive-list-link" href="/archives/2015/">2015</a>
                    <span class="archive-list-count">6</span>
                </li>
            
                <li class="archive-list-item">
                    <a class="archive-list-link" href="/archives/2014/">2014</a>
                    <span class="archive-list-count">7</span>
                </li>
            
                <li class="archive-list-item">
                    <a class="archive-list-link" href="/archives/2013/">2013</a>
                    <span class="archive-list-count">2</span>
                </li>
            
            </ul>
        </div>
    </div>


            
        
    </div>
</aside>

                </div>
            </div>
        </div>
        <!-- disable caching cause each page has different footer from qrcode -->
        <!-- common/footer, null, {cache: !config.relative_link})  -->
        <footer id="footer">
    <div class="container">
        <div class="container-inner">
            <a id="back-to-top" href="javascript:;"><i class="icon fa fa-angle-up"></i></a>
            <div class="qrcode-share-wrapper">
                <div class="qrcode-text">https://neo01.com/l#3897f973</div>
                <img src="/qr/qr-b65e884a2e85efb7415e985629c5aff9.svg" width="200" height="200" alt="QR Code for https://neo01.com/l#3897f973">
            </div>
            <div class="credit">
                <h1 class="logo-wrap">
                    <a href="/" title="Homepage" class="logo"></a>
                </h1>
                
                <p>¬© 2025 Neo Alienson. All rights reserved.
                  <a href="/terms-and-conditions">Terms and Conditions</a></p>
                
            </div>
            <div class="footer-plugins">
              


            </div>
        </div>
    </div>
</footer>

        
    
        


        


        


        


        


        


        


        


        


    



<!-- Custom Scripts -->




    </div>
<!-- hexo injector body_end start --><script type="text/javascript" src="/js/bundle_last.js"></script><!-- hexo injector body_end end -->

</body></html>