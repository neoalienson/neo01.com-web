<!DOCTYPE html><html lang="zh-CN"><head><!-- hexo injector head_begin start --><!-- Google tag (gtag.js) begins-->
    <script async="" src="https://www.googletagmanager.com/gtag/js?id=G-3DZR3TQYCY"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
    
      gtag('config', 'G-3DZR3TQYCY');
    </script>
    <!-- Google tag (gtag.js) ends-->
    <!-- hexo injector head_begin end -->
    <meta charset="utf-8">
    <!-- security headers starts -->
    <!-- meta http-equiv="content-security-policy" content="script-src 'sha256-B5nfCL2Dym3Ba4YJFI7wB3f4vtClbrYJZ32A5erBEdg=' 'sha256-lJjk3/dvd+wXqRFjV7T5L/nXJXr5NjUjmsKSPEe+ass=';" -->
    <!-- security headers ends -->
    <!-- favicon starts -->    
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <!-- favicon ends -->
    

    <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="alternate" href="/atom.xml" title="Decoding Digital Anomalies" type="application/atom+xml">
    

    

    

    

    

    

    

    
    
        


    
    
        


    



    
    <title>缓慢变化维度：管理数据仓库中的历史数据 | Decoding Digital Anomalies</title>
    
    <meta name="keywords" content="Data Modeling,Data Warehousing,Database">
    
    
    <meta name="description" content="维度数据会以不可预测的方式随时间变化。从简单的覆写到复杂的混合方法，理解 SCD 类型有助于平衡历史准确性、数据完整性和系统性能。">
<meta property="og:type" content="article">
<meta property="og:title" content="缓慢变化维度：管理数据仓库中的历史数据">
<meta property="og:url" content="https://neo01.com/zh-CN/2006/12/Slowly-Changing-Dimensions-Managing-Historical-Data/index.html">
<meta property="og:site_name" content="Decoding Digital Anomalies">
<meta property="og:description" content="维度数据会以不可预测的方式随时间变化。从简单的覆写到复杂的混合方法，理解 SCD 类型有助于平衡历史准确性、数据完整性和系统性能。">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2006-12-10T16:00:00.000Z">
<meta property="article:modified_time" content="2025-11-26T17:14:31.215Z">
<meta property="article:author" content="Neo Alienson">
<meta property="article:tag" content="Data Modeling">
<meta property="article:tag" content="Data Warehousing">
<meta property="article:tag" content="Database">
<meta name="twitter:card" content="summary">
    
    <!-- hexo injector head_end start --><link rel="stylesheet" type="text/css" href="/css/bundle.css"><script type="text/javascript" src="/js/bundle_first.js"></script><!-- hexo injector head_end end --><meta name="generator" content="Hexo 8.1.0">  <link rel="canonical" href="https://neo01.com/2006/12/Slowly-Changing-Dimensions-Managing-Historical-Data/">
  <link rel="alternate" hreflang="en" data-canonical="true" href="https://neo01.com/2006/12/Slowly-Changing-Dimensions-Managing-Historical-Data/">
  <link rel="alternate" hreflang="zh-TW" href="https://neo01.com/zh-TW/2006/12/Slowly-Changing-Dimensions-Managing-Historical-Data/">
  <link rel="alternate" hreflang="zh-CN" href="https://neo01.com/zh-CN/2006/12/Slowly-Changing-Dimensions-Managing-Historical-Data/">
<style id="admonition-styles">.admonition {
  margin: 1em 0;
  padding: 0rem;
  border-left: 0.3rem solid;
  border-radius: 0.4rem;
  background-color: #f9f9f9;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.04);
  overflow: hidden;
  page-break-inside: avoid;
}

.admonition-title {
  display: flex;
  align-items: center;
  font-weight: 600;
  padding: 0rem 1rem 0.1rem 0.75rem;
  font-size: 1.05em;
  background-color: rgba(0, 0, 0, 0.03);
  border-top-left-radius: 0.4rem;
  border-top-right-radius: 0.4rem;
  margin: 0 !important;
}

.admonition-icon {
  font-size: 1.2em;
  margin-right: 0.6rem;
  opacity: 0.85;
  margin-top: 0.1rem;
}

/* 内容区域 margin */
.admonition > *:not(.admonition-title) {
  margin: 0.6rem 1rem 0.6rem 1rem;
}

/* NOTE 类型 */
.admonition.anote {
  border-color: #448aff;
}
.admonition.anote > .admonition-title {
  background-color: #448aff1a;
  color: #2962ff;
}

/* INFO / TODO 类型 */
.admonition.info,
.admonition.todo {
  border-color: #00b8d4;
}
.admonition.info > .admonition-title,
.admonition.todo > .admonition-title {
  background-color: rgba(0, 184, 212, 0.1);
  color: #007c91;
}

/* 警告类 */
.admonition.warning,
.admonition.attention,
.admonition.caution {
  border-color: #ff9100;
}
.admonition.warning > .admonition-title,
.admonition.attention > .admonition-title,
.admonition.caution > .admonition-title {
  background-color: rgba(255, 145, 0, 0.1);
  color: #c66900;
}

/* 错误类 */
.admonition.failure,
.admonition.missing,
.admonition.fail,
.admonition.error,
.admonition.danger,
.admonition.bug {
  border-color: #ff5252;
}
.admonition.failure > .admonition-title,
.admonition.missing > .admonition-title,
.admonition.fail > .admonition-title,
.admonition.error > .admonition-title,
.admonition.danger > .admonition-title,
.admonition.bug > .admonition-title {
  background-color: rgba(255, 82, 82, 0.1);
  color: #b71c1c;
}

/* TIP 类型 */
.admonition.tip {
  border-color: #00bfa5;
}
.admonition.tip > .admonition-title {
  background-color: #00bfa51a;
  color: #00796b;
}

/* SUCCESS 类型 */
.admonition.success {
  border-color: #00c853;
}
.admonition.success > .admonition-title {
  background-color: #00c8531a;
  color: #2e7d32;
}

/* QUESTION 类型 */
.admonition.question {
  border-color: #64dd17;
}
.admonition.question > .admonition-title {
  background-color: #64dd171a;
  color: #558b2f;
}

/* EXAMPLE 类型 */
.admonition.example {
  border-color: #7c4dff;
}
.admonition.example > .admonition-title {
  background-color: #7c4dff1a;
  color: #512da8;
}

/* QUOTE 类型 */
.admonition.quote {
  border-color: #9e9e9e;
}
.admonition.quote > .admonition-title {
  background-color: #9e9e9e1a;
  color: #424242;
}

/*黑暗模式*/
/* 夜间模式基础样式 */
[data-theme="dark"] .admonition {
  background-color: #1e1e1e;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.4);
}

[data-theme="dark"] .admonition-title {
  background-color: rgba(255, 255, 255, 0.05);
}

/* anote */
[data-theme="dark"] .admonition.anote {
  border-color: #82b1ff;
}
[data-theme="dark"] .admonition.anote > .admonition-title {
  background-color: #82b1ff1a;
  color: #bbdefb;
}

/* tip */
[data-theme="dark"] .admonition.tip {
  border-color: #64ffda;
}
[data-theme="dark"] .admonition.tip > .admonition-title {
  background-color: #64ffda1a;
  color: #1de9b6;
}

/* success */
[data-theme="dark"] .admonition.success {
  border-color: #69f0ae;
}
[data-theme="dark"] .admonition.success > .admonition-title {
  background-color: #69f0ae1a;
  color: #00e676;
}

/* question */
[data-theme="dark"] .admonition.question {
  border-color: #b2ff59;
}
[data-theme="dark"] .admonition.question > .admonition-title {
  background-color: #b2ff591a;
  color: #aeea00;
}

/* example */
[data-theme="dark"] .admonition.example {
  border-color: #b388ff;
}
[data-theme="dark"] .admonition.example > .admonition-title {
  background-color: #b388ff1a;
  color: #b39ddb;
}

/* quote */
[data-theme="dark"] .admonition.quote {
  border-color: #bdbdbd;
}
[data-theme="dark"] .admonition.quote > .admonition-title {
  background-color: #bdbdbd1a;
  color: #eeeeee;
}

/* warning / attention / caution */
[data-theme="dark"] .admonition.warning,
[data-theme="dark"] .admonition.attention,
[data-theme="dark"] .admonition.caution {
  border-color: #ffb300;
}
[data-theme="dark"] .admonition.warning > .admonition-title,
[data-theme="dark"] .admonition.attention > .admonition-title,
[data-theme="dark"] .admonition.caution > .admonition-title {
  background-color: #ffb3001a;
  color: #ffe082;
}

/* error / fail / failure / bug / danger / missing */
[data-theme="dark"] .admonition.error,
[data-theme="dark"] .admonition.fail,
[data-theme="dark"] .admonition.failure,
[data-theme="dark"] .admonition.bug,
[data-theme="dark"] .admonition.missing,
[data-theme="dark"] .admonition.danger {
  border-color: #ef5350;
}
[data-theme="dark"] .admonition.error > .admonition-title,
[data-theme="dark"] .admonition.fail > .admonition-title,
[data-theme="dark"] .admonition.failure > .admonition-title,
[data-theme="dark"] .admonition.bug > .admonition-title,
[data-theme="dark"] .admonition.missing > .admonition-title,
[data-theme="dark"] .admonition.danger > .admonition-title {
  background-color: #ef53501a;
  color: #ff8a80;
}</style></head>

<body>
    <div id="wrap">
        
        
<header id="header">
    <div id="header-outer" class="outer">
        <div class="container">
            <div class="container-inner">
                <div id="header-title">
                    <h1 class="logo-wrap">
                        <div class="logo"></div>
                    </h1>

                        <h2 class="subtitle-wrap">
                            <p class="title">解码数字异常</p>
                          <p class="subtitle">有时功能就是数字兔子洞中的错误，反之亦然</p>
                        </h2>




                    <div id="lang-selector">
                        <span class="lang-icon">🌐</span>
                        
                            <a href="#" class="lang-link" data-lang="en">English</a>
<span class="lang-sep">|</span>                            <a href="#" class="lang-link" data-lang="zh-TW">繁體中文</a>
                        <script>
                        document.addEventListener('DOMContentLoaded', function() {
                            var currentLang = 'zh-CN';
                            var currentPath = window.location.pathname;
                            var basePath;
                            
                            if (currentLang === 'en') {
                                basePath = currentPath;
                            } else {
                                basePath = currentPath.replace(new RegExp('^/' + currentLang + '/'), '/');
                            }
                            
                            document.querySelectorAll('.lang-link').forEach(function(link) {
                                var targetLang = link.getAttribute('data-lang');
                                var targetPath;
                                if (targetLang === 'en') {
                                    targetPath = basePath;
                                } else {
                                    targetPath = '/' + targetLang + basePath;
                                }
                                link.href = targetPath;
                            });
                        });
                        </script>
                    </div>


                </div>
                <div id="header-inner" class="nav-container">
                    <a id="main-nav-toggle" class="nav-icon fa fa-bars"></a>
                    <div class="nav-container-inner">
                        <ul id="main-nav">
                            
                                <li class="main-nav-list-item">
                                    <a class="main-nav-list-link" href="/zh-CN/">主页</a>
                                </li>
                                                                    <ul class="main-nav-list"><li class="main-nav-list-item"><a class="main-nav-list-link" href="/zh-CN/categories/AI/">人工智能</a><ul class="main-nav-list-child"><li class="main-nav-list-item"><a class="main-nav-list-link" href="/zh-CN/categories/AI/Art-Gallery/">艺术画廊</a></li></ul></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/zh-CN/categories/Architecture/">架构</a></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/zh-CN/categories/Cybersecurity/">网络安全</a></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/zh-CN/categories/Development/">开发</a></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/zh-CN/categories/Misc/">杂项</a></li></ul>
                                <li class="main-nav-list-item">
                                    <a class="main-nav-list-link" href="/zh-CN/about-me/">关于</a>
                                </li>
                            
                        </ul>
                        <nav id="sub-nav">
                            <div id="search-form-wrap">

    <form class="search-form">
        <input type="text" class="ins-search-input search-form-input" id="search-form-input" placeholder="搜索">
        <button type="submit" title="搜索" class="search-form-submit"></button>
    </form>
    <div class="ins-search">
    <div class="ins-search-mask"></div>
    <div class="ins-search-container">
        <div class="ins-input-wrapper">
            <input type="text" class="ins-search-input" id="ins-search-input" placeholder="想要查找什么...">
            <span class="ins-close ins-selectable"><i class="fa fa-times-circle"></i></span>
        </div>
        <div class="ins-section-wrapper">
            <div class="ins-section-container"></div>
        </div>
    </div>
</div>
<script integrity="sha256-B5nfCL2Dym3Ba4YJFI7wB3f4vtClbrYJZ32A5erBEdg=">
(function (window) {
    var INSIGHT_CONFIG = {
        TRANSLATION: {
            POSTS: '文章',
            PAGES: '页面',
            CATEGORIES: '分类',
            TAGS: '标签',
            UNTITLED: '(未命名)',
        },
        ROOT_URL: '/',
        CONTENT_URL: '/content.json',
        LANG: 'zh-CN',
    };
    window.INSIGHT_CONFIG = INSIGHT_CONFIG;
})(window);
</script>




</div>
                        </nav>
                    </div>
                </div>
            </div>
        </div>
    </div>
</header>

        
        <div class="container">
            <div class="main-body container-inner">
                <div class="main-body-inner">
                    <section id="main">
                        <div class="main-body-header">
    <h1 class="header">
    
    <a class="page-title-link" href="/categories/Architecture/">Architecture</a>
    </h1>
</div>

                        <div class="main-body-content">
                            <article id="post-2006/12/Slowly-Changing-Dimensions-Managing-Historical-Data-zh-CN" class="article article-single article-type-post" itemscope="" itemprop="blogPost">
    <div class="article-inner responsive-content">
        
            <header class="article-header">
                
    
        <h1 class="article-title" itemprop="name">
        缓慢变化维度：管理数据仓库中的历史数据
        </h1>
    

            </header>
        
        
            <div class="article-meta">
                
    <div class="article-date">
      <i class="fa fa-calendar"></i>
        
          Created <time datetime="2006-12-10T16:00:00.000Z" itemprop="datePublished">2006-12-11</time>
          &nbsp;<i class="fa fa-calendar"></i>
          Updated <time datetime="2025-11-26T17:14:31.215Z" itemprop="datePublished">2025-11-27</time>
        
    </div>


                

                
    <div class="article-tag">
        <i class="fa fa-tag"></i>
        <a class="tag-link" href="/zh-CN/tags/Data-Warehousing/">Data Warehousing</a> <a class="tag-link" href="/zh-CN/tags/Database/">Database</a> <a class="tag-link" href="/zh-CN/tags/Data-Modeling/">Data Modeling</a>
    </div>

            </div>
        
        
        
        <div class="article-entry" itemprop="articleBody">
            <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8E%86%E5%8F%B2%E6%95%B0%E6%8D%AE%E9%97%AE%E9%A2%98"><span class="toc-text">历史数据问题</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SCD-%E7%B1%BB%E5%9E%8B%E5%88%86%E7%B1%BB"><span class="toc-text">SCD 类型分类</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%B1%BB%E5%9E%8B-0%EF%BC%9A%E4%BF%9D%E7%95%99%E5%8E%9F%E5%A7%8B%E5%80%BC"><span class="toc-text">类型 0：保留原始值</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%B1%BB%E5%9E%8B-1%EF%BC%9A%E8%A6%86%E5%86%99"><span class="toc-text">类型 1：覆写</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%B1%BB%E5%9E%8B-2%EF%BC%9A%E6%B7%BB%E5%8A%A0%E8%A1%8C"><span class="toc-text">类型 2：添加行</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%B1%BB%E5%9E%8B-3%EF%BC%9A%E6%B7%BB%E5%8A%A0%E5%B1%9E%E6%80%A7"><span class="toc-text">类型 3：添加属性</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%B1%BB%E5%9E%8B-4%EF%BC%9A%E6%B7%BB%E5%8A%A0%E5%8E%86%E5%8F%B2%E8%A1%A8"><span class="toc-text">类型 4：添加历史表</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%B1%BB%E5%9E%8B-6%EF%BC%9A%E7%BB%84%E5%90%88%E6%96%B9%E6%B3%95"><span class="toc-text">类型 6：组合方法</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%B1%BB%E5%9E%8B-7%EF%BC%9A%E5%8F%8C%E9%94%AE%E7%AD%96%E7%95%A5"><span class="toc-text">类型 7：双键策略</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%80%89%E6%8B%A9%E6%AD%A3%E7%A1%AE%E7%9A%84%E7%B1%BB%E5%9E%8B"><span class="toc-text">选择正确的类型</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BB%93%E8%AE%BA"><span class="toc-text">结论</span></a></li></ol>
            <p>数据仓库承诺提供历史分析，但维度数据却不愿保持静止。客户搬迁、产品变更类别、销售员调到新区域。这些变化看似简单，直到你问：历史报表应该反映旧状态还是新状态？</p>
<p>传统数据库通过更新处理变化——用新值覆写旧值。这对专注于当前状态的事务系统有效，但会破坏使数据仓库有价值的历史背景。当销售员从加州调到伊利诺伊州时，他们过去的销售额应该出现在加州还是伊利诺伊州的区域报表中？</p>
<p>缓慢变化维度（SCD）解决了这个挑战。与快速变化的事务数据（客户 ID、数量、价格）不同，维度属性如位置、名称和类别的变化频率较低但不可预测。SCD 中的"缓慢"并不意味着变化罕见，而是指它们不是正常事务流程的一部分。</p>
<p>Ralph Kimball 的《数据仓库工具包》推广了处理这些变化的分类系统：类型 0 到 7。每种类型代表历史准确性、数据复杂性和查询性能之间的不同权衡。类型 1 牺牲历史以换取简单性。类型 2 以复杂性为代价保留完整历史。类型 6 结合多种方法以获得最大灵活性。</p>
<p>挑战不仅限于技术实现。SCD 必须维护事实表和维度表之间的引用完整性。销售事实表链接到供应商维度。当供应商搬迁时，历史销售记录必须仍然连接到正确的供应商信息，而不破坏数据库关系。</p>
<p>本文探讨每种 SCD 类型，检视其权衡，并提供针对不同场景选择正确方法的指导。</p>
<h2 id="历史数据问题">历史数据问题</h2>
<p>在探索解决方案之前，理解问题可以揭示为什么维度变化会产生复杂性。</p>
<h3 id="供应商搬迁场景">供应商搬迁场景</h3>
<p>考虑一个跟踪供应商关系的数据仓库：</p>
<div class="admonition anote"><p class="admonition-title"><span class="mdi mdi-note-outline admonition-icon"></span>📊 初始状态</p><div class="admonition-content"><p><strong>供应商维度</strong></p>
<ul>
<li>供应商：Acme Supply Co</li>
<li>位置：加州</li>
<li>供应商代码：ABC</li>
</ul>
<p><strong>事实表</strong></p>
<ul>
<li>2005 年销售额：$500,000</li>
<li>2006 年销售额：$750,000</li>
</ul>
<p><strong>业务问题</strong>
"我们 2005 年在加州的供应商销售额是多少？"</p>
</div></div>
<p>答案似乎很明显：$500,000。但当 Acme 在 2007 年搬迁到伊利诺伊州时，问题变得模糊。报表应该显示：</p>
<ol>
<li><strong>当前状态</strong>：加州销售额为零（Acme 现在在伊利诺伊州）</li>
<li><strong>历史状态</strong>：$500,000（Acme 在 2005 年时在加州）</li>
<li><strong>两者皆可</strong>：取决于查询</li>
</ol>
<p>不同的业务需求需要不同的答案。税务报告需要历史准确性——销售发生在加州，无论当前位置如何。战略规划可能需要当前状态——了解当前供应商分布比过去位置更重要。</p>
<h3 id="引用完整性挑战">引用完整性挑战</h3>
<p>数据库关系使事情变得更加复杂：</p>
<div class="admonition error"><p class="admonition-title"><span class="mdi mdi-alert-circle-outline admonition-icon"></span>🚫 更新问题</p><div class="admonition-content"><p><strong>场景</strong></p>
<ul>
<li>事实表引用 Supplier_Key = 123</li>
<li>供应商 123 是"Acme Supply Co, CA"</li>
<li>供应商搬迁到伊利诺伊州</li>
</ul>
<p><strong>选项 1：就地更新</strong></p>
<ul>
<li>将供应商 123 改为"Acme Supply Co, IL"</li>
<li>历史事实现在显示伊利诺伊州</li>
<li>损失：历史准确性</li>
</ul>
<p><strong>选项 2：创建新记录</strong></p>
<ul>
<li>添加供应商 124 为"Acme Supply Co, IL"</li>
<li>保留供应商 123 为"Acme Supply Co, CA"</li>
<li>问题：新事务使用哪个键？</li>
<li>问题：如何查询"所有 Acme 事务"？</li>
</ul>
</div></div>
<p>两种选项都无法满足所有需求。更新会破坏历史。新记录会破坏自然键关系。SCD 提供了结构化的方法来解决这个困境。</p>
<h3 id="为什么-缓慢变化-很重要">为什么"缓慢变化"很重要</h3>
<p>缓慢变化和快速变化数据之间的区别至关重要：</p>
<div class="admonition anote"><p class="admonition-title"><span class="mdi mdi-note-outline admonition-icon"></span>🔄 变化频率比较</p><div class="admonition-content"><p><strong>快速变化（事务型）</strong></p>
<ul>
<li>每笔订单中的客户 ID</li>
<li>每笔销售中的产品 ID</li>
<li>数量、价格、日期</li>
<li>变化：每天数百万次</li>
<li>策略：存储每笔事务</li>
</ul>
<p><strong>缓慢变化（维度型）</strong></p>
<ul>
<li>客户地址</li>
<li>产品类别</li>
<li>供应商位置</li>
<li>变化：每月数十次</li>
<li>策略：取决于业务需求</li>
</ul>
</div></div>
<p>事务数据变化是预期的且经过设计。维度变化是需要特殊处理的例外。"缓慢"限定词表示这些变化发生在正常事务流程之外，使它们更难预测和管理。</p>
<h2 id="SCD-类型分类">SCD 类型分类</h2>
<p>Ralph Kimball 的分类系统提供了处理维度变化的结构化方法。</p>
<h3 id="类型系统概述">类型系统概述</h3>
<div class="admonition anote"><p class="admonition-title"><span class="mdi mdi-note-outline admonition-icon"></span>📋 SCD 类型一览</p><div class="admonition-content"><p><strong>类型 0：保留原始值</strong></p>
<ul>
<li>永不改变</li>
<li>保留原始值</li>
<li>示例：出生日期</li>
</ul>
<p><strong>类型 1：覆写</strong></p>
<ul>
<li>用新值替换旧值</li>
<li>不维护历史</li>
<li>最简单的方法</li>
</ul>
<p><strong>类型 2：添加行</strong></p>
<ul>
<li>为每次变化创建新记录</li>
<li>保留完整历史</li>
<li>最常见的方法</li>
</ul>
<p><strong>类型 3：添加属性</strong></p>
<ul>
<li>在列中存储有限历史</li>
<li>仅跟踪前一个值</li>
<li>简单查询</li>
</ul>
<p><strong>类型 4：添加历史表</strong></p>
<ul>
<li>独立的历史表</li>
<li>当前和历史数据分离</li>
<li>审计式跟踪</li>
</ul>
<p><strong>类型 6：组合方法（1+2+3）</strong></p>
<ul>
<li>混合方法</li>
<li>多种跟踪方法</li>
<li>最大灵活性</li>
</ul>
<p><strong>类型 7：双键</strong></p>
<ul>
<li>代理键和自然键</li>
<li>灵活的查询选项</li>
<li>复杂实现</li>
</ul>
</div></div>
<p>每种类型代表不同的优先级。类型 1 优先考虑简单性而非历史。类型 2 优先考虑历史而非简单性。类型 6 试图以复杂性为代价提供两者。</p>
<h3 id="选择因素">选择因素</h3>
<p>正确的类型取决于具体需求：</p>
<div class="admonition anote"><p class="admonition-title"><span class="mdi mdi-note-outline admonition-icon"></span>🎯 决策因素</p><div class="admonition-content"><p><strong>历史准确性</strong></p>
<ul>
<li>过去状态有多重要？</li>
<li>法规要求？</li>
<li>需要审计轨迹？</li>
</ul>
<p><strong>查询模式</strong></p>
<ul>
<li>当前状态查询？</li>
<li>历史状态查询？</li>
<li>两种类型都需要？</li>
</ul>
<p><strong>数据量</strong></p>
<ul>
<li>变化多久发生一次？</li>
<li>存储限制？</li>
<li>性能要求？</li>
</ul>
<p><strong>复杂度容忍度</strong></p>
<ul>
<li>团队专业知识？</li>
<li>维护负担？</li>
<li>ETL 复杂性可接受？</li>
</ul>
</div></div>
<p>没有单一类型适合所有场景。许多数据仓库对不同维度使用不同类型，甚至对同一维度内的不同属性使用不同类型。</p>
<h2 id="类型-0：保留原始值">类型 0：保留原始值</h2>
<p>某些属性根据定义永不改变。</p>
<h3 id="不可变属性">不可变属性</h3>
<p>类型 0 适用于具有持久值的属性：</p>
<div class="admonition success"><p class="admonition-title"><span class="mdi mdi-check-circle-outline admonition-icon"></span>✅ 类型 0 特性</p><div class="admonition-content"><p><strong>定义</strong></p>
<ul>
<li>属性永不改变</li>
<li>原始值永久保留</li>
<li>不需要特殊处理</li>
</ul>
<p><strong>常见示例</strong></p>
<ul>
<li>出生日期</li>
<li>原始信用评分</li>
<li>账户创建日期</li>
<li>初始分类</li>
</ul>
<p><strong>实现</strong></p>
<ul>
<li>标准列</li>
<li>无更新逻辑</li>
<li>最简单的方法</li>
</ul>
</div></div>
<p>类型 0 实际上不是"缓慢变化"维度——它是"永不变化"维度。此分类的存在是为了明确识别永远不应更新的属性，防止意外修改。</p>
<h3 id="日期维度">日期维度</h3>
<p>日期维度通常对大多数属性使用类型 0：</p>
<pre class="language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> Date_Dimension <span class="token punctuation">(</span>
    Date_Key <span class="token keyword">INT</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span><span class="token punctuation">,</span>
    Full_Date <span class="token keyword">DATE</span><span class="token punctuation">,</span>
    Day_Of_Week <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    Month_Name <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    Quarter <span class="token keyword">INT</span><span class="token punctuation">,</span>
    <span class="token keyword">Year</span> <span class="token keyword">INT</span><span class="token punctuation">,</span>
    Is_Holiday <span class="token keyword">BOOLEAN</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<div class="admonition anote"><p class="admonition-title"><span class="mdi mdi-note-outline admonition-icon"></span>📅 日期维度稳定性</p><div class="admonition-content"><p><strong>为什么类型 0 有效</strong></p>
<ul>
<li>2006 年 1 月 1 日永远是 2006 年 1 月 1 日</li>
<li>给定日期的星期几永不改变</li>
<li>季度和年份是固定的</li>
</ul>
<p><strong>例外：Is_Holiday</strong></p>
<ul>
<li>假日指定可能会改变</li>
<li>宣布新假日</li>
<li>可能需要类型 1 或类型 2</li>
</ul>
</div></div>
<p>日期维度展示了类型 0 的简单性。一旦填充，它们很少需要更新。这种稳定性使它们成为事实表连接和基于时间分析的理想选择。</p>
<h3 id="业务价值">业务价值</h3>
<p>类型 0 提供清晰度和保护：</p>
<div class="admonition success"><p class="admonition-title"><span class="mdi mdi-check-circle-outline admonition-icon"></span>✅ 类型 0 优势</p><div class="admonition-content"><p><strong>清晰度</strong></p>
<ul>
<li>明确标记不可变数据</li>
<li>记录业务规则</li>
<li>防止混淆</li>
</ul>
<p><strong>保护</strong></p>
<ul>
<li>无意外更新</li>
<li>保证数据完整性</li>
<li>审计合规</li>
</ul>
<p><strong>性能</strong></p>
<ul>
<li>无版本检查</li>
<li>简单查询</li>
<li>最小存储</li>
</ul>
</div></div>
<p>在设计期间识别类型 0 属性可以防止未来问题。当业务规则声明"这永不改变"时，类型 0 在数据模型层级强制执行该规则。</p>
<h2 id="类型-1：覆写">类型 1：覆写</h2>
<p>最简单的方法：用新值替换旧值。</p>
<h3 id="类型-1-如何运作">类型 1 如何运作</h3>
<p>类型 1 就地更新记录：</p>
<p><strong>初始状态：</strong></p>
<table>
<thead>
<tr>
<th>Supplier_Key</th>
<th>Supplier_Code</th>
<th>Supplier_Name</th>
<th>Supplier_State</th>
</tr>
</thead>
<tbody>
<tr>
<td>123</td>
<td>ABC</td>
<td>Acme Supply Co</td>
<td>CA</td>
</tr>
</tbody>
</table>
<p><strong>搬迁后：</strong></p>
<table>
<thead>
<tr>
<th>Supplier_Key</th>
<th>Supplier_Code</th>
<th>Supplier_Name</th>
<th>Supplier_State</th>
</tr>
</thead>
<tbody>
<tr>
<td>123</td>
<td>ABC</td>
<td>Acme Supply Co</td>
<td>IL</td>
</tr>
</tbody>
</table>
<pre class="language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">UPDATE</span> Supplier
<span class="token keyword">SET</span> Supplier_State <span class="token operator">=</span> <span class="token string">'IL'</span>
<span class="token keyword">WHERE</span> Supplier_Code <span class="token operator">=</span> <span class="token string">'ABC'</span><span class="token punctuation">;</span></code></pre>
<p>旧值消失。新值取而代之。没有历史，没有复杂性。</p>
<h3 id="何时类型-1-有意义">何时类型 1 有意义</h3>
<p>类型 1 适用于特定场景：</p>
<div class="admonition success"><p class="admonition-title"><span class="mdi mdi-check-circle-outline admonition-icon"></span>✅ 良好的类型 1 使用案例</p><div class="admonition-content"><p><strong>错误更正</strong></p>
<ul>
<li>数据输入中的错字</li>
<li>不正确的初始值</li>
<li>数据质量修正</li>
<li>错误不需要历史</li>
</ul>
<p><strong>无关紧要的变化</strong></p>
<ul>
<li>不影响分析的变化</li>
<li>外观更新</li>
<li>标准化变化</li>
<li>示例："St."改为"Street"</li>
</ul>
<p><strong>仅当前状态</strong></p>
<ul>
<li>不需要历史报告</li>
<li>当前快照足够</li>
<li>存储限制</li>
<li>简单报告需求</li>
</ul>
</div></div>
<p>供应商的电话号码可能使用类型 1。历史电话号码很少对分析重要。当号码改变时，覆写它。报表始终显示当前联系信息。</p>
<h3 id="简单性的代价">简单性的代价</h3>
<p>类型 1 的简单性伴随着重大限制：</p>
<div class="admonition error"><p class="admonition-title"><span class="mdi mdi-alert-circle-outline admonition-icon"></span>🚫 类型 1 限制</p><div class="admonition-content"><p><strong>历史丢失</strong></p>
<ul>
<li>无法回答"2005 年的值是什么？"</li>
<li>审计轨迹被破坏</li>
<li>合规问题</li>
<li>不可逆的数据丢失</li>
</ul>
<p><strong>聚合影响</strong></p>
<ul>
<li>预先计算的聚合变得不正确</li>
<li>必须重新计算摘要</li>
<li>示例："按州销售"追溯变化</li>
<li>性能影响</li>
</ul>
<p><strong>报告混淆</strong></p>
<ul>
<li>历史报表显示当前值</li>
<li>"加州销售"在搬迁后显示零</li>
<li>业务用户困惑</li>
<li>对数据的信任受损</li>
</ul>
</div></div>
<h3 id="聚合重新计算问题">聚合重新计算问题</h3>
<p>类型 1 产生级联更新：</p>
<div class="admonition warning"><p class="admonition-title"><span class="mdi mdi-alert-outline admonition-icon"></span>⚠️ 聚合维护</p><div class="admonition-content"><p><strong>场景</strong></p>
<ul>
<li>聚合表：按供应商州的销售</li>
<li>加州总计：$5,000,000</li>
<li>伊利诺伊州总计：$2,000,000</li>
</ul>
<p><strong>类型 1 更新后</strong></p>
<ul>
<li>供应商从 CA 搬到 IL</li>
<li>聚合表现在不正确</li>
<li>必须重新计算：
<ul>
<li>从加州减去</li>
<li>加到伊利诺伊州</li>
</ul>
</li>
</ul>
<p><strong>问题</strong></p>
<ul>
<li>昂贵的重新计算</li>
<li>影响多个聚合表</li>
<li>ETL 复杂性增加</li>
<li>违背聚合的目的</li>
</ul>
</div></div>
<p>预先计算的聚合存在是为了性能。类型 1 变化强制重新计算，抵消了性能优势。这使得类型 1 不适合用于聚合表中的维度。</p>
<h3 id="实现考量">实现考量</h3>
<p>类型 1 需要仔细规划：</p>
<div class="admonition tip"><p class="admonition-title"><span class="mdi mdi-lightbulb-on-outline admonition-icon"></span>💡 类型 1 最佳实践</p><div class="admonition-content"><p><strong>记录决策</strong></p>
<ul>
<li>明确标记类型 1 属性</li>
<li>解释为什么不需要历史</li>
<li>获得业务签核</li>
</ul>
<p><strong>审计轨迹替代方案</strong></p>
<ul>
<li>考虑数据库审计日志</li>
<li>独立审计表</li>
<li>折衷：简单更新，外部历史</li>
</ul>
<p><strong>混合方法</strong></p>
<ul>
<li>某些属性使用类型 1</li>
<li>其他属性使用类型 2</li>
<li>同一维度，不同策略</li>
</ul>
</div></div>
<p>类型 1 与其他类型结合使用效果最佳。对历史真正不重要的属性使用类型 1，对重要的属性使用类型 2。</p>
<h2 id="类型-2：添加行">类型 2：添加行</h2>
<p>最常见的 SCD 方法：为每次变化创建新记录。</p>
<h3 id="类型-2-如何运作">类型 2 如何运作</h3>
<p>类型 2 通过多笔记录保留完整历史：</p>
<p><strong>初始状态：</strong></p>
<table>
<thead>
<tr>
<th>Supplier_Key</th>
<th>Supplier_Code</th>
<th>Supplier_Name</th>
<th>Supplier_State</th>
<th>Version</th>
</tr>
</thead>
<tbody>
<tr>
<td>123</td>
<td>ABC</td>
<td>Acme Supply Co</td>
<td>CA</td>
<td>0</td>
</tr>
</tbody>
</table>
<p><strong>第一次搬迁后：</strong></p>
<table>
<thead>
<tr>
<th>Supplier_Key</th>
<th>Supplier_Code</th>
<th>Supplier_Name</th>
<th>Supplier_State</th>
<th>Version</th>
</tr>
</thead>
<tbody>
<tr>
<td>123</td>
<td>ABC</td>
<td>Acme Supply Co</td>
<td>CA</td>
<td>0</td>
</tr>
<tr>
<td>124</td>
<td>ABC</td>
<td>Acme Supply Co</td>
<td>IL</td>
<td>1</td>
</tr>
</tbody>
</table>
<p>每次变化都会创建一个具有新代理键的新行。自然键（Supplier_Code）保持不变，但代理键（Supplier_Key）会改变。</p>
<h3 id="实现变化">实现变化</h3>
<p>类型 2 有几种实现模式：</p>
<div class="admonition anote"><p class="admonition-title"><span class="mdi mdi-note-outline admonition-icon"></span>🔧 类型 2 实现选项</p><div class="admonition-content"><p><strong>版本号</strong></p>
<ul>
<li>顺序版本列</li>
<li>易于理解</li>
<li>容易找到最新版本</li>
</ul>
<p><strong>生效日期</strong></p>
<ul>
<li>Start_Date 和 End_Date 列</li>
<li>精确的时间跟踪</li>
<li>支持时间点查询</li>
</ul>
<p><strong>当前标志</strong></p>
<ul>
<li>布尔值指示当前记录</li>
<li>快速当前状态查询</li>
<li>通常与日期结合</li>
</ul>
</div></div>
<p><strong>生效日期实现：</strong></p>
<table>
<thead>
<tr>
<th>Supplier_Key</th>
<th>Supplier_Code</th>
<th>Supplier_Name</th>
<th>Supplier_State</th>
<th>Start_Date</th>
<th>End_Date</th>
</tr>
</thead>
<tbody>
<tr>
<td>123</td>
<td>ABC</td>
<td>Acme Supply Co</td>
<td>CA</td>
<td>2000-01-01</td>
<td>2004-12-22</td>
</tr>
<tr>
<td>124</td>
<td>ABC</td>
<td>Acme Supply Co</td>
<td>IL</td>
<td>2004-12-22</td>
<td>NULL</td>
</tr>
</tbody>
</table>
<p>NULL End_Date 表示当前记录。某些实现使用高日期值（9999-12-31）而不是 NULL，以避免在查询中处理 null。</p>
<p><strong>当前标志实现：</strong></p>
<table>
<thead>
<tr>
<th>Supplier_Key</th>
<th>Supplier_Code</th>
<th>Supplier_Name</th>
<th>Supplier_State</th>
<th>Effective_Date</th>
<th>Current_Flag</th>
</tr>
</thead>
<tbody>
<tr>
<td>123</td>
<td>ABC</td>
<td>Acme Supply Co</td>
<td>CA</td>
<td>2000-01-01</td>
<td>N</td>
</tr>
<tr>
<td>124</td>
<td>ABC</td>
<td>Acme Supply Co</td>
<td>IL</td>
<td>2004-12-22</td>
<td>Y</td>
</tr>
</tbody>
</table>
<p>Current_Flag 启用快速筛选：<code>WHERE Current_Flag = 'Y'</code> 仅返回当前记录。</p>
<h3 id="事实表集成">事实表集成</h3>
<p>类型 2 的威力来自事实表集成：</p>
<div class="admonition success"><p class="admonition-title"><span class="mdi mdi-check-circle-outline admonition-icon"></span>✅ 类型 2 优势</p><div class="admonition-content"><p><strong>历史准确性</strong></p>
<ul>
<li>事实链接到正确的历史维度</li>
<li>2003 年的事务链接到 Supplier_Key 123（CA）</li>
<li>2005 年的事务链接到 Supplier_Key 124（IL）</li>
<li>报表显示准确的历史状态</li>
</ul>
<p><strong>无聚合更新</strong></p>
<ul>
<li>聚合保持正确</li>
<li>"按州销售"不会追溯变化</li>
<li>预先计算的摘要保持有效</li>
<li>维持性能</li>
</ul>
<p><strong>无限历史</strong></p>
<ul>
<li>跟踪每次变化</li>
<li>完整审计轨迹</li>
<li>支持合规要求</li>
<li>可能的时间旅行查询</li>
</ul>
</div></div>
<p>当事实表存储 Supplier_Key 时，它会捕获事务时的维度状态。2003 年的销售引用 Supplier_Key 123（加州）。即使供应商搬迁，该关系也永不改变。历史报表自动显示正确状态。</p>
<h3 id="查询模式">查询模式</h3>
<p>类型 2 支持多种查询模式：</p>
<p><strong>当前状态查询：</strong></p>
<pre class="language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">SELECT</span> 
    s<span class="token punctuation">.</span>Supplier_Name<span class="token punctuation">,</span>
    s<span class="token punctuation">.</span>Supplier_State<span class="token punctuation">,</span>
    <span class="token function">SUM</span><span class="token punctuation">(</span>f<span class="token punctuation">.</span>Sales_Amount<span class="token punctuation">)</span> <span class="token keyword">as</span> Total_Sales
<span class="token keyword">FROM</span> Fact_Sales f
<span class="token keyword">JOIN</span> Supplier s <span class="token keyword">ON</span> f<span class="token punctuation">.</span>Supplier_Key <span class="token operator">=</span> s<span class="token punctuation">.</span>Supplier_Key
<span class="token keyword">WHERE</span> s<span class="token punctuation">.</span>Current_Flag <span class="token operator">=</span> <span class="token string">'Y'</span>
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> s<span class="token punctuation">.</span>Supplier_Name<span class="token punctuation">,</span> s<span class="token punctuation">.</span>Supplier_State<span class="token punctuation">;</span></code></pre>
<p><strong>历史状态查询：</strong></p>
<pre class="language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">SELECT</span> 
    s<span class="token punctuation">.</span>Supplier_Name<span class="token punctuation">,</span>
    s<span class="token punctuation">.</span>Supplier_State<span class="token punctuation">,</span>
    <span class="token function">SUM</span><span class="token punctuation">(</span>f<span class="token punctuation">.</span>Sales_Amount<span class="token punctuation">)</span> <span class="token keyword">as</span> Total_Sales
<span class="token keyword">FROM</span> Fact_Sales f
<span class="token keyword">JOIN</span> Supplier s <span class="token keyword">ON</span> f<span class="token punctuation">.</span>Supplier_Key <span class="token operator">=</span> s<span class="token punctuation">.</span>Supplier_Key
<span class="token keyword">WHERE</span> f<span class="token punctuation">.</span>Sale_Date <span class="token operator">BETWEEN</span> s<span class="token punctuation">.</span>Start_Date <span class="token operator">AND</span> s<span class="token punctuation">.</span>End_Date
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> s<span class="token punctuation">.</span>Supplier_Name<span class="token punctuation">,</span> s<span class="token punctuation">.</span>Supplier_State<span class="token punctuation">;</span></code></pre>
<p><strong>时间点查询：</strong></p>
<pre class="language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">SELECT</span> 
    s<span class="token punctuation">.</span>Supplier_Name<span class="token punctuation">,</span>
    s<span class="token punctuation">.</span>Supplier_State
<span class="token keyword">FROM</span> Supplier s
<span class="token keyword">WHERE</span> s<span class="token punctuation">.</span>Supplier_Code <span class="token operator">=</span> <span class="token string">'ABC'</span>
  <span class="token operator">AND</span> <span class="token string">'2003-06-15'</span> <span class="token operator">BETWEEN</span> s<span class="token punctuation">.</span>Start_Date <span class="token operator">AND</span> <span class="token keyword">COALESCE</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span>End_Date<span class="token punctuation">,</span> <span class="token string">'9999-12-31'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<h3 id="类型-2-挑战">类型 2 挑战</h3>
<p>尽管很受欢迎，类型 2 仍有缺点：</p>
<div class="admonition warning"><p class="admonition-title"><span class="mdi mdi-alert-outline admonition-icon"></span>⚠️ 类型 2 挑战</p><div class="admonition-content"><p><strong>维度大小增长</strong></p>
<ul>
<li>每次变化都会添加一行</li>
<li>频繁变化的维度变得很大</li>
<li>存储影响</li>
<li>索引维护开销</li>
</ul>
<p><strong>ETL 复杂性</strong></p>
<ul>
<li>必须检测变化</li>
<li>关闭旧记录（设置 End_Date）</li>
<li>创建新记录</li>
<li>更新 Current_Flag</li>
<li>比类型 1 更复杂</li>
</ul>
<p><strong>自然键查询</strong></p>
<ul>
<li>每个自然键有多行</li>
<li>必须指定时间段或当前标志</li>
<li>连接变得更复杂</li>
<li>重复结果的风险</li>
</ul>
<p><strong>追溯变化</strong></p>
<ul>
<li>添加新属性很困难</li>
<li>不同属性的生效日期不同</li>
<li>可能需要重新处理事实</li>
<li>昂贵的操作</li>
</ul>
</div></div>
<h3 id="追溯变化问题">追溯变化问题</h3>
<p>类型 2 最大的挑战出现在维度模型变化时：</p>
<div class="admonition error"><p class="admonition-title"><span class="mdi mdi-alert-circle-outline admonition-icon"></span>🚫 追溯变化场景</p><div class="admonition-content"><p><strong>情况</strong></p>
<ul>
<li>维度跟踪 Supplier_State</li>
<li>业务添加需求：跟踪 Sales_Rep</li>
<li>Sales_Rep 的生效日期与 State 不同</li>
</ul>
<p><strong>问题</strong></p>
<ul>
<li>现有行有 State 变化</li>
<li>需要添加 Sales_Rep 变化</li>
<li>生效日期不一致</li>
<li>必须创建新的时间切片</li>
</ul>
<p><strong>影响</strong></p>
<ul>
<li>现有事实记录指向旧键</li>
<li>必须更新事实表</li>
<li>昂贵的操作</li>
<li>潜在的数据不一致</li>
</ul>
</div></div>
<p>这种场景使得类型 2 不适合经常进行结构变化的维度。当模型演变时，维护类型 2 的成本可能变得过高。</p>
<h3 id="最佳实践">最佳实践</h3>
<p>类型 2 需要纪律才能发挥最佳效果：</p>
<div class="admonition tip"><p class="admonition-title"><span class="mdi mdi-lightbulb-on-outline admonition-icon"></span>💡 类型 2 最佳实践</p><div class="admonition-content"><p><strong>需要代理键</strong></p>
<ul>
<li>事实中永不使用自然键</li>
<li>代理键启用版本控制</li>
<li>简化键管理</li>
</ul>
<p><strong>一致的日期处理</strong></p>
<ul>
<li>标准化使用 NULL 或高日期</li>
<li>记录惯例</li>
<li>在 ETL 中强制执行</li>
</ul>
<p><strong>索引策略</strong></p>
<ul>
<li>为当前查询索引 Current_Flag</li>
<li>为时间查询索引 Start_Date 和 End_Date</li>
<li>为查找索引自然键</li>
</ul>
<p><strong>ETL 变化检测</strong></p>
<ul>
<li>将来源与当前维度比较</li>
<li>有效检测变化</li>
<li>批次更新以提高性能</li>
</ul>
</div></div>
<p>类型 2 是大多数缓慢变化维度的默认选择。其历史准确性和查询灵活性的结合使其适用于广泛的场景。</p>
<h2 id="类型-3：添加属性">类型 3：添加属性</h2>
<p>类型 3 通过额外列跟踪有限历史。</p>
<h3 id="类型-3-如何运作">类型 3 如何运作</h3>
<p>类型 3 不是添加行，而是添加列：</p>
<p><strong>初始状态：</strong></p>
<table>
<thead>
<tr>
<th>Supplier_Key</th>
<th>Supplier_Code</th>
<th>Supplier_Name</th>
<th>Current_State</th>
</tr>
</thead>
<tbody>
<tr>
<td>123</td>
<td>ABC</td>
<td>Acme Supply Co</td>
<td>CA</td>
</tr>
</tbody>
</table>
<p><strong>添加类型 3 跟踪后：</strong></p>
<table>
<thead>
<tr>
<th>Supplier_Key</th>
<th>Supplier_Code</th>
<th>Supplier_Name</th>
<th>Original_State</th>
<th>Effective_Date</th>
<th>Current_State</th>
</tr>
</thead>
<tbody>
<tr>
<td>123</td>
<td>ABC</td>
<td>Acme Supply Co</td>
<td>CA</td>
<td>2004-12-22</td>
<td>IL</td>
</tr>
</tbody>
</table>
<p>表结构改变以容纳历史。Original_State 保留第一个值。Current_State 保存最新值。</p>
<h3 id="有限历史权衡">有限历史权衡</h3>
<p>类型 3 提供固定的历史深度：</p>
<div class="admonition anote"><p class="admonition-title"><span class="mdi mdi-note-outline admonition-icon"></span>📊 类型 3 特性</p><div class="admonition-content"><p><strong>跟踪内容</strong></p>
<ul>
<li>原始值</li>
<li>当前值</li>
<li>一个转换日期</li>
<li>无中间变化</li>
</ul>
<p><strong>限制</strong></p>
<ul>
<li>仅两个状态可见</li>
<li>第二次搬迁会覆写第一次变化</li>
<li>无法跟踪多次转换</li>
<li>固定列结构</li>
</ul>
<p><strong>优势</strong></p>
<ul>
<li>简单查询</li>
<li>无行倍增</li>
<li>固定表大小</li>
<li>易于理解</li>
</ul>
</div></div>
<h3 id="查询简单性">查询简单性</h3>
<p>类型 3 启用直接的查询：</p>
<pre class="language-sql" data-language="sql"><code class="language-sql"><span class="token comment">-- 当前状态分析</span>
<span class="token keyword">SELECT</span> 
    Current_State<span class="token punctuation">,</span>
    <span class="token function">SUM</span><span class="token punctuation">(</span>Sales_Amount<span class="token punctuation">)</span> <span class="token keyword">as</span> Total_Sales
<span class="token keyword">FROM</span> Supplier s
<span class="token keyword">JOIN</span> Fact_Sales f <span class="token keyword">ON</span> s<span class="token punctuation">.</span>Supplier_Key <span class="token operator">=</span> f<span class="token punctuation">.</span>Supplier_Key
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> Current_State<span class="token punctuation">;</span>

<span class="token comment">-- 原始状态分析</span>
<span class="token keyword">SELECT</span> 
    Original_State<span class="token punctuation">,</span>
    <span class="token function">SUM</span><span class="token punctuation">(</span>Sales_Amount<span class="token punctuation">)</span> <span class="token keyword">as</span> Total_Sales
<span class="token keyword">FROM</span> Supplier s
<span class="token keyword">JOIN</span> Fact_Sales f <span class="token keyword">ON</span> s<span class="token punctuation">.</span>Supplier_Key <span class="token operator">=</span> f<span class="token punctuation">.</span>Supplier_Key
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> Original_State<span class="token punctuation">;</span>

<span class="token comment">-- 转换分析</span>
<span class="token keyword">SELECT</span> 
    Original_State<span class="token punctuation">,</span>
    Current_State<span class="token punctuation">,</span>
    <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">as</span> Suppliers_Moved
<span class="token keyword">FROM</span> Supplier
<span class="token keyword">WHERE</span> Original_State <span class="token operator">!=</span> Current_State
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> Original_State<span class="token punctuation">,</span> Current_State<span class="token punctuation">;</span></code></pre>
<p>无日期范围检查。无当前标志。简单的列引用。</p>
<h3 id="何时类型-3-有意义">何时类型 3 有意义</h3>
<p>类型 3 适用于特定的分析需求：</p>
<div class="admonition success"><p class="admonition-title"><span class="mdi mdi-check-circle-outline admonition-icon"></span>✅ 良好的类型 3 使用案例</p><div class="admonition-content"><p><strong>前后分析</strong></p>
<ul>
<li>比较原始与当前</li>
<li>迁移跟踪</li>
<li>示例："从城市搬到乡村的客户"</li>
</ul>
<p><strong>固定转换</strong></p>
<ul>
<li>预期的一次变化</li>
<li>示例：产品发布状态（Beta → 已发布）</li>
<li>示例：客户层级（标准 → 高级）</li>
</ul>
<p><strong>简单报告</strong></p>
<ul>
<li>业务只需要两个视图</li>
<li>当前和原始就足够</li>
<li>不需要中间状态</li>
</ul>
</div></div>
<h3 id="前一个值变化">前一个值变化</h3>
<p>另一种方法跟踪最近的变化：</p>
<table>
<thead>
<tr>
<th>Supplier_Key</th>
<th>Supplier_Code</th>
<th>Supplier_Name</th>
<th>Previous_State</th>
<th>Change_Date</th>
<th>Current_State</th>
</tr>
</thead>
<tbody>
<tr>
<td>123</td>
<td>ABC</td>
<td>Acme Supply Co</td>
<td>CA</td>
<td>2004-12-22</td>
<td>IL</td>
</tr>
</tbody>
</table>
<p><strong>第二次搬迁后：</strong></p>
<table>
<thead>
<tr>
<th>Supplier_Key</th>
<th>Supplier_Code</th>
<th>Supplier_Name</th>
<th>Previous_State</th>
<th>Change_Date</th>
<th>Current_State</th>
</tr>
</thead>
<tbody>
<tr>
<td>123</td>
<td>ABC</td>
<td>Acme Supply Co</td>
<td>IL</td>
<td>2008-02-04</td>
<td>NY</td>
</tr>
</tbody>
</table>
<p>Previous_State 现在显示 IL（不是 CA）。此变化跟踪最后一次转换，失去了更早的历史。</p>
<h3 id="类型-3-限制">类型 3 限制</h3>
<p>固定结构产生问题：</p>
<div class="admonition error"><p class="admonition-title"><span class="mdi mdi-alert-circle-outline admonition-icon"></span>🚫 类型 3 问题</p><div class="admonition-content"><p><strong>历史丢失</strong></p>
<ul>
<li>第三次变化覆写第二次</li>
<li>无法重建完整历史</li>
<li>审计轨迹不完整</li>
</ul>
<p><strong>架构变化</strong></p>
<ul>
<li>添加更多历史需要 ALTER TABLE</li>
<li>需要应用程序变化</li>
<li>对生产环境造成干扰</li>
</ul>
<p><strong>时间查询不可能</strong></p>
<ul>
<li>无法询问"日期 X 的值是什么？"</li>
<li>仅两个时间点可用</li>
<li>有限的分析价值</li>
</ul>
<p><strong>事实表模糊性</strong></p>
<ul>
<li>哪个状态适用于给定事务？</li>
<li>必须将事务日期与 Effective_Date 比较</li>
<li>比类型 2 更复杂</li>
</ul>
</div></div>
<h3 id="混合列方法">混合列方法</h3>
<p>类型 3 通常与其他类型结合：</p>
<div class="admonition tip"><p class="admonition-title"><span class="mdi mdi-lightbulb-on-outline admonition-icon"></span>💡 类型 3 混合策略</p><div class="admonition-content"><p><strong>场景</strong></p>
<ul>
<li>使用类型 2 获得完整历史</li>
<li>为常见查询添加类型 3 列</li>
<li>示例：类型 2 维度中的 Current_State 列</li>
</ul>
<p><strong>优势</strong></p>
<ul>
<li>类型 2 提供完整历史</li>
<li>类型 3 列简化频繁查询</li>
<li>两种方法的优点</li>
</ul>
<p><strong>权衡</strong></p>
<ul>
<li>冗余数据</li>
<li>ETL 必须维护两者</li>
<li>存储开销</li>
</ul>
</div></div>
<p>类型 3 很少单独使用。其有限的历史使其不适合作为唯一的跟踪机制。与类型 2 结合，它在维护完整历史的同时提供查询便利性。</p>
<h2 id="类型-4：添加历史表">类型 4：添加历史表</h2>
<p>类型 4 将当前和历史数据分离到不同的表中。</p>
<h3 id="类型-4-如何运作">类型 4 如何运作</h3>
<p>类型 4 使用两个表：一个用于当前状态，一个用于历史：</p>
<p><strong>Supplier 表（当前）：</strong></p>
<table>
<thead>
<tr>
<th>Supplier_Key</th>
<th>Supplier_Code</th>
<th>Supplier_Name</th>
<th>Supplier_State</th>
</tr>
</thead>
<tbody>
<tr>
<td>124</td>
<td>ABC</td>
<td>Acme &amp; Johnson Supply Co</td>
<td>IL</td>
</tr>
</tbody>
</table>
<p><strong>Supplier_History 表：</strong></p>
<table>
<thead>
<tr>
<th>Supplier_Key</th>
<th>Supplier_Code</th>
<th>Supplier_Name</th>
<th>Supplier_State</th>
<th>Create_Date</th>
</tr>
</thead>
<tbody>
<tr>
<td>123</td>
<td>ABC</td>
<td>Acme Supply Co</td>
<td>CA</td>
<td>2003-06-14</td>
</tr>
<tr>
<td>124</td>
<td>ABC</td>
<td>Acme &amp; Johnson Supply Co</td>
<td>IL</td>
<td>2004-12-22</td>
</tr>
</tbody>
</table>
<p>当前表仅包含活动记录。历史表包含所有版本，包括当前版本。</p>
<h3 id="数据库审计模式">数据库审计模式</h3>
<p>类型 4 类似于数据库审计表：</p>
<div class="admonition anote"><p class="admonition-title"><span class="mdi mdi-note-outline admonition-icon"></span>🔍 类型 4 特性</p><div class="admonition-content"><p><strong>结构</strong></p>
<ul>
<li>当前表：每个实体一行</li>
<li>历史表：所有版本</li>
<li>两个表共享键结构</li>
<li>历史包含时间戳</li>
</ul>
<p><strong>与审计表的相似性</strong></p>
<ul>
<li>跟踪所有变化</li>
<li>不可变历史</li>
<li>基于时间戳</li>
<li>独立存储</li>
</ul>
<p><strong>与审计表的差异</strong></p>
<ul>
<li>历史表是可查询的维度</li>
<li>事实表可以引用两者</li>
<li>维度模型的一部分</li>
<li>不仅用于审计</li>
</ul>
</div></div>
<h3 id="事实表集成-2">事实表集成</h3>
<p>类型 4 的独特功能：事实可以引用两个表：</p>
<pre class="language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> Fact_Sales <span class="token punctuation">(</span>
    Sale_ID <span class="token keyword">INT</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span><span class="token punctuation">,</span>
    Sale_Date <span class="token keyword">DATE</span><span class="token punctuation">,</span>
    Current_Supplier_Key <span class="token keyword">INT</span><span class="token punctuation">,</span>  <span class="token comment">-- 引用 Supplier</span>
    Historical_Supplier_Key <span class="token keyword">INT</span><span class="token punctuation">,</span> <span class="token comment">-- 引用 Supplier_History</span>
    Amount <span class="token keyword">DECIMAL</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<div class="admonition success"><p class="admonition-title"><span class="mdi mdi-check-circle-outline admonition-icon"></span>✅ 双重引用优势</p><div class="admonition-content"><p><strong>当前状态查询</strong></p>
<ul>
<li>连接到 Supplier 表</li>
<li>始终显示当前信息</li>
<li>快速查询（较小的表）</li>
<li>不需要日期筛选</li>
</ul>
<p><strong>历史状态查询</strong></p>
<ul>
<li>连接到 Supplier_History 表</li>
<li>显示事务时的状态</li>
<li>完整审计轨迹</li>
<li>时间准确性</li>
</ul>
<p><strong>灵活性</strong></p>
<ul>
<li>每次查询选择适当的表</li>
<li>不需要重写查询</li>
<li>两种视图都可用</li>
</ul>
</div></div>
<h3 id="查询模式-2">查询模式</h3>
<p>类型 4 启用不同的分析视角：</p>
<p><strong>当前状态分析：</strong></p>
<pre class="language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">SELECT</span> 
    s<span class="token punctuation">.</span>Supplier_State<span class="token punctuation">,</span>
    <span class="token function">SUM</span><span class="token punctuation">(</span>f<span class="token punctuation">.</span>Amount<span class="token punctuation">)</span> <span class="token keyword">as</span> Total_Sales
<span class="token keyword">FROM</span> Fact_Sales f
<span class="token keyword">JOIN</span> Supplier s <span class="token keyword">ON</span> f<span class="token punctuation">.</span>Current_Supplier_Key <span class="token operator">=</span> s<span class="token punctuation">.</span>Supplier_Key
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> s<span class="token punctuation">.</span>Supplier_State<span class="token punctuation">;</span></code></pre>
<p>此查询显示按当前供应商州分组的所有销售，无论销售何时发生。</p>
<p><strong>历史状态分析：</strong></p>
<pre class="language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">SELECT</span> 
    sh<span class="token punctuation">.</span>Supplier_State<span class="token punctuation">,</span>
    <span class="token function">SUM</span><span class="token punctuation">(</span>f<span class="token punctuation">.</span>Amount<span class="token punctuation">)</span> <span class="token keyword">as</span> Total_Sales
<span class="token keyword">FROM</span> Fact_Sales f
<span class="token keyword">JOIN</span> Supplier_History sh <span class="token keyword">ON</span> f<span class="token punctuation">.</span>Historical_Supplier_Key <span class="token operator">=</span> sh<span class="token punctuation">.</span>Supplier_Key
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> sh<span class="token punctuation">.</span>Supplier_State<span class="token punctuation">;</span></code></pre>
<p>此查询显示按销售时供应商州分组的销售。</p>
<h3 id="ETL-考量">ETL 考量</h3>
<p>类型 4 需要仔细的 ETL 设计：</p>
<div class="admonition warning"><p class="admonition-title"><span class="mdi mdi-alert-outline admonition-icon"></span>⚠️ 类型 4 ETL 复杂性</p><div class="admonition-content"><p><strong>变化检测</strong></p>
<ul>
<li>将来源与当前表比较</li>
<li>检测变化</li>
<li>更新当前表</li>
<li>插入历史表</li>
</ul>
<p><strong>键管理</strong></p>
<ul>
<li>为变化生成新代理键</li>
<li>用新键更新当前表</li>
<li>在历史表中插入新行</li>
<li>用两个键更新事实表</li>
</ul>
<p><strong>事实表加载</strong></p>
<ul>
<li>必须填充两个键列</li>
<li>当前键：最新维度键</li>
<li>历史键：事务时的维度键</li>
<li>需要时间查找</li>
</ul>
</div></div>
<h3 id="何时类型-4-有意义">何时类型 4 有意义</h3>
<p>类型 4 适合特定场景：</p>
<div class="admonition success"><p class="admonition-title"><span class="mdi mdi-check-circle-outline admonition-icon"></span>✅ 良好的类型 4 使用案例</p><div class="admonition-content"><p><strong>双重视角报告</strong></p>
<ul>
<li>需要当前和历史视图</li>
<li>频繁在视角之间切换</li>
<li>示例：按当前区域与历史区域的销售</li>
</ul>
<p><strong>性能优化</strong></p>
<ul>
<li>当前表保持小型</li>
<li>快速当前状态查询</li>
<li>历史表可以分区</li>
<li>独立索引策略</li>
</ul>
<p><strong>变化数据捕获</strong></p>
<ul>
<li>与 CDC 系统集成</li>
<li>自然适合 CDC 输出</li>
<li>审计轨迹要求</li>
<li>合规需求</li>
</ul>
</div></div>
<h3 id="类型-4-挑战">类型 4 挑战</h3>
<p>双表方法产生复杂性：</p>
<div class="admonition error"><p class="admonition-title"><span class="mdi mdi-alert-circle-outline admonition-icon"></span>🚫 类型 4 问题</p><div class="admonition-content"><p><strong>事实表开销</strong></p>
<ul>
<li>每个维度两个键列</li>
<li>增加存储</li>
<li>更复杂的 ETL</li>
<li>潜在的不一致</li>
</ul>
<p><strong>同步风险</strong></p>
<ul>
<li>当前和历史表必须保持一致</li>
<li>历史表应包含当前记录</li>
<li>ETL 失败可能导致分歧</li>
<li>验证开销</li>
</ul>
<p><strong>查询混淆</strong></p>
<ul>
<li>用户必须了解使用哪个表</li>
<li>错误的表选择给出错误结果</li>
<li>文档至关重要</li>
<li>需要培训</li>
</ul>
<p><strong>有限的工具支持</strong></p>
<ul>
<li>BI 工具期望单一维度表</li>
<li>可能无法很好地处理双重引用</li>
<li>需要自定义查询逻辑</li>
<li>报告复杂性</li>
</ul>
</div></div>
<h3 id="维护策略">维护策略</h3>
<p>类型 4 需要持续维护：</p>
<div class="admonition tip"><p class="admonition-title"><span class="mdi mdi-lightbulb-on-outline admonition-icon"></span>💡 类型 4 最佳实践</p><div class="admonition-content"><p><strong>一致性检查</strong></p>
<ul>
<li>验证历史包含当前记录</li>
<li>验证键关系</li>
<li>定期对账</li>
<li>自动验证</li>
</ul>
<p><strong>清晰命名</strong></p>
<ul>
<li>明显的表名（当前 vs 历史）</li>
<li>描述性键列名称</li>
<li>数据字典中的文档</li>
</ul>
<p><strong>ETL 原子性</strong></p>
<ul>
<li>在单一事务中更新两个表</li>
<li>失败时回滚</li>
<li>防止部分更新</li>
</ul>
<p><strong>性能调整</strong></p>
<ul>
<li>按日期分区历史表</li>
<li>每个表不同的索引</li>
<li>如需要归档旧历史</li>
</ul>
</div></div>
<p>类型 4 以复杂性为代价提供灵活性。当真正需要双重视角且团队可以管理额外的 ETL 和维护负担时，它效果最佳。</p>
<h2 id="类型-6：组合方法">类型 6：组合方法</h2>
<p>类型 6 结合类型 1、2 和 3（1 + 2 + 3 = 6）以获得最大灵活性。</p>
<h3 id="类型-6-如何运作">类型 6 如何运作</h3>
<p>类型 6 使用类型 2 的行版本控制，加上类型 3 的当前值列和类型 1 的覆写策略：</p>
<p><strong>初始状态：</strong></p>
<table>
<thead>
<tr>
<th>Supplier_Key</th>
<th>Row_Key</th>
<th>Supplier_Code</th>
<th>Supplier_Name</th>
<th>Current_State</th>
<th>Historical_State</th>
<th>Start_Date</th>
<th>End_Date</th>
<th>Current_Flag</th>
</tr>
</thead>
<tbody>
<tr>
<td>123</td>
<td>1</td>
<td>ABC</td>
<td>Acme Supply Co</td>
<td>CA</td>
<td>CA</td>
<td>2000-01-01</td>
<td>9999-12-31</td>
<td>Y</td>
</tr>
</tbody>
</table>
<p><strong>第一次搬迁后：</strong></p>
<table>
<thead>
<tr>
<th>Supplier_Key</th>
<th>Row_Key</th>
<th>Supplier_Code</th>
<th>Supplier_Name</th>
<th>Current_State</th>
<th>Historical_State</th>
<th>Start_Date</th>
<th>End_Date</th>
<th>Current_Flag</th>
</tr>
</thead>
<tbody>
<tr>
<td>123</td>
<td>1</td>
<td>ABC</td>
<td>Acme Supply Co</td>
<td>IL</td>
<td>CA</td>
<td>2000-01-01</td>
<td>2004-12-22</td>
<td>N</td>
</tr>
<tr>
<td>123</td>
<td>2</td>
<td>ABC</td>
<td>Acme Supply Co</td>
<td>IL</td>
<td>IL</td>
<td>2004-12-22</td>
<td>9999-12-31</td>
<td>Y</td>
</tr>
</tbody>
</table>
<p>注意：</p>
<ul>
<li>类型 2：创建新行（Row_Key 2）</li>
<li>类型 3：添加 Current_State 列</li>
<li>类型 1：Row_Key 1 中的 Current_State 覆写为 IL</li>
</ul>
<p><strong>第二次搬迁后：</strong></p>
<table>
<thead>
<tr>
<th>Supplier_Key</th>
<th>Row_Key</th>
<th>Supplier_Code</th>
<th>Supplier_Name</th>
<th>Current_State</th>
<th>Historical_State</th>
<th>Start_Date</th>
<th>End_Date</th>
<th>Current_Flag</th>
</tr>
</thead>
<tbody>
<tr>
<td>123</td>
<td>1</td>
<td>ABC</td>
<td>Acme Supply Co</td>
<td>NY</td>
<td>CA</td>
<td>2000-01-01</td>
<td>2004-12-22</td>
<td>N</td>
</tr>
<tr>
<td>123</td>
<td>2</td>
<td>ABC</td>
<td>Acme Supply Co</td>
<td>NY</td>
<td>IL</td>
<td>2004-12-22</td>
<td>2008-02-04</td>
<td>N</td>
</tr>
<tr>
<td>123</td>
<td>3</td>
<td>ABC</td>
<td>Acme Supply Co</td>
<td>NY</td>
<td>NY</td>
<td>2008-02-04</td>
<td>9999-12-31</td>
<td>Y</td>
</tr>
</tbody>
</table>
<p>所有行现在显示 Current_State = NY（类型 1 覆写），而 Historical_State 保留每个时间段内当前的值（类型 2 历史）。</p>
<h3 id="三种技术的结合">三种技术的结合</h3>
<p>类型 6 将每种技术应用于不同方面：</p>
<div class="admonition anote"><p class="admonition-title"><span class="mdi mdi-note-outline admonition-icon"></span>🔧 类型 6 机制</p><div class="admonition-content"><p><strong>类型 1 组件</strong></p>
<ul>
<li>Current_State 列</li>
<li>每次变化时覆写</li>
<li>所有行更新以显示最新值</li>
<li>启用"当前状态"查询</li>
</ul>
<p><strong>类型 2 组件</strong></p>
<ul>
<li>每次变化添加行</li>
<li>Start_Date 和 End_Date</li>
<li>Current_Flag</li>
<li>保留完整历史</li>
</ul>
<p><strong>类型 3 组件</strong></p>
<ul>
<li>Historical_State 列</li>
<li>存储时间段内当前的值</li>
<li>创建后永不更新</li>
<li>启用"历史状态"查询</li>
</ul>
</div></div>
<h3 id="查询灵活性">查询灵活性</h3>
<p>类型 6 支持三种查询模式：</p>
<p><strong>当前状态查询：</strong></p>
<pre class="language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">SELECT</span> 
    s<span class="token punctuation">.</span>Current_State<span class="token punctuation">,</span>
    <span class="token function">SUM</span><span class="token punctuation">(</span>f<span class="token punctuation">.</span>Sales_Amount<span class="token punctuation">)</span> <span class="token keyword">as</span> Total_Sales
<span class="token keyword">FROM</span> Fact_Sales f
<span class="token keyword">JOIN</span> Supplier s <span class="token keyword">ON</span> f<span class="token punctuation">.</span>Supplier_Key <span class="token operator">=</span> s<span class="token punctuation">.</span>Row_Key
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> s<span class="token punctuation">.</span>Current_State<span class="token punctuation">;</span></code></pre>
<p>显示按当前供应商州分组的所有销售。简单连接，无日期筛选。</p>
<p><strong>历史状态查询：</strong></p>
<pre class="language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">SELECT</span> 
    s<span class="token punctuation">.</span>Historical_State<span class="token punctuation">,</span>
    <span class="token function">SUM</span><span class="token punctuation">(</span>f<span class="token punctuation">.</span>Sales_Amount<span class="token punctuation">)</span> <span class="token keyword">as</span> Total_Sales
<span class="token keyword">FROM</span> Fact_Sales f
<span class="token keyword">JOIN</span> Supplier s <span class="token keyword">ON</span> f<span class="token punctuation">.</span>Supplier_Key <span class="token operator">=</span> s<span class="token punctuation">.</span>Row_Key
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> s<span class="token punctuation">.</span>Historical_State<span class="token punctuation">;</span></code></pre>
<p>显示按销售发生时当前的州分组的销售。同样简单，不需要日期筛选。</p>
<p><strong>时间点查询：</strong></p>
<pre class="language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">SELECT</span> 
    s<span class="token punctuation">.</span>Supplier_Name<span class="token punctuation">,</span>
    s<span class="token punctuation">.</span>Historical_State
<span class="token keyword">FROM</span> Supplier s
<span class="token keyword">WHERE</span> s<span class="token punctuation">.</span>Supplier_Code <span class="token operator">=</span> <span class="token string">'ABC'</span>
  <span class="token operator">AND</span> <span class="token string">'2005-06-15'</span> <span class="token operator">BETWEEN</span> s<span class="token punctuation">.</span>Start_Date <span class="token operator">AND</span> s<span class="token punctuation">.</span>End_Date<span class="token punctuation">;</span></code></pre>
<p>检索特定日期时存在的维度状态。</p>
<h3 id="Kimball-的-具有单一版本覆盖的不可预测变化">Kimball 的"具有单一版本覆盖的不可预测变化"</h3>
<p>Ralph Kimball 将类型 6 称为"具有单一版本覆盖的不可预测变化"：</p>
<div class="admonition anote"><p class="admonition-title"><span class="mdi mdi-note-outline admonition-icon"></span>📚 Kimball 的术语</p><div class="admonition-content"><p><strong>不可预测变化</strong></p>
<ul>
<li>变化不规则发生</li>
<li>无法预测何时或多久发生一次</li>
<li>缓慢变化维度的典型特征</li>
</ul>
<p><strong>单一版本覆盖</strong></p>
<ul>
<li>当前值"覆盖"在所有历史行上</li>
<li>创建当前状态的单一版本</li>
<li>无需日期逻辑即可访问</li>
<li>简化常见查询</li>
</ul>
</div></div>
<p>"覆盖"指的是在所有行中更新的 Current_State 列，无论您检查哪个历史行，都提供当前状态的单一、一致视图。</p>
<h3 id="实现复杂性">实现复杂性</h3>
<p>类型 6 是最复杂的 SCD 类型：</p>
<div class="admonition warning"><p class="admonition-title"><span class="mdi mdi-alert-outline admonition-icon"></span>⚠️ 类型 6 复杂性</p><div class="admonition-content"><p><strong>ETL 挑战</strong></p>
<ul>
<li>检测变化（类型 2）</li>
<li>创建新行（类型 2）</li>
<li>更新旧行的 End_Date（类型 2）</li>
<li>更新 Current_Flag（类型 2）</li>
<li>更新实体的所有行的 Current_State（类型 1）</li>
<li>最复杂的更新逻辑</li>
</ul>
<p><strong>存储开销</strong></p>
<ul>
<li>冗余的 Current_State 列</li>
<li>存储在每个历史行中</li>
<li>增加维度大小</li>
<li>比单独类型 2 更多存储</li>
</ul>
<p><strong>更新性能</strong></p>
<ul>
<li>每次变化更新多行</li>
<li>必须更新所有历史行</li>
<li>对于有许多版本的实体可能很慢</li>
<li>索引维护开销</li>
</ul>
</div></div>
<h3 id="何时类型-6-有意义">何时类型 6 有意义</h3>
<p>类型 6 在特定场景中证明其复杂性是合理的：</p>
<div class="admonition success"><p class="admonition-title"><span class="mdi mdi-check-circle-outline admonition-icon"></span>✅ 良好的类型 6 使用案例</p><div class="admonition-content"><p><strong>频繁的当前状态查询</strong></p>
<ul>
<li>大多数查询需要当前状态</li>
<li>偶尔需要历史状态</li>
<li>查询简单性值得存储成本</li>
</ul>
<p><strong>业务用户查询</strong></p>
<ul>
<li>非技术用户撰写查询</li>
<li>日期逻辑太复杂</li>
<li>偏好简单的列引用</li>
<li>自助 BI 工具</li>
</ul>
<p><strong>法规要求</strong></p>
<ul>
<li>必须维护完整历史（类型 2）</li>
<li>必须报告当前状态（类型 1）</li>
<li>两项要求都是强制性的</li>
<li>合规证明复杂性合理</li>
</ul>
</div></div>
<h3 id="类型-6-最佳实践">类型 6 最佳实践</h3>
<p>管理类型 6 需要纪律：</p>
<div class="admonition tip"><p class="admonition-title"><span class="mdi mdi-lightbulb-on-outline admonition-icon"></span>💡 类型 6 最佳实践</p><div class="admonition-content"><p><strong>清晰的列命名</strong></p>
<ul>
<li>Current_State vs Historical_State</li>
<li>明显区分</li>
<li>防止查询错误</li>
<li>自我记录</li>
</ul>
<p><strong>高效更新</strong></p>
<ul>
<li>批次 Current_State 更新</li>
<li>使用基于集合的操作</li>
<li>避免逐行更新</li>
<li>优化性能</li>
</ul>
<p><strong>文档</strong></p>
<ul>
<li>解释三种技术</li>
<li>提供查询示例</li>
<li>记录 ETL 逻辑</li>
<li>培训用户</li>
</ul>
<p><strong>考虑类型 2 + 视图</strong></p>
<ul>
<li>替代方案：类型 2 维度</li>
<li>添加具有当前状态的视图</li>
<li>视图连接到当前行</li>
<li>更简单的 ETL，类似的查询体验</li>
</ul>
</div></div>
<p>视图替代方案提供类似的查询简单性，而无需更新复杂性：</p>
<pre class="language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">CREATE</span> <span class="token keyword">VIEW</span> Supplier_With_Current <span class="token keyword">AS</span>
<span class="token keyword">SELECT</span> 
    h<span class="token punctuation">.</span><span class="token operator">*</span><span class="token punctuation">,</span>
    c<span class="token punctuation">.</span>Supplier_State <span class="token keyword">as</span> Current_State
<span class="token keyword">FROM</span> Supplier h
<span class="token keyword">JOIN</span> Supplier c <span class="token keyword">ON</span> h<span class="token punctuation">.</span>Supplier_Code <span class="token operator">=</span> c<span class="token punctuation">.</span>Supplier_Code
<span class="token keyword">WHERE</span> c<span class="token punctuation">.</span>Current_Flag <span class="token operator">=</span> <span class="token string">'Y'</span><span class="token punctuation">;</span></code></pre>
<p>此视图使每个历史行都能访问当前状态，而无需冗余存储。</p>
<h2 id="类型-7：双键策略">类型 7：双键策略</h2>
<p>类型 7 在事实表中放置代理键和自然键，以获得最大查询灵活性。</p>
<h3 id="类型-7-如何运作">类型 7 如何运作</h3>
<p>类型 7 使用类型 2 维度结构，但在事实中存储两个键：</p>
<p><strong>Supplier 维度（类型 2）：</strong></p>
<table>
<thead>
<tr>
<th>Supplier_Key</th>
<th>Supplier_Code</th>
<th>Supplier_Name</th>
<th>Supplier_State</th>
<th>Start_Date</th>
<th>End_Date</th>
<th>Current_Flag</th>
</tr>
</thead>
<tbody>
<tr>
<td>123</td>
<td>ABC</td>
<td>Acme Supply Co</td>
<td>CA</td>
<td>2000-01-01</td>
<td>2004-12-22</td>
<td>N</td>
</tr>
<tr>
<td>124</td>
<td>ABC</td>
<td>Acme Supply Co</td>
<td>IL</td>
<td>2004-12-22</td>
<td>2008-02-04</td>
<td>N</td>
</tr>
<tr>
<td>125</td>
<td>ABC</td>
<td>Acme Supply Co</td>
<td>NY</td>
<td>2008-02-04</td>
<td>9999-12-31</td>
<td>Y</td>
</tr>
</tbody>
</table>
<p><strong>具有双键的事实表：</strong></p>
<pre class="language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> Fact_Sales <span class="token punctuation">(</span>
    Sale_ID <span class="token keyword">INT</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span><span class="token punctuation">,</span>
    Sale_Date <span class="token keyword">DATE</span><span class="token punctuation">,</span>
    Supplier_Key <span class="token keyword">INT</span><span class="token punctuation">,</span>        <span class="token comment">-- 代理键（历史）</span>
    Supplier_Code <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">-- 自然键</span>
    Amount <span class="token keyword">DECIMAL</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>事实存储事务时当前的代理键（Supplier_Key）和识别所有版本实体的自然键（Supplier_Code）。</p>
<h3 id="查询灵活性-2">查询灵活性</h3>
<p>类型 7 启用三种查询模式，无需日期逻辑：</p>
<p><strong>历史状态查询：</strong></p>
<pre class="language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">SELECT</span> 
    s<span class="token punctuation">.</span>Supplier_State<span class="token punctuation">,</span>
    <span class="token function">SUM</span><span class="token punctuation">(</span>f<span class="token punctuation">.</span>Amount<span class="token punctuation">)</span> <span class="token keyword">as</span> Total_Sales
<span class="token keyword">FROM</span> Fact_Sales f
<span class="token keyword">JOIN</span> Supplier s <span class="token keyword">ON</span> f<span class="token punctuation">.</span>Supplier_Key <span class="token operator">=</span> s<span class="token punctuation">.</span>Supplier_Key
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> s<span class="token punctuation">.</span>Supplier_State<span class="token punctuation">;</span></code></pre>
<p>在代理键上连接显示历史状态。2003 年的销售连接到 Supplier_Key 123（CA），显示加州销售。</p>
<p><strong>当前状态查询：</strong></p>
<pre class="language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">SELECT</span> 
    s<span class="token punctuation">.</span>Supplier_State<span class="token punctuation">,</span>
    <span class="token function">SUM</span><span class="token punctuation">(</span>f<span class="token punctuation">.</span>Amount<span class="token punctuation">)</span> <span class="token keyword">as</span> Total_Sales
<span class="token keyword">FROM</span> Fact_Sales f
<span class="token keyword">JOIN</span> Supplier s <span class="token keyword">ON</span> f<span class="token punctuation">.</span>Supplier_Code <span class="token operator">=</span> s<span class="token punctuation">.</span>Supplier_Code
<span class="token keyword">WHERE</span> s<span class="token punctuation">.</span>Current_Flag <span class="token operator">=</span> <span class="token string">'Y'</span>
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> s<span class="token punctuation">.</span>Supplier_State<span class="token punctuation">;</span></code></pre>
<p>在自然键上连接并使用当前标志显示当前状态。ABC 的所有销售连接到 Supplier_Key 125（NY），显示纽约销售。</p>
<p><strong>时间点查询：</strong></p>
<pre class="language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">SELECT</span> 
    s<span class="token punctuation">.</span>Supplier_State<span class="token punctuation">,</span>
    <span class="token function">SUM</span><span class="token punctuation">(</span>f<span class="token punctuation">.</span>Amount<span class="token punctuation">)</span> <span class="token keyword">as</span> Total_Sales
<span class="token keyword">FROM</span> Fact_Sales f
<span class="token keyword">JOIN</span> Supplier s <span class="token keyword">ON</span> f<span class="token punctuation">.</span>Supplier_Code <span class="token operator">=</span> s<span class="token punctuation">.</span>Supplier_Code
<span class="token keyword">WHERE</span> f<span class="token punctuation">.</span>Sale_Date <span class="token operator">BETWEEN</span> s<span class="token punctuation">.</span>Start_Date <span class="token operator">AND</span> s<span class="token punctuation">.</span>End_Date
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> s<span class="token punctuation">.</span>Supplier_State<span class="token punctuation">;</span></code></pre>
<p>在自然键上连接并使用日期范围显示任何时间点的状态。</p>
<h3 id="相对于类型-2-的优势">相对于类型 2 的优势</h3>
<p>类型 7 为类型 2 增加了灵活性：</p>
<div class="admonition success"><p class="admonition-title"><span class="mdi mdi-check-circle-outline admonition-icon"></span>✅ 类型 7 优势</p><div class="admonition-content"><p><strong>查询选项</strong></p>
<ul>
<li>历史：在代理键上连接</li>
<li>当前：在自然键 + 当前标志上连接</li>
<li>时间点：在自然键 + 日期范围上连接</li>
<li>不需要重写查询</li>
</ul>
<p><strong>引用完整性</strong></p>
<ul>
<li>代理键可以有外键约束</li>
<li>自然键提供逻辑关系</li>
<li>支持两种视角</li>
</ul>
<p><strong>追溯变化</strong></p>
<ul>
<li>添加属性不会破坏事实</li>
<li>新时间切片不需要事实更新</li>
<li>对维度变化更具弹性</li>
</ul>
<p><strong>多个日期视角</strong></p>
<ul>
<li>事实有 Order_Date、Ship_Date、Invoice_Date</li>
<li>可以在不同日期上连接</li>
<li>示例："订购时的供应商州"vs"发货时"</li>
</ul>
</div></div>
<h3 id="追溯变化优势">追溯变化优势</h3>
<p>类型 7 最大的优势出现在维度演变时：</p>
<div class="admonition success"><p class="admonition-title"><span class="mdi mdi-check-circle-outline admonition-icon"></span>✅ 处理维度变化</p><div class="admonition-content"><p><strong>场景</strong></p>
<ul>
<li>维度跟踪 Supplier_State</li>
<li>业务添加 Sales_Rep 属性</li>
<li>Sales_Rep 有不同的变化日期</li>
</ul>
<p><strong>类型 2 问题</strong></p>
<ul>
<li>必须创建新时间切片</li>
<li>现有事实指向旧键</li>
<li>必须更新事实表</li>
<li>昂贵的操作</li>
</ul>
<p><strong>类型 7 解决方案</strong></p>
<ul>
<li>将 Sales_Rep 添加到维度</li>
<li>创建新时间切片</li>
<li>事实仍有自然键</li>
<li>不需要事实表更新</li>
<li>连接逻辑处理新结构</li>
</ul>
</div></div>
<p>自然键提供稳定性。即使维度的时间切片改变，事实仍然可以使用自然键和日期逻辑正确连接。</p>
<h3 id="类型-7-挑战">类型 7 挑战</h3>
<p>双键方法有重大缺点：</p>
<div class="admonition error"><p class="admonition-title"><span class="mdi mdi-alert-circle-outline admonition-icon"></span>🚫 类型 7 问题</p><div class="admonition-content"><p><strong>无真正的引用完整性</strong></p>
<ul>
<li>自然键在维度中不唯一</li>
<li>无法在自然键上创建外键</li>
<li>代理键外键仅确保键存在</li>
<li>不确保正确版本</li>
<li>数据完整性依赖应用程序逻辑</li>
</ul>
<p><strong>查询复杂性</strong></p>
<ul>
<li>用户必须了解使用哪个键</li>
<li>错误选择给出错误结果</li>
<li>某些查询需要日期逻辑</li>
<li>比类型 2 更复杂</li>
</ul>
<p><strong>重复行风险</strong></p>
<ul>
<li>没有日期筛选的自然键连接返回多行</li>
<li>容易得到错误结果</li>
<li>必须记住 WHERE Current_Flag = 'Y'</li>
<li>或日期范围筛选</li>
</ul>
<p><strong>性能问题</strong></p>
<ul>
<li>日期比较比键连接慢</li>
<li>自然键连接可能较慢</li>
<li>更复杂的执行计划</li>
<li>索引策略至关重要</li>
</ul>
<p><strong>BI 工具限制</strong></p>
<ul>
<li>工具期望单一连接键</li>
<li>可能无法很好地处理双键逻辑</li>
<li>通常需要自定义 SQL</li>
<li>报告复杂性</li>
</ul>
</div></div>
<h3 id="引用完整性问题">引用完整性问题</h3>
<p>类型 7 最严重的问题是无法强制执行引用完整性：</p>
<div class="admonition error"><p class="admonition-title"><span class="mdi mdi-alert-circle-outline admonition-icon"></span>🚫 引用完整性缺口</p><div class="admonition-content"><p><strong>问题</strong></p>
<p>Supplier_Code 在维度中出现多次（每个版本一次）。数据库无法在非唯一列上创建外键约束。</p>
<p><strong>后果</strong></p>
<ul>
<li>可以插入不存在的 Supplier_Code</li>
<li>可以插入有效代码但错误的 Supplier_Key</li>
<li>可能出现孤立事实</li>
<li>数据质量取决于 ETL</li>
</ul>
<p><strong>示例</strong></p>
<p>事实有 Supplier_Code = 'ABC' 和 Supplier_Key = 999。Supplier_Key 999 不存在，但 Supplier_Code 'ABC' 存在。Supplier_Key 上的外键会捕获这一点，但不验证自然键关系。</p>
<p><strong>缓解措施</strong></p>
<ul>
<li>ETL 验证至关重要</li>
<li>定期数据质量检查</li>
<li>应用程序层级约束</li>
<li>无法依赖数据库</li>
</ul>
</div></div>
<h3 id="何时类型-7-有意义">何时类型 7 有意义</h3>
<p>类型 7 适合特定场景：</p>
<div class="admonition success"><p class="admonition-title"><span class="mdi mdi-check-circle-outline admonition-icon"></span>✅ 良好的类型 7 使用案例</p><div class="admonition-content"><p><strong>演变的维度</strong></p>
<ul>
<li>维度结构经常变化</li>
<li>定期添加新属性</li>
<li>追溯变化常见</li>
<li>事实表更新昂贵</li>
</ul>
<p><strong>多个日期视角</strong></p>
<ul>
<li>事实有多个日期</li>
<li>不同日期需要不同的维度状态</li>
<li>示例：订单日期 vs 发货日期</li>
<li>灵活性值得复杂性</li>
</ul>
<p><strong>高级用户</strong></p>
<ul>
<li>团队了解 SCD 概念</li>
<li>可以撰写正确的连接逻辑</li>
<li>数据质量流程成熟</li>
<li>BI 工具支持复杂连接</li>
</ul>
</div></div>
<h3 id="类型-7-最佳实践">类型 7 最佳实践</h3>
<p>类型 7 需要仔细实现：</p>
<div class="admonition tip"><p class="admonition-title"><span class="mdi mdi-lightbulb-on-outline admonition-icon"></span>💡 类型 7 最佳实践</p><div class="admonition-content"><p><strong>全面文档</strong></p>
<ul>
<li>解释双键目的</li>
<li>提供查询模板</li>
<li>记录连接模式</li>
<li>包含反模式（不该做什么）</li>
</ul>
<p><strong>ETL 验证</strong></p>
<ul>
<li>验证两个键匹配</li>
<li>检查自然键存在</li>
<li>验证代理键指向正确版本</li>
<li>自动数据质量检查</li>
</ul>
<p><strong>索引策略</strong></p>
<ul>
<li>在事实表中索引两个键</li>
<li>在维度中索引自然键</li>
<li>索引 Start_Date 和 End_Date</li>
<li>监控查询性能</li>
</ul>
<p><strong>查询模板</strong></p>
<ul>
<li>提供标准查询</li>
<li>当前状态模板</li>
<li>历史状态模板</li>
<li>时间点模板</li>
<li>防止常见错误</li>
</ul>
<p><strong>考虑替代方案</strong></p>
<ul>
<li>类型 2 可能就足够</li>
<li>类型 6 提供类似灵活性</li>
<li>更简单的方法通常更好</li>
<li>复杂性必须合理</li>
</ul>
</div></div>
<h3 id="类型-7-vs-类型-6">类型 7 vs 类型 6</h3>
<p>两者都提供灵活性，但通过不同机制：</p>
<div class="admonition anote"><p class="admonition-title"><span class="mdi mdi-note-outline admonition-icon"></span>🔍 类型 7 vs 类型 6 比较</p><div class="admonition-content"><p><strong>类型 6</strong></p>
<ul>
<li>在维度中存储当前状态</li>
<li>变化时更新所有行</li>
<li>简单查询（无日期逻辑）</li>
<li>较高存储开销</li>
<li>更复杂的 ETL</li>
</ul>
<p><strong>类型 7</strong></p>
<ul>
<li>在事实中存储自然键</li>
<li>不需要维度更新</li>
<li>复杂查询（需要日期逻辑）</li>
<li>较低存储开销</li>
<li>更简单的 ETL，复杂的查询</li>
</ul>
<p><strong>决策因素</strong></p>
<ul>
<li>需要查询简单性？→ 类型 6</li>
<li>维度经常变化？→ 类型 7</li>
<li>存储受限？→ 类型 7</li>
<li>非技术用户？→ 类型 6</li>
</ul>
</div></div>
<p>类型 7 以查询简单性换取 ETL 简单性和对维度变化的弹性。正确的选择取决于哪种复杂性对您的团队更易于管理。</p>
<h2 id="选择正确的类型">选择正确的类型</h2>
<p>不同的维度和属性需要不同的 SCD 类型。</p>
<h3 id="决策框架">决策框架</h3>
<p>选择适当的 SCD 类型需要评估多个因素：</p>
<div class="admonition anote"><p class="admonition-title"><span class="mdi mdi-note-outline admonition-icon"></span>🎯 SCD 类型选择标准</p><div class="admonition-content"><p><strong>历史准确性要求</strong></p>
<ul>
<li>法规合规需求？</li>
<li>需要审计轨迹？</li>
<li>历史报告至关重要？</li>
<li>→ 类型 2、类型 4 或类型 6</li>
</ul>
<p><strong>查询模式</strong></p>
<ul>
<li>主要是当前状态查询？</li>
<li>主要是历史查询？</li>
<li>两者同等重要？</li>
<li>→ 影响类型 6 vs 类型 2</li>
</ul>
<p><strong>变化频率</strong></p>
<ul>
<li>变化罕见？</li>
<li>变化频繁？</li>
<li>可预测或不可预测？</li>
<li>→ 影响存储和性能</li>
</ul>
<p><strong>维度稳定性</strong></p>
<ul>
<li>结构经常变化？</li>
<li>定期添加新属性？</li>
<li>需要追溯变化？</li>
<li>→ 不稳定维度使用类型 7</li>
</ul>
<p><strong>团队能力</strong></p>
<ul>
<li>ETL 专业水平？</li>
<li>查询复杂度容忍度？</li>
<li>BI 工具限制？</li>
<li>→ 经验较少的团队使用更简单的类型</li>
</ul>
</div></div>
<h3 id="类型选择矩阵">类型选择矩阵</h3>
<p>选择 SCD 类型的实用指南：</p>
<table>
<thead>
<tr>
<th>需求</th>
<th>推荐类型</th>
<th>替代方案</th>
<th>避免</th>
</tr>
</thead>
<tbody>
<tr>
<td>不需要历史</td>
<td>类型 1</td>
<td>类型 0</td>
<td>类型 2+</td>
</tr>
<tr>
<td>需要完整历史</td>
<td>类型 2</td>
<td>类型 4、类型 6</td>
<td>类型 1、类型 3</td>
</tr>
<tr>
<td>仅前后比较</td>
<td>类型 3</td>
<td>带视图的类型 2</td>
<td>类型 1</td>
</tr>
<tr>
<td>当前 + 历史视图</td>
<td>类型 6</td>
<td>类型 7、类型 4</td>
<td>类型 1、类型 3</td>
</tr>
<tr>
<td>频繁维度变化</td>
<td>类型 7</td>
<td>类型 2</td>
<td>类型 6</td>
</tr>
<tr>
<td>简单查询至关重要</td>
<td>类型 1、类型 6</td>
<td>类型 3</td>
<td>类型 7</td>
</tr>
<tr>
<td>存储受限</td>
<td>类型 1、类型 3</td>
<td>类型 2</td>
<td>类型 6</td>
</tr>
<tr>
<td>审计合规</td>
<td>类型 2、类型 4</td>
<td>类型 6</td>
<td>类型 1</td>
</tr>
</tbody>
</table>
<h3 id="混合方法">混合方法</h3>
<p>大多数数据仓库使用多种 SCD 类型：</p>
<div class="admonition success"><p class="admonition-title"><span class="mdi mdi-check-circle-outline admonition-icon"></span>✅ 混合 SCD 类型</p><div class="admonition-content"><p><strong>每个维度不同类型</strong></p>
<ul>
<li>客户：类型 2（地址变化重要）</li>
<li>产品：类型 1（描述更新不重要）</li>
<li>日期：类型 0（永不改变）</li>
<li>员工：类型 2（部门调动跟踪）</li>
</ul>
<p><strong>每个属性不同类型</strong></p>
<ul>
<li>Customer.Address：类型 2</li>
<li>Customer.Phone：类型 1</li>
<li>Customer.Email：类型 1</li>
<li>Customer.CreditLimit：类型 2</li>
</ul>
<p><strong>优势</strong></p>
<ul>
<li>独立优化每个维度</li>
<li>平衡复杂性和需求</li>
<li>避免过度工程</li>
<li>实用方法</li>
</ul>
</div></div>
<h3 id="按行业的常见模式">按行业的常见模式</h3>
<p>不同行业有典型的 SCD 模式：</p>
<div class="admonition anote"><p class="admonition-title"><span class="mdi mdi-note-outline admonition-icon"></span>🏢 行业模式</p><div class="admonition-content"><p><strong>金融服务</strong></p>
<ul>
<li>账户维度：类型 2</li>
<li>客户维度：类型 2</li>
<li>产品维度：类型 2</li>
<li>原因：法规合规、审计要求</li>
</ul>
<p><strong>零售</strong></p>
<ul>
<li>产品维度：类型 1 或类型 2</li>
<li>商店维度：类型 2</li>
<li>客户维度：类型 1 或类型 2</li>
<li>原因：平衡历史与简单性</li>
</ul>
<p><strong>医疗保健</strong></p>
<ul>
<li>患者维度：类型 2</li>
<li>提供者维度：类型 2</li>
<li>诊断维度：类型 0</li>
<li>原因：历史准确性至关重要</li>
</ul>
<p><strong>制造业</strong></p>
<ul>
<li>供应商维度：类型 2</li>
<li>产品维度：类型 2</li>
<li>工厂维度：类型 1</li>
<li>原因：供应链跟踪</li>
</ul>
</div></div>
<h3 id="性能考量">性能考量</h3>
<p>SCD 类型影响查询和 ETL 性能：</p>
<div class="admonition warning"><p class="admonition-title"><span class="mdi mdi-alert-outline admonition-icon"></span>⚠️ 性能影响</p><div class="admonition-content"><p><strong>类型 1</strong></p>
<ul>
<li>快速查询（无日期逻辑）</li>
<li>快速更新（简单 UPDATE）</li>
<li>必须重新计算聚合</li>
<li>最佳查询性能</li>
</ul>
<p><strong>类型 2</strong></p>
<ul>
<li>中等查询性能</li>
<li>日期范围检查增加开销</li>
<li>维度随时间增长</li>
<li>索引策略至关重要</li>
</ul>
<p><strong>类型 6</strong></p>
<ul>
<li>简单查询（无日期逻辑）</li>
<li>慢速更新（多行）</li>
<li>较大的维度大小</li>
<li>以更新速度换取查询速度</li>
</ul>
<p><strong>类型 7</strong></p>
<ul>
<li>复杂查询（日期逻辑）</li>
<li>快速更新（无维度变化）</li>
<li>自然键连接可能较慢</li>
<li>取决于索引质量</li>
</ul>
</div></div>
<h3 id="存储考量">存储考量</h3>
<p>不同类型有不同的存储特性：</p>
<div class="admonition anote"><p class="admonition-title"><span class="mdi mdi-note-outline admonition-icon"></span>💾 存储影响</p><div class="admonition-content"><p><strong>类型 1</strong></p>
<ul>
<li>最小存储</li>
<li>每个实体一行</li>
<li>不随时间增长</li>
<li>最有效</li>
</ul>
<p><strong>类型 2</strong></p>
<ul>
<li>随变化增长</li>
<li>每个版本一行</li>
<li>可预测的增长率</li>
<li>监控维度大小</li>
</ul>
<p><strong>类型 3</strong></p>
<ul>
<li>固定大小</li>
<li>额外列</li>
<li>无行倍增</li>
<li>中等存储</li>
</ul>
<p><strong>类型 6</strong></p>
<ul>
<li>最大存储</li>
<li>类型 2 行 + 冗余列</li>
<li>最高开销</li>
<li>以存储成本换取查询简单性</li>
</ul>
</div></div>
<h3 id="迁移策略">迁移策略</h3>
<p>变更 SCD 类型需要规划：</p>
<div class="admonition tip"><p class="admonition-title"><span class="mdi mdi-lightbulb-on-outline admonition-icon"></span>💡 SCD 类型迁移</p><div class="admonition-content"><p><strong>类型 1 到类型 2</strong></p>
<ul>
<li>添加 Start_Date、End_Date、Current_Flag</li>
<li>将 Start_Date 设置为最早已知日期</li>
<li>将 End_Date 设置为 NULL</li>
<li>未来变化使用类型 2</li>
<li>历史数据丢失（不可避免）</li>
</ul>
<p><strong>类型 2 到类型 6</strong></p>
<ul>
<li>添加 Current_State 列</li>
<li>从当前行填充</li>
<li>更新 ETL 以维护两者</li>
<li>向后兼容</li>
</ul>
<p><strong>类型 2 到类型 1</strong></p>
<ul>
<li>删除历史行</li>
<li>仅保留当前行</li>
<li>移除时间列</li>
<li>不可逆（先备份）</li>
</ul>
</div></div>
<h3 id="要避免的反模式">要避免的反模式</h3>
<p>常见的 SCD 错误：</p>
<div class="admonition error"><p class="admonition-title"><span class="mdi mdi-alert-circle-outline admonition-icon"></span>🚫 SCD 反模式</p><div class="admonition-content"><p><strong>对所有内容使用类型 2</strong></p>
<ul>
<li>并非所有属性都需要历史</li>
<li>不必要的复杂性</li>
<li>浪费存储</li>
<li>解决方案：适当混合类型</li>
</ul>
<p><strong>对所有内容使用类型 1</strong></p>
<ul>
<li>失去有价值的历史</li>
<li>无法回答时间问题</li>
<li>合规问题</li>
<li>解决方案：识别关键历史属性</li>
</ul>
<p><strong>不一致的实现</strong></p>
<ul>
<li>不同的日期格式</li>
<li>混合 NULL vs 高日期</li>
<li>不一致的标志值</li>
<li>解决方案：在仓库中标准化</li>
</ul>
<p><strong>忽略自然键</strong></p>
<ul>
<li>仅使用代理键</li>
<li>无法跨版本查询</li>
<li>难以追踪实体历史</li>
<li>解决方案：维护自然键</li>
</ul>
<p><strong>过度工程</strong></p>
<ul>
<li>类型 2 足够时使用类型 6 或类型 7</li>
<li>没有好处的复杂性</li>
<li>维护负担</li>
<li>解决方案：从简单开始，仅在需要时增加复杂性</li>
</ul>
</div></div>
<h3 id="实用建议">实用建议</h3>
<p>实际实现的指导方针：</p>
<div class="admonition tip"><p class="admonition-title"><span class="mdi mdi-lightbulb-on-outline admonition-icon"></span>💡 实用 SCD 建议</p><div class="admonition-content"><p><strong>从类型 2 开始</strong></p>
<ul>
<li>大多数维度的默认选择</li>
<li>广为理解</li>
<li>功能的良好平衡</li>
<li>可以演变为其他类型</li>
</ul>
<p><strong>谨慎使用类型 1</strong></p>
<ul>
<li>仅当历史真正不重要时</li>
<li>记录决策</li>
<li>获得业务签核</li>
<li>考虑审计表作为备份</li>
</ul>
<p><strong>最初避免类型 6 和类型 7</strong></p>
<ul>
<li>实现复杂</li>
<li>维护复杂</li>
<li>仅在类型 2 证明不足时添加</li>
<li>需要成熟的团队</li>
</ul>
<p><strong>记录所有内容</strong></p>
<ul>
<li>每个维度使用哪种类型</li>
<li>为什么选择该类型</li>
<li>查询模式和示例</li>
<li>ETL 逻辑和边缘案例</li>
</ul>
<p><strong>监控和调整</strong></p>
<ul>
<li>跟踪维度增长</li>
<li>监控查询性能</li>
<li>收集用户反馈</li>
<li>愿意变更类型</li>
</ul>
</div></div>
<h2 id="结论">结论</h2>
<p>缓慢变化维度代表数据仓库的基本挑战之一：在历史准确性与实际实现限制之间取得平衡。在 SCD 类型之间的选择不是寻找"最佳"方法——而是将技术与业务需求、团队能力和系统限制相匹配。</p>
<p>通过 SCD 类型的旅程揭示了重要的教训：</p>
<p><strong>简单性有代价</strong>：类型 1 的简单性以失去历史为代价。在设计期间看似微小的权衡，当业务需求演变时会成为重大限制。"我们 2005 年在加州的销售额是多少？"这个问题在供应商搬迁且类型 1 覆写其位置后变得无法回答。历史数据一旦失去，就无法恢复。</p>
<p><strong>历史需要结构</strong>：类型 2 的受欢迎程度源于其平衡的方法。完整的历史保留、合理的查询复杂性和广为理解的实现使其成为默认选择。为变化创建新行、维护时间列和使用代理键的模式已在无数数据仓库中证明了自己。</p>
<p><strong>灵活性需要复杂性</strong>：类型 6 和类型 7 提供最大灵活性，但需要复杂的 ETL 流程和仔细的查询设计。只有当更简单的方法证明不足时，复杂性才是合理的。从类型 2 开始并随着需求的出现演变到更复杂的类型可以防止过早优化。</p>
<p><strong>情境很重要</strong>：没有单一的 SCD 类型适合所有场景。客户地址可能需要类型 2 以获得历史准确性，而电话号码使用类型 1 以获得简单性。产品类别可能需要类型 2，而产品描述使用类型 1。在单一数据仓库内——甚至在单一维度内——混合类型的能力实现了实用的解决方案。</p>
<p><strong>权衡是不可避免的</strong>：每种 SCD 类型代表竞争关注点之间的权衡：</p>
<ul>
<li>历史准确性 vs. 查询简单性</li>
<li>存储效率 vs. 时间精确度</li>
<li>ETL 复杂性 vs. 查询灵活性</li>
<li>当前状态访问 vs. 历史状态访问</li>
</ul>
<p>理解这些权衡能够做出明智的决策，而不是盲目遵循模式。</p>
<p><strong>实现纪律</strong>：成功的 SCD 实现需要纪律。一致的日期处理、清晰的命名惯例、全面的文档和强大的 ETL 流程将有效的实现与有问题的实现区分开来。技术模式不如其应用的严谨性重要。</p>
<p>SCD 类型分类系统提供了讨论维度变化策略的词汇。类型 0 到类型 7 不是严格的规则，而是工具包。艺术在于为每种情况选择正确的工具，在适当时组合技术，并保持纪律以一致地实现所选方法。</p>
<p>现代数据仓库通常使用类型 2 作为基础，为历史不重要的属性添加类型 1，仅在特定需求证明额外复杂性合理时才使用类型 6 或类型 7。这种务实的方法平衡了历史准确性、查询性能、存储效率和可维护性的竞争需求。</p>
<p>成功的最终衡量标准不是您选择哪种 SCD 类型，而是您的维度模型是否能让业务准确回答其问题。当历史报表反映实际历史状态，当当前报表显示当前状态，并且两者之间的区别清晰且有意时，无论采用哪种特定类型，SCD 实现都是成功的。</p>
<p>随着数据仓库的演变和业务需求的变化，SCD 策略可能需要调整。在类型之间迁移的灵活性、记录决策的纪律，以及在可能时选择简单性而非复杂性的智慧，比任何特定的技术选择更能决定长期成功。</p>
<!-- commentbox plugin begins -->
    <div class="commentbox"></div>
    <script src="https://unpkg.com/commentbox.io/dist/commentBox.min.js"></script>
    <script>commentBox('5765834504929280-proj')</script>
    <!-- commentbox plugin ends -->
    
        </div>
        
        <footer class="article-footer">
            
    <a data-url="https://neo01.com/zh-CN/2006/12/Slowly-Changing-Dimensions-Managing-Historical-Data/" data-id="57de2b85" class="article-share-link"><i class="fa fa-share"></i>分享到</a>
<script>
    (function ($) {
        $('body').on('click', function() {
            $('.article-share-box.on').removeClass('on');
        }).on('click', '.article-share-link', function(e) {
            e.stopPropagation();

            var $this = $(this),
                url = $this.attr('data-url').replace("http://","https://"),
                encodedUrl = encodeURIComponent(url),
                id = 'article-share-box-' + $this.attr('data-id'),
                offset = $this.offset(),
                box;

            if ($('#' + id).length) {
                box = $('#' + id);

                if (box.hasClass('on')){
                    box.removeClass('on');
                    return;
                }
            } else {
                var html = [
                    '<div id="' + id + '" class="article-share-box">',
                        '<input class="article-share-input" value="' + url + '">',
                        '<div class="article-share-links">',
                            '<a href="https://twitter.com/intent/tweet?url=' + encodedUrl + '" class="article-share-twitter" target="_blank" title="Twitter"></a>',
                            '<a href="https://www.facebook.com/sharer.php?u=' + encodedUrl + '" class="article-share-facebook" target="_blank" title="Facebook"></a>',
                            '<a href="http://pinterest.com/pin/create/button/?url=' + encodedUrl + '" class="article-share-pinterest" target="_blank" title="Pinterest"></a>',
                        '</div>',
                    '</div>'
                ].join('');

              box = $(html);

              $('body').append(box);
            }

            $('.article-share-box.on').hide();

            box.css({
                top: offset.top + 25,
                left: offset.left
            }).addClass('on');

        }).on('click', '.article-share-box', function (e) {
            e.stopPropagation();
        }).on('click', '.article-share-box-input', function () {
            $(this).select();
        }).on('click', '.article-share-box-link', function (e) {
            e.preventDefault();
            e.stopPropagation();

            window.open(this.href, 'article-share-box-window-' + Date.now(), 'width=500,height=450');
        });
    })(jQuery);
</script>

        </footer>
    </div>
    <!--script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "BlogPosting",
        "author": {
            "@type": "Person",
            "name": "Neo Alienson"
        },
        "headline": "缓慢变化维度：管理数据仓库中的历史数据",
        "image": "https://neo01.com",
        "keywords": "Data Modeling Data Warehousing Database",
        "genre": "Architecture",
        "datePublished": "2006-12-11",
        "dateCreated": "2006-12-11",
        "dateModified": "2025-11-27",
        "url": "https://neo01.com//zh-CN/2006/12/Slowly-Changing-Dimensions-Managing-Historical-Data/",
        "description": "维度数据会以不可预测的方式随时间变化。从简单的覆写到复杂的混合方法，理解 SCD 类型有助于平衡历史准确性、数据完整性和系统性能。",
        "wordCount": 2616
    }
</script-->

</article>

                        </div>
                    </section>
                    
<aside id="sidebar">
    <a class="sidebar-toggle" title="Expand Sidebar"><i class="toggle icon"></i></a>
    <div class="sidebar-top">
        <p>关注我 :</p>
        <ul class="social-links">
                <li>
                    <a class="social-tooltip" title="stack-exchange" href="https://stackexchange.com/users/2122053/neo?tab=accounts" target="_blank" rel="noopener">
                        <i class="icon fa-brands fa-stack-exchange"></i>
                    </a>
                </li>
                <li>
                    <a class="social-tooltip" title="stack-overflow" href="https://stackoverflow.com/users/1885105/neo" target="_blank" rel="noopener">
                        <i class="icon fa-brands fa-stack-overflow"></i>
                    </a>
                </li>
                <li>
                    <a class="social-tooltip" title="github" href="https://github.com/neoalienson" target="_blank" rel="noopener">
                        <i class="icon fa-brands fa-github"></i>
                    </a>
                </li>
                <li>
                    <a class="social-tooltip" title="linkedin" href="https://linkedin.com/in/neo01" target="_blank" rel="noopener">
                        <i class="icon fa-brands fa-linkedin"></i>
                    </a>
                </li>
                <li>
                    <a class="social-tooltip" title="rss" href="/atom.xml" target="_blank" rel="noopener">
                        <i class="icon fa fa-rss"></i>
                    </a>
                </li>
        </ul>
    </div>
    <div class="widgets-container">

        
            
                
                <div class="widget-wrap widget-list">
    <h3 class="widget-title">链接</h3>
    <div class="widget">
        <ul><li><a href="/zh-CN/ai">AI 游乐场</a></li><li><a href="/zh-CN/tools">工具</a></li><li><a href="/zh-CN/games">游戏</a></li><li><a href="/zh-CN/pages/useful-information">实用信息</a></li><li><a href="/zh-CN/pages/Hexo-Blogging-Cheatsheet">Hexo 博客速查表</a></li></ul>
    </div>
</div>

                
            
                
                
                
            
                
                    <div class="widget-wrap">
        <h3 class="widget-title">最新文章</h3>
        <div class="widget">
            <ul id="recent-post" class="">
                    <li>
                        <div class="item-thumbnail">
                            <a href="/zh-CN/2025/11/Mock-Servers-Accelerating-Development-Through-Simulation/" class="thumbnail">
        <span style="background-image:url(/assets/futuristic/mesh.png)" alt="Mock 服务器：通过模拟加速开发" class="thumbnail-image"></span>
</a>
                        </div>
                        <div class="item-inner">
                            <p class="item-category"><a class="article-category-link" style="cursor: default; pointer-events: none;">开发</a></p>
                            <p class="item-title"><a href="/zh-CN/2025/11/Mock-Servers-Accelerating-Development-Through-Simulation/" class="title">Mock 服务器：通过模拟加速开发</a></p>
                            <p class="item-date"><time datetime="2025-10-31T16:00:00.000Z" itemprop="datePublished">2025-11-01</time></p>
                        </div>
                    </li>
                    <li>
                        <div class="item-thumbnail">
                            <a href="/zh-CN/2025/10/Enabling-i18n-in-Hexo/" class="thumbnail">
        <span style="background-image:url(/assets/hexo/thumbnail.png)" alt="在 Hexo 中启用 i18n：多语言博客完整指南" class="thumbnail-image"></span>
</a>
                        </div>
                        <div class="item-inner">
                            <p class="item-category"><a class="article-category-link" style="cursor: default; pointer-events: none;">开发</a></p>
                            <p class="item-title"><a href="/zh-CN/2025/10/Enabling-i18n-in-Hexo/" class="title">在 Hexo 中启用 i18n：多语言博客完整指南</a></p>
                            <p class="item-date"><time datetime="2025-10-29T16:00:00.000Z" itemprop="datePublished">2025-10-30</time></p>
                        </div>
                    </li>
                    <li>
                        <div class="item-thumbnail">
                            <a href="/zh-CN/2025/10/CISP-Advanced-Security-Topics/" class="thumbnail">
        <span style="background-image:url(/assets/cisp/thumbnail_80.png)" alt="CISP学习指南：高级安全主题" class="thumbnail-image"></span>
</a>
                        </div>
                        <div class="item-inner">
                            <p class="item-category"><a class="article-category-link" style="cursor: default; pointer-events: none;">网络安全</a></p>
                            <p class="item-title"><a href="/zh-CN/2025/10/CISP-Advanced-Security-Topics/" class="title">CISP学习指南：高级安全主题</a></p>
                            <p class="item-date"><time datetime="2025-10-22T16:00:00.000Z" itemprop="datePublished">2025-10-23</time></p>
                        </div>
                    </li>
                    <li>
                        <div class="item-thumbnail">
                            <a href="/zh-CN/2025/10/CISP-Email-Security/" class="thumbnail">
        <span style="background-image:url(/assets/cisp/thumbnail_80.png)" alt="CISP学习指南：电子邮件安全与网络协议" class="thumbnail-image"></span>
</a>
                        </div>
                        <div class="item-inner">
                            <p class="item-category"><a class="article-category-link" style="cursor: default; pointer-events: none;">网络安全</a></p>
                            <p class="item-title"><a href="/zh-CN/2025/10/CISP-Email-Security/" class="title">CISP学习指南：电子邮件安全与网络协议</a></p>
                            <p class="item-date"><time datetime="2025-10-22T16:00:00.000Z" itemprop="datePublished">2025-10-23</time></p>
                        </div>
                    </li>
                    <li>
                        <div class="item-thumbnail">
                            <a href="/zh-CN/2025/10/CISP-Access-Control-Audit-WAPI/" class="thumbnail">
        <span style="background-image:url(/assets/cisp/thumbnail_80.png)" alt="CISP学习指南：访问控制机制、蜜网、审计系统与WAPI" class="thumbnail-image"></span>
</a>
                        </div>
                        <div class="item-inner">
                            <p class="item-category"><a class="article-category-link" style="cursor: default; pointer-events: none;">网络安全</a></p>
                            <p class="item-title"><a href="/zh-CN/2025/10/CISP-Access-Control-Audit-WAPI/" class="title">CISP学习指南：访问控制机制、蜜网、审计系统与WAPI</a></p>
                            <p class="item-date"><time datetime="2025-10-21T16:00:00.000Z" itemprop="datePublished">2025-10-22</time></p>
                        </div>
                    </li>
            </ul>
        </div>
    </div>

                
            
                
                
    
    
    <div class="widget-wrap widget-list">
        <h3 class="widget-title">归档</h3>
        <div class="widget">
            <ul class="archive-list">
            
                <li class="archive-list-item">
                    <a class="archive-list-link" href="/zh-CN/archives/2025/">2025</a>
                    <span class="archive-list-count">75</span>
                </li>
            
                <li class="archive-list-item">
                    <a class="archive-list-link" href="/zh-CN/archives/2024/">2024</a>
                    <span class="archive-list-count">25</span>
                </li>
            
                <li class="archive-list-item">
                    <a class="archive-list-link" href="/zh-CN/archives/2023/">2023</a>
                    <span class="archive-list-count">16</span>
                </li>
            
                <li class="archive-list-item">
                    <a class="archive-list-link" href="/zh-CN/archives/2022/">2022</a>
                    <span class="archive-list-count">17</span>
                </li>
            
                <li class="archive-list-item">
                    <a class="archive-list-link" href="/zh-CN/archives/2021/">2021</a>
                    <span class="archive-list-count">14</span>
                </li>
            
                <li class="archive-list-item">
                    <a class="archive-list-link" href="/zh-CN/archives/2020/">2020</a>
                    <span class="archive-list-count">13</span>
                </li>
            
                <li class="archive-list-item">
                    <a class="archive-list-link" href="/zh-CN/archives/2019/">2019</a>
                    <span class="archive-list-count">12</span>
                </li>
            
                <li class="archive-list-item">
                    <a class="archive-list-link" href="/zh-CN/archives/2018/">2018</a>
                    <span class="archive-list-count">3</span>
                </li>
            
                <li class="archive-list-item">
                    <a class="archive-list-link" href="/zh-CN/archives/2017/">2017</a>
                    <span class="archive-list-count">6</span>
                </li>
            
                <li class="archive-list-item">
                    <a class="archive-list-link" href="/zh-CN/archives/2016/">2016</a>
                    <span class="archive-list-count">5</span>
                </li>
            
                <li class="archive-list-item">
                    <a class="archive-list-link" href="/zh-CN/archives/2015/">2015</a>
                    <span class="archive-list-count">6</span>
                </li>
            
                <li class="archive-list-item">
                    <a class="archive-list-link" href="/zh-CN/archives/2014/">2014</a>
                    <span class="archive-list-count">10</span>
                </li>
            
                <li class="archive-list-item">
                    <a class="archive-list-link" href="/zh-CN/archives/2013/">2013</a>
                    <span class="archive-list-count">3</span>
                </li>
            
                <li class="archive-list-item">
                    <a class="archive-list-link" href="/zh-CN/archives/2010/">2010</a>
                    <span class="archive-list-count">3</span>
                </li>
            
                <li class="archive-list-item">
                    <a class="archive-list-link" href="/zh-CN/archives/2007/">2007</a>
                    <span class="archive-list-count">1</span>
                </li>
            
                <li class="archive-list-item">
                    <a class="archive-list-link" href="/zh-CN/archives/2006/">2006</a>
                    <span class="archive-list-count">1</span>
                </li>
            
                <li class="archive-list-item">
                    <a class="archive-list-link" href="/zh-CN/archives/2003/">2003</a>
                    <span class="archive-list-count">1</span>
                </li>
            
                <li class="archive-list-item">
                    <a class="archive-list-link" href="/zh-CN/archives/2001/">2001</a>
                    <span class="archive-list-count">1</span>
                </li>
            
            </ul>
        </div>
    </div>


                
            
        

    </div>
</aside>


                </div>
            </div>
        </div>
        
<footer id="footer">
    <div class="container">
        <div class="container-inner">
            <a id="back-to-top" href="javascript:;"><i class="icon fa fa-angle-up"></i></a>

            <div class="qrcode-share-wrapper">
                <div class="qrcode-text">https://neo01.com/l#1eb85edf</div>
                <img src="/qr/qr-b78957b38d8a3e78506567c2981d298d.svg" width="200" height="200" alt="QR Code for https://neo01.com/l#1eb85edf">
            </div>
            <div class="credit">
                <h1 class="logo-wrap">
                    <a href="/" title="Homepage" class="logo"></a>
                </h1>
                
                <p>© 2025 Neo Alienson. 版权所有.
                  <a href="/zh-CN/terms-and-conditions">使用条款</a></p>
                
            </div>
            <div class="footer-plugins">
              


            </div>
        </div>
    </div>
</footer>

        
        
    
        


        


        


        


        


        


        


        


        


    



<!-- Custom Scripts -->




        
    </div>
<!-- hexo injector body_end start --><script type="text/javascript" src="/js/bundle_last.js"></script><!-- hexo injector body_end end -->

<script>CookieConsent.run({"palette":{"popup":{"background":"#000"},"button":{"background":"#f1d600"}},"guiOptions":{"consentModal":{"layout":"box","position":"bottom right","equalWeightButtons":true,"flipButtons":false},"preferencesModal":{"layout":"box","position":"right","equalWeightButtons":false,"flipButtons":false}},"categories":{"necessary":{"readOnly":true},"functionality":{},"analytics":{}},"language":{"default":"en","autoDetect":"browser","translations":{"en":{"consentModal":{"title":"Hello traveler, it's cookie time!","description":"🍪 This site uses cookies to serve you the best experience—no crumbs left behind! Want to know what cookies really are? Check out this easy-to-understand cookie explanation. And for the legal nitty-gritty, here’s our website cookie policy to keep you in the loop! 🚀\n","acceptAllBtn":"Accept all","acceptNecessaryBtn":"Reject all","showPreferencesBtn":"Manage preferences","footer":"<a href=\"#link\">Privacy Policy</a>\n<a href=\"/terms-and-conditions/\">Terms and conditions</a>\n"},"preferencesModal":{"title":"Consent Preferences Center","acceptAllBtn":"Accept all","acceptNecessaryBtn":"Reject all","savePreferencesBtn":"Save preferences","closeIconLabel":"Close modal","serviceCounterLabel":"Service|Services","sections":[{"title":"Cookie Usage","description":"We use cookies to make your visit smoother, faster, and tailored just for you. Cookies help us remember your preferences, improve site performance, and deliver personalized content while keeping things secure and user-friendly.\n"},{"title":"Strictly Necessary Cookies <span class=\"pm__badge\">Always Enabled</span>","description":"These cookies are essential for the website to function properly. They enable core features like security, page navigation, and access to secure areas. Without these, the site cannot operate correctly.\n","linkedCategory":"necessary"},{"title":"Functionality Cookies","description":"Functionality cookies remember your choices to provide a more personalized experience. For example, they save your language preference or login details so you don’t have to keep entering them each time.\n","linkedCategory":"functionality"},{"title":"Analytics Cookies","description":"Analytics cookies help us understand how visitors interact with our site by collecting information anonymously. This insight allows us to improve functionality, fix issues, and make the website better for you.\n","linkedCategory":"analytics"},{"title":"More information","description":"Please refer to our <a href='/pages/cookie-policy'>cookie policy</a> for full details on how we use cookies and your options to manage them.\n"}]}}}}})</script></body></html>