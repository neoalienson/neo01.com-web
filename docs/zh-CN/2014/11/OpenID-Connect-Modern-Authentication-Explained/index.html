<!DOCTYPE html><html lang="zh-CN"><head><!-- hexo injector head_begin start --><!-- Google tag (gtag.js) begins-->
    <script async="" src="https://www.googletagmanager.com/gtag/js?id=G-3DZR3TQYCY"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
    
      gtag('config', 'G-3DZR3TQYCY');
    </script>
    <!-- Google tag (gtag.js) ends-->
    <!-- hexo injector head_begin end -->
    <meta charset="utf-8">
    <!-- security headers starts -->
    <!-- meta http-equiv="content-security-policy" content="script-src 'sha256-B5nfCL2Dym3Ba4YJFI7wB3f4vtClbrYJZ32A5erBEdg=' 'sha256-lJjk3/dvd+wXqRFjV7T5L/nXJXr5NjUjmsKSPEe+ass=';" -->
    <!-- security headers ends -->
    <!-- favicon starts -->    
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <!-- favicon ends -->
    

    <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="alternate" href="/atom.xml" title="Decoding Digital Anomalies" type="application/atom+xml">
    

    

    

    

    

    

    

    
    
        


    
    
        


    



    
    <title>OpenID Connect：现代身份验证详解 | Decoding Digital Anomalies</title>
    
    <meta name="keywords" content="Authentication,OIDC,Security">
    
    
    <meta name="description" content="OpenID Connect 基于 OAuth 2.0 构建，为现代应用程序提供标准化的身份验证。了解 OIDC 如何统一身份验证和授权、何时使用它而不是 SAML，以及如何安全实施。">
<meta property="og:type" content="article">
<meta property="og:title" content="OpenID Connect：现代身份验证详解">
<meta property="og:url" content="https://neo01.com/zh-CN/2014/11/OpenID-Connect-Modern-Authentication-Explained/index.html">
<meta property="og:site_name" content="Decoding Digital Anomalies">
<meta property="og:description" content="OpenID Connect 基于 OAuth 2.0 构建，为现代应用程序提供标准化的身份验证。了解 OIDC 如何统一身份验证和授权、何时使用它而不是 SAML，以及如何安全实施。">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://neo01.com/assets/security/lock.png">
<meta property="article:published_time" content="2014-11-10T16:00:00.000Z">
<meta property="article:modified_time" content="2025-11-26T15:16:54.570Z">
<meta property="article:author" content="Neo Alienson">
<meta property="article:tag" content="Authentication">
<meta property="article:tag" content="OIDC">
<meta property="article:tag" content="Security">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://neo01.com/assets/security/lock.png">
    
    <!-- hexo injector head_end start --><link rel="stylesheet" type="text/css" href="/css/bundle.css"><script type="text/javascript" src="/js/bundle_first.js"></script><!-- hexo injector head_end end --><meta name="generator" content="Hexo 8.1.0">  <link rel="canonical" href="https://neo01.com/2014/11/OpenID-Connect-Modern-Authentication-Explained/">
  <link rel="alternate" hreflang="en" data-canonical="true" href="https://neo01.com/2014/11/OpenID-Connect-Modern-Authentication-Explained/">
  <link rel="alternate" hreflang="zh-TW" href="https://neo01.com/zh-TW/2014/11/OpenID-Connect-Modern-Authentication-Explained/">
  <link rel="alternate" hreflang="zh-CN" href="https://neo01.com/zh-CN/2014/11/OpenID-Connect-Modern-Authentication-Explained/">
<style id="admonition-styles">.admonition {
  margin: 1em 0;
  padding: 0rem;
  border-left: 0.3rem solid;
  border-radius: 0.4rem;
  background-color: #f9f9f9;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.04);
  overflow: hidden;
  page-break-inside: avoid;
}

.admonition-title {
  display: flex;
  align-items: center;
  font-weight: 600;
  padding: 0rem 1rem 0.1rem 0.75rem;
  font-size: 1.05em;
  background-color: rgba(0, 0, 0, 0.03);
  border-top-left-radius: 0.4rem;
  border-top-right-radius: 0.4rem;
  margin: 0 !important;
}

.admonition-icon {
  font-size: 1.2em;
  margin-right: 0.6rem;
  opacity: 0.85;
  margin-top: 0.1rem;
}

/* 内容区域 margin */
.admonition > *:not(.admonition-title) {
  margin: 0.6rem 1rem 0.6rem 1rem;
}

/* NOTE 类型 */
.admonition.anote {
  border-color: #448aff;
}
.admonition.anote > .admonition-title {
  background-color: #448aff1a;
  color: #2962ff;
}

/* INFO / TODO 类型 */
.admonition.info,
.admonition.todo {
  border-color: #00b8d4;
}
.admonition.info > .admonition-title,
.admonition.todo > .admonition-title {
  background-color: rgba(0, 184, 212, 0.1);
  color: #007c91;
}

/* 警告类 */
.admonition.warning,
.admonition.attention,
.admonition.caution {
  border-color: #ff9100;
}
.admonition.warning > .admonition-title,
.admonition.attention > .admonition-title,
.admonition.caution > .admonition-title {
  background-color: rgba(255, 145, 0, 0.1);
  color: #c66900;
}

/* 错误类 */
.admonition.failure,
.admonition.missing,
.admonition.fail,
.admonition.error,
.admonition.danger,
.admonition.bug {
  border-color: #ff5252;
}
.admonition.failure > .admonition-title,
.admonition.missing > .admonition-title,
.admonition.fail > .admonition-title,
.admonition.error > .admonition-title,
.admonition.danger > .admonition-title,
.admonition.bug > .admonition-title {
  background-color: rgba(255, 82, 82, 0.1);
  color: #b71c1c;
}

/* TIP 类型 */
.admonition.tip {
  border-color: #00bfa5;
}
.admonition.tip > .admonition-title {
  background-color: #00bfa51a;
  color: #00796b;
}

/* SUCCESS 类型 */
.admonition.success {
  border-color: #00c853;
}
.admonition.success > .admonition-title {
  background-color: #00c8531a;
  color: #2e7d32;
}

/* QUESTION 类型 */
.admonition.question {
  border-color: #64dd17;
}
.admonition.question > .admonition-title {
  background-color: #64dd171a;
  color: #558b2f;
}

/* EXAMPLE 类型 */
.admonition.example {
  border-color: #7c4dff;
}
.admonition.example > .admonition-title {
  background-color: #7c4dff1a;
  color: #512da8;
}

/* QUOTE 类型 */
.admonition.quote {
  border-color: #9e9e9e;
}
.admonition.quote > .admonition-title {
  background-color: #9e9e9e1a;
  color: #424242;
}

/*黑暗模式*/
/* 夜间模式基础样式 */
[data-theme="dark"] .admonition {
  background-color: #1e1e1e;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.4);
}

[data-theme="dark"] .admonition-title {
  background-color: rgba(255, 255, 255, 0.05);
}

/* anote */
[data-theme="dark"] .admonition.anote {
  border-color: #82b1ff;
}
[data-theme="dark"] .admonition.anote > .admonition-title {
  background-color: #82b1ff1a;
  color: #bbdefb;
}

/* tip */
[data-theme="dark"] .admonition.tip {
  border-color: #64ffda;
}
[data-theme="dark"] .admonition.tip > .admonition-title {
  background-color: #64ffda1a;
  color: #1de9b6;
}

/* success */
[data-theme="dark"] .admonition.success {
  border-color: #69f0ae;
}
[data-theme="dark"] .admonition.success > .admonition-title {
  background-color: #69f0ae1a;
  color: #00e676;
}

/* question */
[data-theme="dark"] .admonition.question {
  border-color: #b2ff59;
}
[data-theme="dark"] .admonition.question > .admonition-title {
  background-color: #b2ff591a;
  color: #aeea00;
}

/* example */
[data-theme="dark"] .admonition.example {
  border-color: #b388ff;
}
[data-theme="dark"] .admonition.example > .admonition-title {
  background-color: #b388ff1a;
  color: #b39ddb;
}

/* quote */
[data-theme="dark"] .admonition.quote {
  border-color: #bdbdbd;
}
[data-theme="dark"] .admonition.quote > .admonition-title {
  background-color: #bdbdbd1a;
  color: #eeeeee;
}

/* warning / attention / caution */
[data-theme="dark"] .admonition.warning,
[data-theme="dark"] .admonition.attention,
[data-theme="dark"] .admonition.caution {
  border-color: #ffb300;
}
[data-theme="dark"] .admonition.warning > .admonition-title,
[data-theme="dark"] .admonition.attention > .admonition-title,
[data-theme="dark"] .admonition.caution > .admonition-title {
  background-color: #ffb3001a;
  color: #ffe082;
}

/* error / fail / failure / bug / danger / missing */
[data-theme="dark"] .admonition.error,
[data-theme="dark"] .admonition.fail,
[data-theme="dark"] .admonition.failure,
[data-theme="dark"] .admonition.bug,
[data-theme="dark"] .admonition.missing,
[data-theme="dark"] .admonition.danger {
  border-color: #ef5350;
}
[data-theme="dark"] .admonition.error > .admonition-title,
[data-theme="dark"] .admonition.fail > .admonition-title,
[data-theme="dark"] .admonition.failure > .admonition-title,
[data-theme="dark"] .admonition.bug > .admonition-title,
[data-theme="dark"] .admonition.missing > .admonition-title,
[data-theme="dark"] .admonition.danger > .admonition-title {
  background-color: #ef53501a;
  color: #ff8a80;
}</style><style>
        .mermaid-wrapper{position:relative;width:100%;overflow:hidden;user-select:none}
        .mermaid-wrapper.fullscreen{position:fixed;top:0;left:0;width:100vw;height:100vh;z-index:9999;background:#fff}
        .mermaid-wrapper.fullscreen .mermaid-controls{margin-right:20px}
        .mermaid-controls{position:absolute;bottom:8px;right:8px;display:flex;gap:4px;z-index:10;cursor:move}
        .mermaid-controls button{width:32px;height:32px;border:none;background:rgba(255,255,255,0.9);border-radius:4px;cursor:pointer;font-size:16px;box-shadow:0 2px 4px rgba(0,0,0,0.2)}
        .mermaid-controls button:hover{background:#fff}
    </style><script id="mermaid-scripts" src="/cache/mermaid.min.local.js"></script>
<script>mermaid.initialize({theme: 'default'});</script>
<script>(function(){
        document.addEventListener('DOMContentLoaded',function(){
            setTimeout(function(){
                document.querySelectorAll('.mermaid').forEach(function(el){
                    const w=document.createElement('div');
                    w.className='mermaid-wrapper';
                    el.parentNode.insertBefore(w,el);
                    w.appendChild(el);
                    const c=document.createElement('div');
                    c.className='mermaid-controls';
                    const zi=document.createElement('button');zi.innerHTML='🔍';zi.title='Zoom In';zi.dataset.action='zoom-in';c.appendChild(zi);const zo=document.createElement('button');zo.innerHTML='🔎';zo.title='Zoom Out';zo.dataset.action='zoom-out';c.appendChild(zo);const r=document.createElement('button');r.innerHTML='↺';r.title='Reset';r.dataset.action='reset';c.appendChild(r);const d=document.createElement('button');d.innerHTML='💾';d.title='Download SVG';d.dataset.action='download';c.appendChild(d);const f=document.createElement('button');f.innerHTML='⛶';f.title='Fullscreen';f.dataset.action='fullscreen';c.appendChild(f);let sc=1,tx=0,ty=0;c.addEventListener('click',function(e){
        const btn=e.target.closest('button');if(!btn)return;
        const s=el.querySelector('svg');if(!s)return;
        const action=btn.dataset.action;
        if(action==='zoom-in'){
            sc=sc*1.2;
            s.style.transform='scale('+sc+')';s.style.transformOrigin='top left'
        }else if(action==='zoom-out'){
            sc=sc/1.2;
            s.style.transform='scale('+sc+')';s.style.transformOrigin='top left'
        }else if(action==='reset'){
            sc=1;tx=0;ty=0;s.style.transform='';s.style.transformOrigin='top left'
        }else if(action==='download'){
            const clone=s.cloneNode(true);clone.removeAttribute('style');
            const svg=clone.outerHTML.replace(/<br\s*\/?>/gi,'').replace(/<\/p>/gi,'').replace(/&nbsp;/gi,'&#160;');
            const b=new Blob([svg],{type:'image/svg+xml'});const u=URL.createObjectURL(b);
            const a=document.createElement('a');a.href=u;a.download='mermaid-diagram.svg';a.click();URL.revokeObjectURL(u)
        }else if(action==='fullscreen'){
            if(w.classList.contains('fullscreen')){
                w.classList.remove('fullscreen');btn.innerHTML='⛶';btn.title='Fullscreen';
                c.style.top='';c.style.left='';c.style.right='';c.style.bottom='';c.style.marginRight=''
            }else{
                w.classList.add('fullscreen');btn.innerHTML='✕';btn.title='Close';
                c.style.top='';c.style.left='';c.style.right='';c.style.bottom='';c.style.marginRight=''
            }
        }
    });let dx=0,dy=0,px=0,py=0;
            c.onmousedown=(e)=>{e.preventDefault();px=e.clientX;py=e.clientY;
            document.onmousemove=(e)=>{e.preventDefault();dx=px-e.clientX;dy=py-e.clientY;px=e.clientX;py=e.clientY;
            c.style.top=(c.offsetTop-dy)+'px';c.style.left=(c.offsetLeft-dx)+'px';c.style.right='auto';c.style.bottom='auto'};
            document.onmouseup=()=>{document.onmousemove=null;document.onmouseup=null}};w.appendChild(c);const s=el.querySelector('svg');if(s){
            w.style.cursor='grab';s.style.userSelect='none';s.style.position='relative';
            let px=0,py=0,dragging=false;
            w.addEventListener('mousedown',function(e){
                if(e.target.closest('.mermaid-controls')||e.target.closest('button'))return;
                dragging=true;w.style.cursor='grabbing';e.preventDefault();px=e.clientX;py=e.clientY;
                const t=s.style.transform.match(/translate\(([\d.-]+)px,\s*([\d.-]+)px\)/);
                if(t){tx=parseFloat(t[1]);ty=parseFloat(t[2])}else{tx=0;ty=0}});
            document.addEventListener('mousemove',function(e){
                if(!dragging)return;e.preventDefault();
                const dx=e.clientX-px;const dy=e.clientY-py;const nt=tx+dx;const nty=ty+dy;
                const scaleStr=sc!==1?' scale('+sc+')':'';
                s.style.transform='translate('+nt+'px, '+nty+'px)'+scaleStr;s.style.transformOrigin='top left'})
            document.addEventListener('mouseup',function(){
                if(dragging){
                    const t=s.style.transform.match(/translate\(([\d.-]+)px,\s*([\d.-]+)px\)/);
                    if(t){tx=parseFloat(t[1]);ty=parseFloat(t[2])}else{tx=0;ty=0}
                    dragging=false;w.style.cursor='grab'}})}
                })
            },100)
        })
    })();</script></head>

<body>
    <div id="wrap">
        
        
<header id="header">
    <div id="header-outer" class="outer">
        <div class="container">
            <div class="container-inner">
                <div id="header-title">
                    <h1 class="logo-wrap">
                        <div class="logo"></div>
                    </h1>

                        <h2 class="subtitle-wrap">
                            <p class="title">解码数字异常</p>
                          <p class="subtitle">有时功能就是数字兔子洞中的错误，反之亦然</p>
                        </h2>




                    <div id="lang-selector">
                        <span class="lang-icon">🌐</span>
                        
                            <a href="#" class="lang-link" data-lang="en">English</a>
<span class="lang-sep">|</span>                            <a href="#" class="lang-link" data-lang="zh-TW">繁體中文</a>
                        <script>
                        document.addEventListener('DOMContentLoaded', function() {
                            var currentLang = 'zh-CN';
                            var currentPath = window.location.pathname;
                            var basePath;
                            
                            if (currentLang === 'en') {
                                basePath = currentPath;
                            } else {
                                basePath = currentPath.replace(new RegExp('^/' + currentLang + '/'), '/');
                            }
                            
                            document.querySelectorAll('.lang-link').forEach(function(link) {
                                var targetLang = link.getAttribute('data-lang');
                                var targetPath;
                                if (targetLang === 'en') {
                                    targetPath = basePath;
                                } else {
                                    targetPath = '/' + targetLang + basePath;
                                }
                                link.href = targetPath;
                            });
                        });
                        </script>
                    </div>


                </div>
                <div id="header-inner" class="nav-container">
                    <a id="main-nav-toggle" class="nav-icon fa fa-bars"></a>
                    <div class="nav-container-inner">
                        <ul id="main-nav">
                            
                                <li class="main-nav-list-item">
                                    <a class="main-nav-list-link" href="/zh-CN/">主页</a>
                                </li>
                                                                    <ul class="main-nav-list"><li class="main-nav-list-item"><a class="main-nav-list-link" href="/zh-CN/categories/AI/">人工智能</a><ul class="main-nav-list-child"><li class="main-nav-list-item"><a class="main-nav-list-link" href="/zh-CN/categories/AI/Art-Gallery/">艺术画廊</a></li></ul></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/zh-CN/categories/Architecture/">架构</a></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/zh-CN/categories/Cybersecurity/">网络安全</a></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/zh-CN/categories/Development/">开发</a></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/zh-CN/categories/Misc/">杂项</a></li></ul>
                                <li class="main-nav-list-item">
                                    <a class="main-nav-list-link" href="/zh-CN/about-me/">关于</a>
                                </li>
                            
                        </ul>
                        <nav id="sub-nav">
                            <div id="search-form-wrap">

    <form class="search-form">
        <input type="text" class="ins-search-input search-form-input" id="search-form-input" placeholder="搜索">
        <button type="submit" title="搜索" class="search-form-submit"></button>
    </form>
    <div class="ins-search">
    <div class="ins-search-mask"></div>
    <div class="ins-search-container">
        <div class="ins-input-wrapper">
            <input type="text" class="ins-search-input" id="ins-search-input" placeholder="想要查找什么...">
            <span class="ins-close ins-selectable"><i class="fa fa-times-circle"></i></span>
        </div>
        <div class="ins-section-wrapper">
            <div class="ins-section-container"></div>
        </div>
    </div>
</div>
<script integrity="sha256-B5nfCL2Dym3Ba4YJFI7wB3f4vtClbrYJZ32A5erBEdg=">
(function (window) {
    var INSIGHT_CONFIG = {
        TRANSLATION: {
            POSTS: '文章',
            PAGES: '页面',
            CATEGORIES: '分类',
            TAGS: '标签',
            UNTITLED: '(未命名)',
        },
        ROOT_URL: '/',
        CONTENT_URL: '/content.json',
        LANG: 'zh-CN',
    };
    window.INSIGHT_CONFIG = INSIGHT_CONFIG;
})(window);
</script>




</div>
                        </nav>
                    </div>
                </div>
            </div>
        </div>
    </div>
</header>

        
        <div class="container">
            <div class="main-body container-inner">
                <div class="main-body-inner">
                    <section id="main">
                        <div class="main-body-header">
    <h1 class="header">
    
    <a class="page-title-link" href="/categories/Cybersecurity/">Cybersecurity</a>
    </h1>
</div>

                        <div class="main-body-content">
                            <article id="post-2014/11/OpenID-Connect-Modern-Authentication-Explained-zh-CN" class="article article-single article-type-post" itemscope="" itemprop="blogPost">
    <div class="article-inner responsive-content">
        
            <header class="article-header">
                
    
        <h1 class="article-title" itemprop="name">
        OpenID Connect：现代身份验证详解
        </h1>
    

            </header>
        
        
            <div class="article-meta">
                
    <div class="article-date">
      <i class="fa fa-calendar"></i>
        
          Created <time datetime="2014-11-10T16:00:00.000Z" itemprop="datePublished">2014-11-11</time>
          &nbsp;<i class="fa fa-calendar"></i>
          Updated <time datetime="2025-11-26T15:16:54.570Z" itemprop="datePublished">2025-11-26</time>
        
    </div>


                

                
    <div class="article-tag">
        <i class="fa fa-tag"></i>
        <a class="tag-link" href="/zh-CN/tags/Security/">Security</a> <a class="tag-link" href="/zh-CN/tags/Authentication/">Authentication</a> <a class="tag-link" href="/zh-CN/tags/OIDC/">OIDC</a>
    </div>

            </div>
        
        
        
        <div class="article-entry" itemprop="articleBody">
            <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#OIDC-%E5%9F%BA%E7%A1%80"><span class="toc-text">OIDC 基础</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#OIDC-%E6%9E%B6%E6%9E%84"><span class="toc-text">OIDC 架构</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%BA%AB%E4%BB%BD%E9%AA%8C%E8%AF%81%E6%B5%81%E7%A8%8B"><span class="toc-text">身份验证流程</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ID-%E4%BB%A4%E7%89%8C%E6%B7%B1%E5%85%A5%E6%8E%A2%E8%AE%A8"><span class="toc-text">ID 令牌深入探讨</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%94%A8%E6%88%B7%E4%BF%A1%E6%81%AF%E7%AB%AF%E7%82%B9"><span class="toc-text">用户信息端点</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%91%E7%8E%B0%E5%92%8C%E5%85%83%E6%95%B0%E6%8D%AE"><span class="toc-text">发现和元数据</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#OIDC-%E5%AE%9E%E8%B7%B5"><span class="toc-text">OIDC 实践</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%89%E5%85%A8%E8%80%83%E8%99%91"><span class="toc-text">安全考虑</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#OIDC-vs-SAML"><span class="toc-text">OIDC vs SAML</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B8%B8%E8%A7%81%E9%94%99%E8%AF%AF"><span class="toc-text">常见错误</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BB%93%E8%AE%BA"><span class="toc-text">结论</span></a></li></ol>
            <p>OAuth 2.0 革新了 API 授权，但开发人员误用它进行身份验证，造成了安全漏洞。OpenID Connect（OIDC）于 2014 年出现，通过在 OAuth 2.0 之上添加标准化的身份层来解决这个问题。OIDC 提供了开发人员真正需要的：一个在统一流程中处理身份验证（你是谁）和授权（你可以访问什么）的现代协议。</p>
<p>这种混淆是可以理解的。开发人员看到 OAuth 在"使用 Google 登录"中的成功，并假设 OAuth 是一个身份验证协议。他们会获取访问令牌并将其视为身份证明。这造成了安全问题——访问令牌不是为证明身份而设计的，它们授予对资源的访问权限。不同的提供者以不同的方式实现用户信息端点，导致实现不一致且不安全。</p>
<p>OIDC 通过引入 ID 令牌解决了这个问题——一个专门设计用于证明用户身份的 JWT。当你使用 OIDC 进行身份验证时，你会同时收到 ID 令牌（证明你是谁）和访问令牌（授予 API 访问权限）。这种明确的分离消除了混淆并提供了安全的身份验证和标准化的用户信息。</p>
<p>本文涵盖 OIDC 基础、架构、身份验证流程、实际实施、安全考虑，以及何时选择 OIDC 而不是 SAML 等替代方案。</p>
<h2 id="OIDC-基础">OIDC 基础</h2>
<p>OpenID Connect 通过身份层扩展 OAuth 2.0，提供标准化的身份验证。</p>
<h3 id="核心概念">核心概念</h3>
<p>OIDC 建立在 OAuth 2.0 的基础之上：</p>
<div class="admonition anote"><p class="admonition-title"><span class="mdi mdi-note-outline admonition-icon"></span>🆔 OIDC 核心概念</p><div class="admonition-content"><p><strong>基于 OAuth 2.0</strong></p>
<ul>
<li>使用 OAuth 流程</li>
<li>添加 ID 令牌</li>
<li>标准化用户信息</li>
<li>结合身份验证和授权</li>
</ul>
<p><strong>ID 令牌</strong></p>
<ul>
<li>JWT（JSON Web Token）</li>
<li>包含用户身份声明</li>
<li>数字签名</li>
<li>可由客户端验证</li>
</ul>
<p><strong>标准端点</strong></p>
<ul>
<li>授权端点</li>
<li>令牌端点</li>
<li>用户信息端点</li>
<li>发现端点</li>
</ul>
</div></div>
<p>ID 令牌是 OIDC 的关键创新。它是一个包含用户 ID、电子邮件和姓名等身份声明的 JWT。令牌由授权服务器数字签名，允许客户端验证其真实性而无需回调服务器。这提供了安全、高效的身份验证。</p>
<h3 id="OIDC-vs-OAuth">OIDC vs OAuth</h3>
<p>理解 OIDC 和 OAuth 之间的区别至关重要：</p>
<div class="admonition tip"><p class="admonition-title"><span class="mdi mdi-lightbulb-on-outline admonition-icon"></span>🎯 OIDC vs OAuth</p><div class="admonition-content"><p><strong>OAuth 2.0</strong></p>
<ul>
<li>授权协议</li>
<li>授予对资源的访问权限</li>
<li>API 的访问令牌</li>
<li>不证明身份</li>
</ul>
<p><strong>OpenID Connect</strong></p>
<ul>
<li>身份验证协议</li>
<li>证明用户身份</li>
<li>身份验证的 ID 令牌</li>
<li>基于 OAuth 2.0</li>
</ul>
<p><strong>关键区别</strong></p>
<ul>
<li>OAuth："你可以访问什么？"</li>
<li>OIDC："你是谁？" + "你可以访问什么？"</li>
</ul>
</div></div>
<p>OAuth 回答"你可以访问什么？"OIDC 回答"你是谁？"和"你可以访问什么？"如果你需要身份验证，使用 OIDC。如果你只需要 API 授权而不需要用户身份，使用 OAuth。</p>
<h2 id="OIDC-架构">OIDC 架构</h2>
<p>OIDC 定义了实体及其交互：</p>
<h3 id="实体">实体</h3>
<p>OIDC 涉及四个主要实体：</p>
<div class="admonition anote"><p class="admonition-title"><span class="mdi mdi-note-outline admonition-icon"></span>🏗️ OIDC 实体</p><div class="admonition-content"><p><strong>最终用户</strong></p>
<ul>
<li>进行身份验证的人</li>
<li>拥有资源</li>
<li>授予权限</li>
</ul>
<p><strong>依赖方（RP）</strong></p>
<ul>
<li>客户端应用程序</li>
<li>请求身份验证</li>
<li>使用 ID 令牌</li>
<li>Web 应用、移动应用或 SPA</li>
</ul>
<p><strong>OpenID 提供者（OP）</strong></p>
<ul>
<li>授权服务器</li>
<li>验证用户身份</li>
<li>颁发 ID 令牌和访问令牌</li>
<li>示例：Auth0、Okta、Azure AD</li>
</ul>
<p><strong>资源服务器</strong></p>
<ul>
<li>托管受保护的 API</li>
<li>验证访问令牌</li>
<li>返回受保护的资源</li>
</ul>
</div></div>
<p>依赖方（RP）是请求身份验证的应用程序——你的 Web 应用、移动应用或单页应用程序。OpenID 提供者（OP）是验证用户身份并颁发令牌的授权服务器。资源服务器托管接受访问令牌的 API。</p>
<h3 id="架构图">架构图</h3>
<div class="mermaid">---
title: OpenID Connect 架构
---
flowchart TD
    User([用户])
    Client[客户端应用程序<br>Web/移动]
    AuthServer[授权服务器<br>Auth0/Okta]
    API1[资源服务器<br>用户 API]
    API2[资源服务器<br>支付 API]
    API3[资源服务器<br>数据 API]
    
    User --&gt;|登录| Client
    Client &lt;--&gt;|1. 身份验证请求<br>2. ID 令牌 + 访问令牌| AuthServer
    Client --&gt;|访问令牌| API1
    Client --&gt;|访问令牌| API2
    Client --&gt;|访问令牌| API3
    API1 -.-&gt;|验证令牌| AuthServer
    API2 -.-&gt;|验证令牌| AuthServer
    API3 -.-&gt;|验证令牌| AuthServer
    
    style AuthServer fill:#f96,stroke:#333,stroke-width:3px
    style Client fill:#9cf,stroke:#333,stroke-width:2px</div>
<p>客户端通过授权服务器验证用户身份，接收 ID 令牌和访问令牌。客户端使用 ID 令牌建立用户身份。资源服务器验证访问令牌以授权 API 请求。</p>
<h2 id="身份验证流程">身份验证流程</h2>
<p>OIDC 支持多种身份验证流程以适应不同场景。</p>
<h3 id="授权码流程">授权码流程</h3>
<p>授权码流程是最安全且推荐的流程：</p>
<div class="admonition anote"><p class="admonition-title"><span class="mdi mdi-note-outline admonition-icon"></span>🔄 授权码流程</p><div class="admonition-content"><p><strong>用例</strong></p>
<ul>
<li>带后端的 Web 应用程序</li>
<li>移动应用程序</li>
<li>最安全的选项</li>
<li>推荐用于所有机密客户端</li>
</ul>
<p><strong>流程步骤</strong></p>
<ol>
<li>用户点击"登录"</li>
<li>客户端重定向到授权端点</li>
<li>用户在 OP 进行身份验证</li>
<li>OP 重定向回授权码</li>
<li>客户端交换码以获取令牌（后端）</li>
<li>客户端接收 ID 令牌和访问令牌</li>
<li>客户端验证 ID 令牌</li>
<li>客户端提取用户身份</li>
<li>客户端使用访问令牌进行 API 调用</li>
</ol>
<p><strong>安全特性</strong></p>
<ul>
<li>令牌永不暴露给浏览器</li>
<li>客户端密钥保护令牌交换</li>
<li>授权码是一次性的</li>
<li>短期码</li>
</ul>
</div></div>
<p>此流程通过在后端使用客户端密钥将授权码交换为令牌来保持令牌安全。授权码通过浏览器传递，但令牌不会，从而保护它们免受基于浏览器的攻击。</p>
<div class="mermaid">---
title: OpenID Connect 身份验证流程
---
sequenceDiagram
    participant User as 用户
    participant Client as 客户端
    participant AuthServer as 授权服务器
    participant API as 资源服务器
    
    User-&gt;&gt;Client: 点击"登录"
    Client-&gt;&gt;AuthServer: 授权请求
    AuthServer-&gt;&gt;User: 登录页面
    User-&gt;&gt;AuthServer: 凭据
    AuthServer-&gt;&gt;Client: 授权码
    Client-&gt;&gt;AuthServer: 交换码 + 客户端密钥
    AuthServer-&gt;&gt;Client: ID 令牌 + 访问令牌
    Note over Client: 验证 ID 令牌签名
    Client-&gt;&gt;Client: 提取用户身份
    Client-&gt;&gt;API: API 请求 + 访问令牌
    API-&gt;&gt;API: 验证访问令牌
    API-&gt;&gt;Client: 受保护的资源</div>
<h3 id="带-PKCE-的授权码流程">带 PKCE 的授权码流程</h3>
<p>PKCE（代码交换证明密钥）为公共客户端增加了安全性：</p>
<div class="admonition anote"><p class="admonition-title"><span class="mdi mdi-note-outline admonition-icon"></span>🔐 PKCE 扩展</p><div class="admonition-content"><p><strong>目的</strong></p>
<ul>
<li>保护公共客户端</li>
<li>移动应用</li>
<li>单页应用程序</li>
<li>无客户端密钥</li>
</ul>
<p><strong>工作原理</strong></p>
<ol>
<li>客户端生成代码验证器（随机字符串）</li>
<li>客户端创建代码挑战（验证器的哈希）</li>
<li>客户端在身份验证请求中发送代码挑战</li>
<li>OP 存储代码挑战</li>
<li>客户端交换码 + 代码验证器以获取令牌</li>
<li>OP 验证验证器与挑战匹配</li>
</ol>
<p><strong>安全优势</strong></p>
<ul>
<li>防止授权码拦截</li>
<li>无需客户端密钥即可工作</li>
<li>移动和 SPA 必需</li>
</ul>
</div></div>
<p>PKCE 防止授权码拦截攻击。即使攻击者拦截了授权码，他们也无法在没有代码验证器的情况下将其交换为令牌，而代码验证器永远不会离开客户端。</p>
<h3 id="隐式流程（已弃用）">隐式流程（已弃用）</h3>
<p>隐式流程是为基于浏览器的应用设计的，但现在已弃用：</p>
<div class="admonition error"><p class="admonition-title"><span class="mdi mdi-alert-circle-outline admonition-icon"></span>🚫 隐式流程 - 已弃用</p><div class="admonition-content"><p><strong>为何存在</strong></p>
<ul>
<li>基于浏览器的应用</li>
<li>无后端服务器</li>
<li>URL 片段中的令牌</li>
</ul>
<p><strong>为何弃用</strong></p>
<ul>
<li>令牌在浏览器中暴露</li>
<li>URL 片段泄漏风险</li>
<li>无刷新令牌</li>
<li>安全漏洞</li>
</ul>
<p><strong>改用</strong></p>
<ul>
<li>带 PKCE 的授权码流程</li>
<li>提供更好的安全性</li>
<li>适用于 SPA</li>
</ul>
</div></div>
<p>不要在新应用程序中使用隐式流程。即使对于单页应用程序，也使用带 PKCE 的授权码流程。现代浏览器和库安全地支持这一点。</p>
<h3 id="客户端凭据流程">客户端凭据流程</h3>
<p>用于机器对机器身份验证：</p>
<div class="admonition anote"><p class="admonition-title"><span class="mdi mdi-note-outline admonition-icon"></span>🤖 客户端凭据流程</p><div class="admonition-content"><p><strong>用例</strong></p>
<ul>
<li>后端服务</li>
<li>微服务</li>
<li>计划作业</li>
<li>无用户交互</li>
</ul>
<p><strong>流程</strong></p>
<ol>
<li>服务使用客户端 ID 和密钥进行身份验证</li>
<li>OP 颁发访问令牌</li>
<li>服务使用令牌进行 API 调用</li>
</ol>
<p><strong>特征</strong></p>
<ul>
<li>不涉及用户</li>
<li>服务账户身份验证</li>
<li>无 ID 令牌（无用户身份）</li>
<li>仅访问令牌</li>
</ul>
</div></div>
<p>此流程用于不涉及用户的服务对服务身份验证。后端服务使用其凭据进行身份验证并接收访问令牌以调用 API。</p>
<h2 id="ID-令牌深入探讨">ID 令牌深入探讨</h2>
<p>ID 令牌是 OIDC 的核心创新。</p>
<h3 id="ID-令牌结构">ID 令牌结构</h3>
<p>ID 令牌是具有三个部分的 JWT：</p>
<div class="admonition anote"><p class="admonition-title"><span class="mdi mdi-note-outline admonition-icon"></span>🎫 ID 令牌结构</p><div class="admonition-content"><p><strong>头部</strong></p>
<ul>
<li>令牌类型（JWT）</li>
<li>签名算法（RS256 等）</li>
<li>验证的密钥 ID</li>
</ul>
<p><strong>载荷（声明）</strong></p>
<ul>
<li>iss：颁发者（OP URL）</li>
<li>sub：主题（用户 ID）</li>
<li>aud：受众（客户端 ID）</li>
<li>exp：过期时间</li>
<li>iat：颁发时间</li>
<li>nonce：重放保护</li>
<li>email、name 等：用户属性</li>
</ul>
<p><strong>签名</strong></p>
<ul>
<li>数字签名</li>
<li>验证令牌真实性</li>
<li>防止篡改</li>
</ul>
</div></div>
<p>示例 ID 令牌载荷：</p>
<pre><code>{
  "iss": "https://auth.example.com",
  "sub": "user123",
  "aud": "client_abc",
  "exp": 1699999999,
  "iat": 1699996399,
  "nonce": "random_nonce",
  "email": "user@example.com",
  "name": "John Doe",
  "email_verified": true
}
</code></pre>
<h3 id="ID-令牌验证">ID 令牌验证</h3>
<p>客户端必须正确验证 ID 令牌：</p>
<div class="admonition warning"><p class="admonition-title"><span class="mdi mdi-alert-outline admonition-icon"></span>⚠️ ID 令牌验证要求</p><div class="admonition-content"><p><strong>必需检查</strong></p>
<ol>
<li>使用 OP 的公钥验证签名</li>
<li>检查颁发者（iss）与预期 OP 匹配</li>
<li>检查受众（aud）与客户端 ID 匹配</li>
<li>检查过期时间（exp）未过期</li>
<li>验证 nonce 与请求匹配</li>
<li>检查颁发时间（iat）合理</li>
</ol>
<p><strong>安全影响</strong></p>
<ul>
<li>跳过验证会造成漏洞</li>
<li>攻击者可以伪造令牌</li>
<li>令牌替换攻击</li>
<li>始终完全验证</li>
</ul>
</div></div>
<p>永远不要跳过 ID 令牌验证。每个检查都防止特定的攻击。签名验证防止伪造。受众检查防止令牌替换。过期检查防止重放攻击。</p>
<h3 id="标准声明">标准声明</h3>
<p>OIDC 为用户信息定义了标准声明：</p>
<div class="admonition anote"><p class="admonition-title"><span class="mdi mdi-note-outline admonition-icon"></span>📋 标准声明</p><div class="admonition-content"><p><strong>个人资料声明</strong></p>
<ul>
<li>name：全名</li>
<li>given_name：名字</li>
<li>family_name：姓氏</li>
<li>middle_name：中间名</li>
<li>nickname：昵称</li>
<li>picture：个人资料照片 URL</li>
<li>website：网页 URL</li>
</ul>
<p><strong>联系声明</strong></p>
<ul>
<li>email：电子邮件地址</li>
<li>email_verified：电子邮件验证状态</li>
<li>phone_number：电话号码</li>
<li>phone_number_verified：电话验证状态</li>
</ul>
<p><strong>地址声明</strong></p>
<ul>
<li>address：结构化地址对象</li>
</ul>
<p><strong>其他声明</strong></p>
<ul>
<li>birthdate：出生日期</li>
<li>gender：性别</li>
<li>locale：区域设置/语言</li>
<li>zoneinfo：时区</li>
</ul>
</div></div>
<p>客户端使用范围请求特定声明。openid 范围是必需的。profile、email 和 phone 等附加范围请求附加声明。</p>
<h2 id="用户信息端点">用户信息端点</h2>
<p>用户信息端点提供额外的用户信息。</p>
<h3 id="目的和用法">目的和用法</h3>
<div class="admonition anote"><p class="admonition-title"><span class="mdi mdi-note-outline admonition-icon"></span>ℹ️ 用户信息端点</p><div class="admonition-content"><p><strong>目的</strong></p>
<ul>
<li>检索额外的用户属性</li>
<li>补充 ID 令牌声明</li>
<li>标准化端点</li>
</ul>
<p><strong>用法</strong></p>
<ol>
<li>客户端获取访问令牌</li>
<li>客户端使用令牌调用用户信息端点</li>
<li>OP 以 JSON 形式返回用户声明</li>
</ol>
<p><strong>何时使用</strong></p>
<ul>
<li>需要比 ID 令牌包含的更多声明</li>
<li>ID 令牌大小限制</li>
<li>动态用户信息</li>
</ul>
</div></div>
<p>用户信息端点以 JSON 格式返回用户声明。它使用访问令牌调用，并根据令牌的范围返回声明。</p>
<p>示例用户信息响应：</p>
<pre><code>{
  "sub": "user123",
  "email": "user@example.com",
  "name": "John Doe",
  "picture": "https://example.com/photo.jpg",
  "email_verified": true
}
</code></pre>
<h2 id="发现和元数据">发现和元数据</h2>
<p>OIDC 提供自动配置发现。</p>
<h3 id="发现端点">发现端点</h3>
<p>发现端点返回 OP 配置：</p>
<div class="admonition anote"><p class="admonition-title"><span class="mdi mdi-note-outline admonition-icon"></span>🔍 OIDC 发现</p><div class="admonition-content"><p><strong>端点</strong></p>
<ul>
<li><code>/.well-known/openid-configuration</code></li>
<li>返回 JSON 元数据</li>
<li>自动配置</li>
</ul>
<p><strong>元数据包括</strong></p>
<ul>
<li>授权端点 URL</li>
<li>令牌端点 URL</li>
<li>用户信息端点 URL</li>
<li>支持的范围</li>
<li>支持的响应类型</li>
<li>签名算法</li>
<li>JWKS URI（公钥）</li>
</ul>
</div></div>
<p>示例发现 URL：<code>https://auth.example.com/.well-known/openid-configuration</code></p>
<p>这使得客户端可以自动配置。客户端获取发现文档并自行配置，无需手动端点配置。</p>
<h2 id="OIDC-实践">OIDC 实践</h2>
<p>实际 OIDC 实施考虑。</p>
<h3 id="提供者选择">提供者选择</h3>
<p>选择 OIDC 提供者：</p>
<div class="admonition tip"><p class="admonition-title"><span class="mdi mdi-lightbulb-on-outline admonition-icon"></span>🎯 OIDC 提供者选择</p><div class="admonition-content"><p><strong>托管提供者</strong></p>
<ul>
<li>Auth0：开发者友好，功能广泛</li>
<li>Okta：企业重点，强大支持</li>
<li>Azure AD：Microsoft 生态系统集成</li>
<li>Google Identity：消费者和企业</li>
<li>AWS Cognito：AWS 生态系统集成</li>
</ul>
<p><strong>自托管</strong></p>
<ul>
<li>Keycloak：开源，功能丰富</li>
<li>ORY Hydra：云原生，轻量级</li>
<li>Authelia：自托管，注重隐私</li>
</ul>
<p><strong>考虑因素</strong></p>
<ul>
<li>合规要求</li>
<li>可扩展性需求</li>
<li>成本结构</li>
<li>开发者体验</li>
<li>支持要求</li>
</ul>
</div></div>
<p>托管提供者提供更简单的设置和维护。自托管选项提供更多控制和数据隐私。根据你的要求、团队能力和预算进行选择。</p>
<h3 id="集成库">集成库</h3>
<p>使用标准库进行 OIDC 集成：</p>
<div class="admonition success"><p class="admonition-title"><span class="mdi mdi-check-circle-outline admonition-icon"></span>✅ OIDC 库</p><div class="admonition-content"><p><strong>JavaScript/Node.js</strong></p>
<ul>
<li>oidc-client-ts：浏览器和 Node.js</li>
<li>passport-openidconnect：Node.js 中间件</li>
<li>next-auth：Next.js 集成</li>
</ul>
<p><strong>Python</strong></p>
<ul>
<li>authlib：全面的 OAuth/OIDC</li>
<li>python-jose：JWT 处理</li>
<li>flask-oidc：Flask 集成</li>
</ul>
<p><strong>Java</strong></p>
<ul>
<li>Spring Security OAuth：Spring 集成</li>
<li>pac4j：多协议支持</li>
</ul>
<p><strong>C#/.NET</strong></p>
<ul>
<li>IdentityModel：OIDC 客户端库</li>
<li>Microsoft.Identity.Web：ASP.NET Core</li>
</ul>
<p><strong>移动</strong></p>
<ul>
<li>AppAuth：iOS 和 Android</li>
<li>React Native AppAuth：React Native</li>
</ul>
</div></div>
<p>不要从头实现 OIDC。使用维护良好的库来处理协议细节、令牌验证和安全最佳实践。</p>
<h3 id="实施示例">实施示例</h3>
<p>基本 OIDC 流程实施：</p>
<pre><code>// 1. 重定向到授权端点
const authUrl = `${issuer}/authorize?` +
  `response_type=code&amp;` +
  `client_id=${clientId}&amp;` +
  `redirect_uri=${redirectUri}&amp;` +
  `scope=openid profile email&amp;` +
  `state=${state}&amp;` +
  `nonce=${nonce}`;

window.location.href = authUrl;

// 2. 处理回调（后端）
const tokenResponse = await fetch(`${issuer}/token`, {
  method: 'POST',
  headers: { 'Content-Type': 'application/x-www-form-urlencoded' },
  body: new URLSearchParams({
    grant_type: 'authorization_code',
    code: authCode,
    redirect_uri: redirectUri,
    client_id: clientId,
    client_secret: clientSecret
  })
});

const { id_token, access_token } = await tokenResponse.json();

// 3. 验证 ID 令牌
const decoded = jwt.verify(id_token, publicKey, {
  issuer: issuer,
  audience: clientId
});

// 4. 提取用户身份
const userId = decoded.sub;
const email = decoded.email;
</code></pre>
<p>这显示了基本流程：重定向到授权端点，交换码以获取令牌，验证 ID 令牌，提取用户身份。</p>
<h2 id="安全考虑">安全考虑</h2>
<p>OIDC 安全最佳实践。</p>
<h3 id="令牌安全">令牌安全</h3>
<p>小心保护令牌：</p>
<div class="admonition warning"><p class="admonition-title"><span class="mdi mdi-alert-outline admonition-icon"></span>⚠️ 令牌安全最佳实践</p><div class="admonition-content"><p><strong>存储</strong></p>
<ul>
<li>永不在 localStorage 中存储令牌</li>
<li>尽可能使用 httpOnly cookie</li>
<li>静态加密令牌</li>
<li>注销时清除令牌</li>
</ul>
<p><strong>传输</strong></p>
<ul>
<li>始终使用 HTTPS</li>
<li>验证 TLS 证书</li>
<li>避免在 URL 中使用令牌</li>
<li>使用安全头</li>
</ul>
<p><strong>验证</strong></p>
<ul>
<li>验证令牌签名</li>
<li>检查过期时间</li>
<li>验证颁发者</li>
<li>验证受众</li>
<li>检查 nonce</li>
</ul>
<p><strong>轮换</strong></p>
<ul>
<li>短期访问令牌（15 分钟）</li>
<li>刷新令牌轮换</li>
<li>撤销机制</li>
<li>监控滥用</li>
</ul>
</div></div>
<p>令牌是持有者凭据——任何拥有令牌的人都可以使用它。在 localStorage 中存储令牌会使其暴露于 XSS 攻击。在信任令牌之前，始终完全验证令牌。</p>
<h3 id="公共客户端的-PKCE">公共客户端的 PKCE</h3>
<p>始终对公共客户端使用 PKCE：</p>
<div class="admonition tip"><p class="admonition-title"><span class="mdi mdi-lightbulb-on-outline admonition-icon"></span>🔐 PKCE 最佳实践</p><div class="admonition-content"><p><strong>何时使用</strong></p>
<ul>
<li>移动应用程序</li>
<li>单页应用程序</li>
<li>任何公共客户端</li>
<li>即使对机密客户端（纵深防御）</li>
</ul>
<p><strong>实施</strong></p>
<ul>
<li>生成加密随机验证器</li>
<li>使用 S256 挑战方法（SHA-256）</li>
<li>永不重用验证器</li>
<li>在服务器端验证</li>
</ul>
</div></div>
<p>PKCE 现在推荐用于所有 OAuth/OIDC 流程，不仅仅是公共客户端。它提供了针对授权码拦截的纵深防御。</p>
<h3 id="State-和-Nonce">State 和 Nonce</h3>
<p>使用 state 和 nonce 参数：</p>
<div class="admonition warning"><p class="admonition-title"><span class="mdi mdi-alert-outline admonition-icon"></span>⚠️ State 和 Nonce 参数</p><div class="admonition-content"><p><strong>State 参数</strong></p>
<ul>
<li>防止 CSRF 攻击</li>
<li>随机、不可预测的值</li>
<li>在回调时验证</li>
<li>安全必需</li>
</ul>
<p><strong>Nonce 参数</strong></p>
<ul>
<li>防止重放攻击</li>
<li>包含在 ID 令牌中</li>
<li>由客户端验证</li>
<li>将令牌绑定到会话</li>
</ul>
</div></div>
<p>这两个参数对安全至关重要。State 防止 CSRF 攻击，攻击者诱骗用户使用攻击者控制的账户进行身份验证。Nonce 防止令牌重放攻击。</p>
<h2 id="OIDC-vs-SAML">OIDC vs SAML</h2>
<p>在 OIDC 和 SAML 之间选择。</p>
<h3 id="比较">比较</h3>
<div class="admonition tip"><p class="admonition-title"><span class="mdi mdi-lightbulb-on-outline admonition-icon"></span>🎯 OIDC vs SAML 决策</p><div class="admonition-content"><p><strong>选择 SAML 当：</strong></p>
<ul>
<li>与遗留企业应用集成</li>
<li>供应商仅支持 SAML</li>
<li>现有 SAML 基础设施</li>
<li>法规要求指定 SAML</li>
</ul>
<p><strong>选择 OIDC 当：</strong></p>
<ul>
<li>构建新应用程序</li>
<li>移动应用身份验证</li>
<li>需要 API 授权</li>
<li>现代架构</li>
<li>开发者体验重要</li>
</ul>
<p><strong>技术差异</strong></p>
<ul>
<li>SAML：基于 XML，浏览器重定向</li>
<li>OIDC：基于 JSON，RESTful API</li>
<li>SAML：仅浏览器流程</li>
<li>OIDC：移动、Web、API 支持</li>
</ul>
</div></div>
<p>SAML 不会消失——太多企业应用程序依赖它。但新项目应该使用 OIDC。它更简单、更灵活，更适合现代架构。</p>
<h3 id="迁移路径">迁移路径</h3>
<p>许多组织同时运行两种协议：</p>
<div class="admonition anote"><p class="admonition-title"><span class="mdi mdi-note-outline admonition-icon"></span>🔄 SAML 到 OIDC 迁移</p><div class="admonition-content"><p><strong>混合方法</strong></p>
<ul>
<li>保留 SAML 用于遗留应用</li>
<li>新开发使用 OIDC</li>
<li>IdP 支持两种协议</li>
<li>逐步迁移</li>
</ul>
<p><strong>迁移步骤</strong></p>
<ol>
<li>部署支持 OIDC 的 IdP</li>
<li>为现有应用维护 SAML</li>
<li>使用 OIDC 构建新应用</li>
<li>在可行时迁移应用</li>
<li>最终弃用 SAML</li>
</ol>
</div></div>
<p>大多数企业 IdP 同时支持 SAML 和 OIDC。这允许逐步迁移而不会中断现有集成。</p>
<h2 id="常见错误">常见错误</h2>
<p>避免这些 OIDC 陷阱：</p>
<div class="admonition error"><p class="admonition-title"><span class="mdi mdi-alert-circle-outline admonition-icon"></span>🚫 OIDC 反模式</p><div class="admonition-content"><p><strong>不完整的令牌验证</strong></p>
<ul>
<li>跳过签名验证</li>
<li>不检查过期时间</li>
<li>忽略受众声明</li>
<li>缺少 nonce 验证</li>
</ul>
<p><strong>不安全的令牌存储</strong></p>
<ul>
<li>存储在 localStorage 中</li>
<li>长期令牌</li>
<li>无令牌轮换</li>
<li>在日志中暴露令牌</li>
</ul>
<p><strong>使用隐式流程</strong></p>
<ul>
<li>已弃用且不安全</li>
<li>使用授权码 + PKCE</li>
<li>即使对 SPA</li>
</ul>
<p><strong>从头实现</strong></p>
<ul>
<li>复杂的协议细节</li>
<li>安全漏洞</li>
<li>使用标准库</li>
</ul>
<p><strong>混淆 OAuth 和 OIDC</strong></p>
<ul>
<li>OAuth 是授权</li>
<li>OIDC 是身份验证</li>
<li>使用 OIDC 进行登录</li>
</ul>
</div></div>
<p>最常见的错误是不完整的令牌验证。每个验证步骤都防止特定的攻击。跳过任何步骤都会造成漏洞。</p>
<h2 id="结论">结论</h2>
<p>OpenID Connect 解决了 OAuth 2.0 未设计解决的身份验证问题。通过添加 ID 令牌和标准化用户信息端点，OIDC 提供了适用于 Web 应用程序、移动应用和 API 的安全、现代身份验证。</p>
<p>OIDC 的成功来自于在 OAuth 2.0 经过验证的基础上构建，同时添加了缺失的身份验证层。该协议比 SAML 更简单，比自定义实现更安全，比遗留协议更适合现代架构。</p>
<p>关键要点：</p>
<ul>
<li>OIDC 用于身份验证，OAuth 用于授权</li>
<li>对所有客户端使用带 PKCE 的授权码流程</li>
<li>始终完全验证 ID 令牌</li>
<li>使用标准库，不要从头实现</li>
<li>新项目选择 OIDC，保留 SAML 用于遗留集成</li>
<li>小心保护令牌——它们是持有者凭据</li>
<li>使用 state 和 nonce 参数以确保安全</li>
</ul>
<p>在构建现代应用程序时，OIDC 应该是你身份验证的默认选择。它提供了当今 Web、移动和 API 驱动架构所需的安全性、灵活性和开发者体验。该协议处理复杂的安全细节，让你专注于构建功能而不是身份验证基础设施。</p>
<p>无论你使用 Auth0 或 Okta 等托管提供者，还是使用 Keycloak 自托管，OIDC 都提供了跨平台和用例工作的标准化身份验证。这种标准化是 OIDC 最大的优势——一个在任何地方都能工作的协议，实施一致，具有强大的安全属性。</p>
<!-- commentbox plugin begins -->
    <div class="commentbox"></div>
    <script src="https://unpkg.com/commentbox.io/dist/commentBox.min.js"></script>
    <script>commentBox('5765834504929280-proj')</script>
    <!-- commentbox plugin ends -->
    
        </div>
        
        <footer class="article-footer">
            
    <a data-url="https://neo01.com/zh-CN/2014/11/OpenID-Connect-Modern-Authentication-Explained/" data-id="30287576" class="article-share-link"><i class="fa fa-share"></i>分享到</a>
<script>
    (function ($) {
        $('body').on('click', function() {
            $('.article-share-box.on').removeClass('on');
        }).on('click', '.article-share-link', function(e) {
            e.stopPropagation();

            var $this = $(this),
                url = $this.attr('data-url').replace("http://","https://"),
                encodedUrl = encodeURIComponent(url),
                id = 'article-share-box-' + $this.attr('data-id'),
                offset = $this.offset(),
                box;

            if ($('#' + id).length) {
                box = $('#' + id);

                if (box.hasClass('on')){
                    box.removeClass('on');
                    return;
                }
            } else {
                var html = [
                    '<div id="' + id + '" class="article-share-box">',
                        '<input class="article-share-input" value="' + url + '">',
                        '<div class="article-share-links">',
                            '<a href="https://twitter.com/intent/tweet?url=' + encodedUrl + '" class="article-share-twitter" target="_blank" title="Twitter"></a>',
                            '<a href="https://www.facebook.com/sharer.php?u=' + encodedUrl + '" class="article-share-facebook" target="_blank" title="Facebook"></a>',
                            '<a href="http://pinterest.com/pin/create/button/?url=' + encodedUrl + '" class="article-share-pinterest" target="_blank" title="Pinterest"></a>',
                        '</div>',
                    '</div>'
                ].join('');

              box = $(html);

              $('body').append(box);
            }

            $('.article-share-box.on').hide();

            box.css({
                top: offset.top + 25,
                left: offset.left
            }).addClass('on');

        }).on('click', '.article-share-box', function (e) {
            e.stopPropagation();
        }).on('click', '.article-share-box-input', function () {
            $(this).select();
        }).on('click', '.article-share-box-link', function (e) {
            e.preventDefault();
            e.stopPropagation();

            window.open(this.href, 'article-share-box-window-' + Date.now(), 'width=500,height=450');
        });
    })(jQuery);
</script>

        </footer>
    </div>
    <!--script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "BlogPosting",
        "author": {
            "@type": "Person",
            "name": "Neo Alienson"
        },
        "headline": "OpenID Connect：现代身份验证详解",
        "image": "https://neo01.com/assets/security/lock.png",
        "keywords": "Authentication OIDC Security",
        "genre": "Cybersecurity",
        "datePublished": "2014-11-11",
        "dateCreated": "2014-11-11",
        "dateModified": "2025-11-26",
        "url": "https://neo01.com//zh-CN/2014/11/OpenID-Connect-Modern-Authentication-Explained/",
        "description": "OpenID Connect 基于 OAuth 2.0 构建，为现代应用程序提供标准化的身份验证。了解 OIDC 如何统一身份验证和授权、何时使用它而不是 SAML，以及如何安全实施。",
        "wordCount": 761
    }
</script-->

</article>

                        </div>
                    </section>
                    
<aside id="sidebar">
    <a class="sidebar-toggle" title="Expand Sidebar"><i class="toggle icon"></i></a>
    <div class="sidebar-top">
        <p>关注我 :</p>
        <ul class="social-links">
                <li>
                    <a class="social-tooltip" title="stack-exchange" href="https://stackexchange.com/users/2122053/neo?tab=accounts" target="_blank" rel="noopener">
                        <i class="icon fa-brands fa-stack-exchange"></i>
                    </a>
                </li>
                <li>
                    <a class="social-tooltip" title="stack-overflow" href="https://stackoverflow.com/users/1885105/neo" target="_blank" rel="noopener">
                        <i class="icon fa-brands fa-stack-overflow"></i>
                    </a>
                </li>
                <li>
                    <a class="social-tooltip" title="github" href="https://github.com/neoalienson" target="_blank" rel="noopener">
                        <i class="icon fa-brands fa-github"></i>
                    </a>
                </li>
                <li>
                    <a class="social-tooltip" title="linkedin" href="https://linkedin.com/in/neo01" target="_blank" rel="noopener">
                        <i class="icon fa-brands fa-linkedin"></i>
                    </a>
                </li>
                <li>
                    <a class="social-tooltip" title="rss" href="/atom.xml" target="_blank" rel="noopener">
                        <i class="icon fa fa-rss"></i>
                    </a>
                </li>
        </ul>
    </div>
    <div class="widgets-container">

        
            
                
                <div class="widget-wrap widget-list">
    <h3 class="widget-title">链接</h3>
    <div class="widget">
        <ul><li><a href="/zh-CN/ai">AI 游乐场</a></li><li><a href="/zh-CN/tools">工具</a></li><li><a href="/zh-CN/games">游戏</a></li><li><a href="/zh-CN/pages/useful-information">实用信息</a></li><li><a href="/zh-CN/pages/Hexo-Blogging-Cheatsheet">Hexo 博客速查表</a></li></ul>
    </div>
</div>

                
            
                
                    <div class="widget-wrap">
        <h3 class="widget-title">系列文章</h3>
        <div class="widget-series">
            <ul>
<li>🔐 <strong>Authentication Series</strong>
<ul>
<li><a href="/2010/01/Evolution-of-Single-Sign-On-From-Kerberos-to-OIDC/">The Evolution of Single Sign-On</a></li>
<li><a href="/2010/02/Understanding-SAML-Enterprise-Federation-Explained/">Understanding SAML</a></li>
<li><a href="/2010/03/Understanding-Kerberos-Network-Authentication-Explained/">Understanding Kerberos</a></li>
<li><a href="/2014/11/OpenID-Connect-Modern-Authentication-Explained/">OpenID Connect</a></li>
<li><a href="/2020/12/OAuth-2.0-Security-Best-Practices-From-Design-to-Implementation/">OAuth 2.0 Security Best Practices</a></li>
<li><a href="/2021/12/Identity-Broker-Patterns/" class="active">Identity Broker</a></li>
</ul>
</li>
</ul>

        </div>
    </div>

                
            
                
                    <div class="widget-wrap">
        <h3 class="widget-title">最新文章</h3>
        <div class="widget">
            <ul id="recent-post" class="">
                    <li>
                        <div class="item-thumbnail">
                            <a href="/zh-CN/2025/11/Mock-Servers-Accelerating-Development-Through-Simulation/" class="thumbnail">
        <span style="background-image:url(/assets/futuristic/mesh.png)" alt="Mock 服务器：通过模拟加速开发" class="thumbnail-image"></span>
</a>
                        </div>
                        <div class="item-inner">
                            <p class="item-category"><a class="article-category-link" style="cursor: default; pointer-events: none;">开发</a></p>
                            <p class="item-title"><a href="/zh-CN/2025/11/Mock-Servers-Accelerating-Development-Through-Simulation/" class="title">Mock 服务器：通过模拟加速开发</a></p>
                            <p class="item-date"><time datetime="2025-10-31T16:00:00.000Z" itemprop="datePublished">2025-11-01</time></p>
                        </div>
                    </li>
                    <li>
                        <div class="item-thumbnail">
                            <a href="/zh-CN/2025/10/Enabling-i18n-in-Hexo/" class="thumbnail">
        <span style="background-image:url(/assets/hexo/thumbnail.png)" alt="在 Hexo 中启用 i18n：多语言博客完整指南" class="thumbnail-image"></span>
</a>
                        </div>
                        <div class="item-inner">
                            <p class="item-category"><a class="article-category-link" style="cursor: default; pointer-events: none;">开发</a></p>
                            <p class="item-title"><a href="/zh-CN/2025/10/Enabling-i18n-in-Hexo/" class="title">在 Hexo 中启用 i18n：多语言博客完整指南</a></p>
                            <p class="item-date"><time datetime="2025-10-29T16:00:00.000Z" itemprop="datePublished">2025-10-30</time></p>
                        </div>
                    </li>
                    <li>
                        <div class="item-thumbnail">
                            <a href="/zh-CN/2025/10/CISP-Advanced-Security-Topics/" class="thumbnail">
        <span style="background-image:url(/assets/cisp/thumbnail_80.png)" alt="CISP学习指南：高级安全主题" class="thumbnail-image"></span>
</a>
                        </div>
                        <div class="item-inner">
                            <p class="item-category"><a class="article-category-link" style="cursor: default; pointer-events: none;">网络安全</a></p>
                            <p class="item-title"><a href="/zh-CN/2025/10/CISP-Advanced-Security-Topics/" class="title">CISP学习指南：高级安全主题</a></p>
                            <p class="item-date"><time datetime="2025-10-22T16:00:00.000Z" itemprop="datePublished">2025-10-23</time></p>
                        </div>
                    </li>
                    <li>
                        <div class="item-thumbnail">
                            <a href="/zh-CN/2025/10/CISP-Email-Security/" class="thumbnail">
        <span style="background-image:url(/assets/cisp/thumbnail_80.png)" alt="CISP学习指南：电子邮件安全与网络协议" class="thumbnail-image"></span>
</a>
                        </div>
                        <div class="item-inner">
                            <p class="item-category"><a class="article-category-link" style="cursor: default; pointer-events: none;">网络安全</a></p>
                            <p class="item-title"><a href="/zh-CN/2025/10/CISP-Email-Security/" class="title">CISP学习指南：电子邮件安全与网络协议</a></p>
                            <p class="item-date"><time datetime="2025-10-22T16:00:00.000Z" itemprop="datePublished">2025-10-23</time></p>
                        </div>
                    </li>
                    <li>
                        <div class="item-thumbnail">
                            <a href="/zh-CN/2025/10/CISP-Access-Control-Audit-WAPI/" class="thumbnail">
        <span style="background-image:url(/assets/cisp/thumbnail_80.png)" alt="CISP学习指南：访问控制机制、蜜网、审计系统与WAPI" class="thumbnail-image"></span>
</a>
                        </div>
                        <div class="item-inner">
                            <p class="item-category"><a class="article-category-link" style="cursor: default; pointer-events: none;">网络安全</a></p>
                            <p class="item-title"><a href="/zh-CN/2025/10/CISP-Access-Control-Audit-WAPI/" class="title">CISP学习指南：访问控制机制、蜜网、审计系统与WAPI</a></p>
                            <p class="item-date"><time datetime="2025-10-21T16:00:00.000Z" itemprop="datePublished">2025-10-22</time></p>
                        </div>
                    </li>
            </ul>
        </div>
    </div>

                
            
                
                
    
    
    <div class="widget-wrap widget-list">
        <h3 class="widget-title">归档</h3>
        <div class="widget">
            <ul class="archive-list">
            
                <li class="archive-list-item">
                    <a class="archive-list-link" href="/zh-CN/archives/2025/">2025</a>
                    <span class="archive-list-count">75</span>
                </li>
            
                <li class="archive-list-item">
                    <a class="archive-list-link" href="/zh-CN/archives/2024/">2024</a>
                    <span class="archive-list-count">25</span>
                </li>
            
                <li class="archive-list-item">
                    <a class="archive-list-link" href="/zh-CN/archives/2023/">2023</a>
                    <span class="archive-list-count">16</span>
                </li>
            
                <li class="archive-list-item">
                    <a class="archive-list-link" href="/zh-CN/archives/2022/">2022</a>
                    <span class="archive-list-count">17</span>
                </li>
            
                <li class="archive-list-item">
                    <a class="archive-list-link" href="/zh-CN/archives/2021/">2021</a>
                    <span class="archive-list-count">14</span>
                </li>
            
                <li class="archive-list-item">
                    <a class="archive-list-link" href="/zh-CN/archives/2020/">2020</a>
                    <span class="archive-list-count">13</span>
                </li>
            
                <li class="archive-list-item">
                    <a class="archive-list-link" href="/zh-CN/archives/2019/">2019</a>
                    <span class="archive-list-count">12</span>
                </li>
            
                <li class="archive-list-item">
                    <a class="archive-list-link" href="/zh-CN/archives/2018/">2018</a>
                    <span class="archive-list-count">3</span>
                </li>
            
                <li class="archive-list-item">
                    <a class="archive-list-link" href="/zh-CN/archives/2017/">2017</a>
                    <span class="archive-list-count">6</span>
                </li>
            
                <li class="archive-list-item">
                    <a class="archive-list-link" href="/zh-CN/archives/2016/">2016</a>
                    <span class="archive-list-count">5</span>
                </li>
            
                <li class="archive-list-item">
                    <a class="archive-list-link" href="/zh-CN/archives/2015/">2015</a>
                    <span class="archive-list-count">6</span>
                </li>
            
                <li class="archive-list-item">
                    <a class="archive-list-link" href="/zh-CN/archives/2014/">2014</a>
                    <span class="archive-list-count">10</span>
                </li>
            
                <li class="archive-list-item">
                    <a class="archive-list-link" href="/zh-CN/archives/2013/">2013</a>
                    <span class="archive-list-count">3</span>
                </li>
            
                <li class="archive-list-item">
                    <a class="archive-list-link" href="/zh-CN/archives/2010/">2010</a>
                    <span class="archive-list-count">3</span>
                </li>
            
                <li class="archive-list-item">
                    <a class="archive-list-link" href="/zh-CN/archives/2007/">2007</a>
                    <span class="archive-list-count">1</span>
                </li>
            
                <li class="archive-list-item">
                    <a class="archive-list-link" href="/zh-CN/archives/2006/">2006</a>
                    <span class="archive-list-count">1</span>
                </li>
            
                <li class="archive-list-item">
                    <a class="archive-list-link" href="/zh-CN/archives/2003/">2003</a>
                    <span class="archive-list-count">1</span>
                </li>
            
                <li class="archive-list-item">
                    <a class="archive-list-link" href="/zh-CN/archives/2002/">2002</a>
                    <span class="archive-list-count">1</span>
                </li>
            
                <li class="archive-list-item">
                    <a class="archive-list-link" href="/zh-CN/archives/2001/">2001</a>
                    <span class="archive-list-count">1</span>
                </li>
            
            </ul>
        </div>
    </div>


                
            
        

    </div>
</aside>


                </div>
            </div>
        </div>
        
<footer id="footer">
    <div class="container">
        <div class="container-inner">
            <a id="back-to-top" href="javascript:;"><i class="icon fa fa-angle-up"></i></a>

            <div class="qrcode-share-wrapper">
                <div class="qrcode-text">https://neo01.com/l#d621a0ea</div>
                <img src="/qr/qr-61a0be0c30f4e79f264d60fdd97f0b75.svg" width="200" height="200" alt="QR Code for https://neo01.com/l#d621a0ea">
            </div>
            <div class="credit">
                <h1 class="logo-wrap">
                    <a href="/" title="Homepage" class="logo"></a>
                </h1>
                
                <p>© 2025 Neo Alienson. 版权所有.
                  <a href="/zh-CN/terms-and-conditions">使用条款</a></p>
                
            </div>
            <div class="footer-plugins">
              


            </div>
        </div>
    </div>
</footer>

        
        
    
        


        


        


        


        


        


        


        


        


    



<!-- Custom Scripts -->




        
    </div>
<!-- hexo injector body_end start --><script type="text/javascript" src="/js/bundle_last.js"></script><!-- hexo injector body_end end -->

<script>CookieConsent.run({"palette":{"popup":{"background":"#000"},"button":{"background":"#f1d600"}},"guiOptions":{"consentModal":{"layout":"box","position":"bottom right","equalWeightButtons":true,"flipButtons":false},"preferencesModal":{"layout":"box","position":"right","equalWeightButtons":false,"flipButtons":false}},"categories":{"necessary":{"readOnly":true},"functionality":{},"analytics":{}},"language":{"default":"en","autoDetect":"browser","translations":{"en":{"consentModal":{"title":"Hello traveler, it's cookie time!","description":"🍪 This site uses cookies to serve you the best experience—no crumbs left behind! Want to know what cookies really are? Check out this easy-to-understand cookie explanation. And for the legal nitty-gritty, here’s our website cookie policy to keep you in the loop! 🚀\n","acceptAllBtn":"Accept all","acceptNecessaryBtn":"Reject all","showPreferencesBtn":"Manage preferences","footer":"<a href=\"#link\">Privacy Policy</a>\n<a href=\"/terms-and-conditions/\">Terms and conditions</a>\n"},"preferencesModal":{"title":"Consent Preferences Center","acceptAllBtn":"Accept all","acceptNecessaryBtn":"Reject all","savePreferencesBtn":"Save preferences","closeIconLabel":"Close modal","serviceCounterLabel":"Service|Services","sections":[{"title":"Cookie Usage","description":"We use cookies to make your visit smoother, faster, and tailored just for you. Cookies help us remember your preferences, improve site performance, and deliver personalized content while keeping things secure and user-friendly.\n"},{"title":"Strictly Necessary Cookies <span class=\"pm__badge\">Always Enabled</span>","description":"These cookies are essential for the website to function properly. They enable core features like security, page navigation, and access to secure areas. Without these, the site cannot operate correctly.\n","linkedCategory":"necessary"},{"title":"Functionality Cookies","description":"Functionality cookies remember your choices to provide a more personalized experience. For example, they save your language preference or login details so you don’t have to keep entering them each time.\n","linkedCategory":"functionality"},{"title":"Analytics Cookies","description":"Analytics cookies help us understand how visitors interact with our site by collecting information anonymously. This insight allows us to improve functionality, fix issues, and make the website better for you.\n","linkedCategory":"analytics"},{"title":"More information","description":"Please refer to our <a href='/pages/cookie-policy'>cookie policy</a> for full details on how we use cookies and your options to manage them.\n"}]}}}}})</script></body></html>