<!DOCTYPE html><html lang="zh-CN"><head><!-- hexo injector head_begin start --><!-- Google tag (gtag.js) begins-->
    <script async="" src="https://www.googletagmanager.com/gtag/js?id=G-3DZR3TQYCY"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
    
      gtag('config', 'G-3DZR3TQYCY');
    </script>
    <!-- Google tag (gtag.js) ends-->
    <!-- hexo injector head_begin end -->
    <meta charset="utf-8">
    <!-- security headers starts -->
    <!-- meta http-equiv="content-security-policy" content="script-src 'sha256-B5nfCL2Dym3Ba4YJFI7wB3f4vtClbrYJZ32A5erBEdg=' 'sha256-lJjk3/dvd+wXqRFjV7T5L/nXJXr5NjUjmsKSPEe+ass=';" -->
    <!-- security headers ends -->
    <!-- favicon starts -->    
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <!-- favicon ends -->
    

    <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="alternate" href="/atom.xml" title="Decoding Digital Anomalies" type="application/atom+xml">
    

    

    

    

    

    

    

    
    
        


    
    
        


    



    
    <title>DNS over HTTPS：保护互联网的基础设施 | Decoding Digital Anomalies</title>
    
    <meta name="keywords" content="DNS,Networking,Privacy,Security">
    
    
    <meta name="description" content="探索 DNS over HTTPS (DoH) 如何通过加密 DNS 查询来改变互联网隐私，防止监控和操纵，同时重塑安全与网络控制之间的平衡。">
<meta property="og:type" content="article">
<meta property="og:title" content="DNS over HTTPS：保护互联网的基础设施">
<meta property="og:url" content="https://neo01.com/zh-CN/2025/04/DNS-over-HTTPS-Securing-Internet-Foundation/index.html">
<meta property="og:site_name" content="Decoding Digital Anomalies">
<meta property="og:description" content="探索 DNS over HTTPS (DoH) 如何通过加密 DNS 查询来改变互联网隐私，防止监控和操纵，同时重塑安全与网络控制之间的平衡。">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://neo01.com/assets/futuristic/mesh.png">
<meta property="article:published_time" content="2025-04-01T16:00:00.000Z">
<meta property="article:modified_time" content="2025-11-01T10:19:22.947Z">
<meta property="article:author" content="Neo Alienson">
<meta property="article:tag" content="DNS">
<meta property="article:tag" content="Networking">
<meta property="article:tag" content="Privacy">
<meta property="article:tag" content="Security">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://neo01.com/assets/futuristic/mesh.png">
    
    <!-- hexo injector head_end start --><link rel="stylesheet" type="text/css" href="/css/bundle.css"><script type="text/javascript" src="/js/bundle_first.js"></script><!-- hexo injector head_end end --><meta name="generator" content="Hexo 8.1.0">  <link rel="canonical" href="https://neo01.com/zh-CN/2025/04/DNS-over-HTTPS-Securing-Internet-Foundation/">
  <link rel="alternate" hreflang="en" data-canonical="true" href="https://neo01.com/2025/04/DNS-over-HTTPS-Securing-Internet-Foundation/">
  <link rel="alternate" hreflang="zh-TW" href="https://neo01.com/zh-TW/2025/04/DNS-over-HTTPS-Securing-Internet-Foundation/">
  <link rel="alternate" hreflang="zh-CN" href="https://neo01.com/zh-CN/2025/04/DNS-over-HTTPS-Securing-Internet-Foundation/">
  <link rel="alternate" hreflang="ja" href="https://neo01.com/ja/2025/04/DNS-over-HTTPS-Securing-Internet-Foundation/">
<style id="admonition-styles">.admonition {
  margin: 1em 0;
  padding: 0rem;
  border-left: 0.3rem solid;
  border-radius: 0.4rem;
  background-color: #f9f9f9;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.04);
  overflow: hidden;
  page-break-inside: avoid;
}

.admonition-title {
  display: flex;
  align-items: center;
  font-weight: 600;
  padding: 0rem 1rem 0.1rem 0.75rem;
  font-size: 1.05em;
  background-color: rgba(0, 0, 0, 0.03);
  border-top-left-radius: 0.4rem;
  border-top-right-radius: 0.4rem;
  margin: 0 !important;
}

.admonition-icon {
  font-size: 1.2em;
  margin-right: 0.6rem;
  opacity: 0.85;
  margin-top: 0.1rem;
}

/* 内容区域 margin */
.admonition > *:not(.admonition-title) {
  margin: 0.6rem 1rem 0.6rem 1rem;
}

/* NOTE 类型 */
.admonition.anote {
  border-color: #448aff;
}
.admonition.anote > .admonition-title {
  background-color: #448aff1a;
  color: #2962ff;
}

/* INFO / TODO 类型 */
.admonition.info,
.admonition.todo {
  border-color: #00b8d4;
}
.admonition.info > .admonition-title,
.admonition.todo > .admonition-title {
  background-color: rgba(0, 184, 212, 0.1);
  color: #007c91;
}

/* 警告类 */
.admonition.warning,
.admonition.attention,
.admonition.caution {
  border-color: #ff9100;
}
.admonition.warning > .admonition-title,
.admonition.attention > .admonition-title,
.admonition.caution > .admonition-title {
  background-color: rgba(255, 145, 0, 0.1);
  color: #c66900;
}

/* 错误类 */
.admonition.failure,
.admonition.missing,
.admonition.fail,
.admonition.error,
.admonition.danger,
.admonition.bug {
  border-color: #ff5252;
}
.admonition.failure > .admonition-title,
.admonition.missing > .admonition-title,
.admonition.fail > .admonition-title,
.admonition.error > .admonition-title,
.admonition.danger > .admonition-title,
.admonition.bug > .admonition-title {
  background-color: rgba(255, 82, 82, 0.1);
  color: #b71c1c;
}

/* TIP 类型 */
.admonition.tip {
  border-color: #00bfa5;
}
.admonition.tip > .admonition-title {
  background-color: #00bfa51a;
  color: #00796b;
}

/* SUCCESS 类型 */
.admonition.success {
  border-color: #00c853;
}
.admonition.success > .admonition-title {
  background-color: #00c8531a;
  color: #2e7d32;
}

/* QUESTION 类型 */
.admonition.question {
  border-color: #64dd17;
}
.admonition.question > .admonition-title {
  background-color: #64dd171a;
  color: #558b2f;
}

/* EXAMPLE 类型 */
.admonition.example {
  border-color: #7c4dff;
}
.admonition.example > .admonition-title {
  background-color: #7c4dff1a;
  color: #512da8;
}

/* QUOTE 类型 */
.admonition.quote {
  border-color: #9e9e9e;
}
.admonition.quote > .admonition-title {
  background-color: #9e9e9e1a;
  color: #424242;
}

/*黑暗模式*/
/* 夜间模式基础样式 */
[data-theme="dark"] .admonition {
  background-color: #1e1e1e;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.4);
}

[data-theme="dark"] .admonition-title {
  background-color: rgba(255, 255, 255, 0.05);
}

/* anote */
[data-theme="dark"] .admonition.anote {
  border-color: #82b1ff;
}
[data-theme="dark"] .admonition.anote > .admonition-title {
  background-color: #82b1ff1a;
  color: #bbdefb;
}

/* tip */
[data-theme="dark"] .admonition.tip {
  border-color: #64ffda;
}
[data-theme="dark"] .admonition.tip > .admonition-title {
  background-color: #64ffda1a;
  color: #1de9b6;
}

/* success */
[data-theme="dark"] .admonition.success {
  border-color: #69f0ae;
}
[data-theme="dark"] .admonition.success > .admonition-title {
  background-color: #69f0ae1a;
  color: #00e676;
}

/* question */
[data-theme="dark"] .admonition.question {
  border-color: #b2ff59;
}
[data-theme="dark"] .admonition.question > .admonition-title {
  background-color: #b2ff591a;
  color: #aeea00;
}

/* example */
[data-theme="dark"] .admonition.example {
  border-color: #b388ff;
}
[data-theme="dark"] .admonition.example > .admonition-title {
  background-color: #b388ff1a;
  color: #b39ddb;
}

/* quote */
[data-theme="dark"] .admonition.quote {
  border-color: #bdbdbd;
}
[data-theme="dark"] .admonition.quote > .admonition-title {
  background-color: #bdbdbd1a;
  color: #eeeeee;
}

/* warning / attention / caution */
[data-theme="dark"] .admonition.warning,
[data-theme="dark"] .admonition.attention,
[data-theme="dark"] .admonition.caution {
  border-color: #ffb300;
}
[data-theme="dark"] .admonition.warning > .admonition-title,
[data-theme="dark"] .admonition.attention > .admonition-title,
[data-theme="dark"] .admonition.caution > .admonition-title {
  background-color: #ffb3001a;
  color: #ffe082;
}

/* error / fail / failure / bug / danger / missing */
[data-theme="dark"] .admonition.error,
[data-theme="dark"] .admonition.fail,
[data-theme="dark"] .admonition.failure,
[data-theme="dark"] .admonition.bug,
[data-theme="dark"] .admonition.missing,
[data-theme="dark"] .admonition.danger {
  border-color: #ef5350;
}
[data-theme="dark"] .admonition.error > .admonition-title,
[data-theme="dark"] .admonition.fail > .admonition-title,
[data-theme="dark"] .admonition.failure > .admonition-title,
[data-theme="dark"] .admonition.bug > .admonition-title,
[data-theme="dark"] .admonition.missing > .admonition-title,
[data-theme="dark"] .admonition.danger > .admonition-title {
  background-color: #ef53501a;
  color: #ff8a80;
}</style><script id="mermaid-scripts" src="/cache/mermaid.min.local.js"></script>
<script>mermaid.initialize({theme: 'default'});</script></head>

<body>
    <div id="wrap">
        
        
<header id="header">
    <div id="header-outer" class="outer">
        <div class="container">
            <div class="container-inner">
                <div id="header-title">
                    <h1 class="logo-wrap">
                        <div class="logo"></div>
                    </h1>

                        <h2 class="subtitle-wrap">
                            <p class="title">解码数字异常</p>
                          <p class="subtitle">有时功能就是数字兔子洞中的错误，反之亦然</p>
                        </h2>




                    <div id="lang-selector">
                        <span class="lang-icon">🌐</span>
                        
                            <a href="#" class="lang-link" data-lang="en">English</a>
<span class="lang-sep">|</span>                            <a href="#" class="lang-link" data-lang="zh-TW">繁體中文</a>
<span class="lang-sep">|</span>                            <a href="#" class="lang-link" data-lang="ja">日本語</a>
                        <script>
                        document.addEventListener('DOMContentLoaded', function() {
                            var currentLang = 'zh-CN';
                            var currentPath = window.location.pathname;
                            var basePath;
                            
                            if (currentLang === 'en') {
                                basePath = currentPath;
                            } else {
                                basePath = currentPath.replace(new RegExp('^/' + currentLang + '/'), '/');
                            }
                            
                            document.querySelectorAll('.lang-link').forEach(function(link) {
                                var targetLang = link.getAttribute('data-lang');
                                var targetPath;
                                if (targetLang === 'en') {
                                    targetPath = basePath;
                                } else {
                                    targetPath = '/' + targetLang + basePath;
                                }
                                link.href = targetPath;
                            });
                        });
                        </script>
                    </div>


                </div>
                <div id="header-inner" class="nav-container">
                    <a id="main-nav-toggle" class="nav-icon fa fa-bars"></a>
                    <div class="nav-container-inner">
                        <ul id="main-nav">
                            
                                <li class="main-nav-list-item">
                                    <a class="main-nav-list-link" href="/zh-CN/">主页</a>
                                </li>
                                                                    <ul class="main-nav-list"><li class="main-nav-list-item"><a class="main-nav-list-link" href="/zh-CN/categories/AI/">人工智能</a><ul class="main-nav-list-child"><li class="main-nav-list-item"><a class="main-nav-list-link" href="/zh-CN/categories/AI/Art-Gallery/">艺术画廊</a></li></ul></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/zh-CN/categories/Architecture/">架构</a></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/zh-CN/categories/Cybersecurity/">网络安全</a></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/zh-CN/categories/Development/">开发</a></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/zh-CN/categories/Misc/">杂项</a></li></ul>
                                <li class="main-nav-list-item">
                                    <a class="main-nav-list-link" href="/zh-CN/about-me">关于</a>
                                </li>
                            
                        </ul>
                        <nav id="sub-nav">
                            <div id="search-form-wrap">

    <form class="search-form">
        <input type="text" class="ins-search-input search-form-input" id="search-form-input" placeholder="搜索">
        <button type="submit" title="搜索" class="search-form-submit"></button>
    </form>
    <div class="ins-search">
    <div class="ins-search-mask"></div>
    <div class="ins-search-container">
        <div class="ins-input-wrapper">
            <input type="text" class="ins-search-input" id="ins-search-input" placeholder="想要查找什么...">
            <span class="ins-close ins-selectable"><i class="fa fa-times-circle"></i></span>
        </div>
        <div class="ins-section-wrapper">
            <div class="ins-section-container"></div>
        </div>
    </div>
</div>
<script integrity="sha256-B5nfCL2Dym3Ba4YJFI7wB3f4vtClbrYJZ32A5erBEdg=">
(function (window) {
    var INSIGHT_CONFIG = {
        TRANSLATION: {
            POSTS: '文章',
            PAGES: '页面',
            CATEGORIES: '分类',
            TAGS: '标签',
            UNTITLED: '(未命名)',
        },
        ROOT_URL: '/',
        CONTENT_URL: '/content.json',
        LANG: 'zh-CN',
    };
    window.INSIGHT_CONFIG = INSIGHT_CONFIG;
})(window);
</script>




</div>
                        </nav>
                    </div>
                </div>
            </div>
        </div>
    </div>
</header>

        
        <div class="container">
            <div class="main-body container-inner">
                <div class="main-body-inner">
                    <section id="main">
                        <div class="main-body-header">
    <h1 class="header">
    
    <a class="page-title-link" href="/categories/Cybersecurity/">Cybersecurity</a>
    </h1>
</div>

                        <div class="main-body-content">
                            <article id="post-2025/04/DNS-over-HTTPS-Securing-Internet-Foundation-zh-CN" class="article article-single article-type-post" itemscope="" itemprop="blogPost">
    <div class="article-inner responsive-content">
        
            <header class="article-header">
                
    
        <h1 class="article-title" itemprop="name">
        DNS over HTTPS：保护互联网的基础设施
        </h1>
    

            </header>
        
        
            <div class="article-meta">
                
    <div class="article-date">
      <i class="fa fa-calendar"></i>
        
          Created <time datetime="2025-04-01T16:00:00.000Z" itemprop="datePublished">2025-04-02</time>
          &nbsp;<i class="fa fa-calendar"></i>
          Updated <time datetime="2025-11-01T10:19:22.947Z" itemprop="datePublished">2025-11-01</time>
        
    </div>


                

                
    <div class="article-tag">
        <i class="fa fa-tag"></i>
        <a class="tag-link" href="/zh-CN/tags/Security/">Security</a> <a class="tag-link" href="/zh-CN/tags/Networking/">Networking</a> <a class="tag-link" href="/zh-CN/tags/Privacy/">Privacy</a> <a class="tag-link" href="/zh-CN/tags/DNS/">DNS</a>
    </div>

            </div>
        
        
        
        <div class="article-entry" itemprop="articleBody">
            <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BC%95%E8%A8%80"><span class="toc-text">引言</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%90%86%E8%A7%A3-DNS%EF%BC%9A%E4%BA%92%E8%81%94%E7%BD%91%E7%9A%84%E5%9C%B0%E5%9D%80%E7%B0%BF"><span class="toc-text">理解 DNS：互联网的地址簿</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#DNS-over-HTTPS-%E7%9A%84%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86"><span class="toc-text">DNS over HTTPS 的工作原理</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A9%B1%E5%8A%A8%E5%9B%A0%E7%B4%A0%EF%BC%9ADoH-%E5%87%BA%E7%8E%B0%E7%9A%84%E5%8E%9F%E5%9B%A0"><span class="toc-text">驱动因素：DoH 出现的原因</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BC%98%E5%8A%BF%EF%BC%9ADoH-%E9%87%87%E7%94%A8%E7%9A%84%E7%90%86%E7%94%B1"><span class="toc-text">优势：DoH 采用的理由</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8C%91%E6%88%98%E5%92%8C%E4%BA%89%E8%AE%AE"><span class="toc-text">挑战和争议</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%9E%E6%96%BD%E6%96%B9%E6%B3%95"><span class="toc-text">实施方法</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%8E%B0%E5%AE%9E%E4%B8%96%E7%95%8C%E7%9A%84%E9%87%87%E7%94%A8%E5%92%8C%E5%BD%B1%E5%93%8D"><span class="toc-text">现实世界的采用和影响</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9C%AA%E6%9D%A5%E6%96%B9%E5%90%91"><span class="toc-text">未来方向</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BB%93%E8%AE%BA"><span class="toc-text">结论</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%B2%E8%87%AA%E5%B0%9D%E8%AF%95"><span class="toc-text">亲自尝试</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99%E5%92%8C%E8%B5%84%E6%BA%90"><span class="toc-text">参考资料和资源</span></a></li></ol>
            <h2 id="引言">引言</h2>
<p>每次你在浏览器中输入网站地址时，在任何内容加载之前都会发生一次隐形的对话。你的设备会询问互联网："我在哪里可以找到这个网站？"这个问题及其答案传统上都是以明文形式发送的，任何监控你网络的人都能看到。这就像在乘坐私人出租车之前，在拥挤的房间里大声喊出你的目的地。</p>
<p>DNS over HTTPS (DoH) 从根本上改变了这种动态，它加密这些查询，将它们包装在保护你的密码和信用卡信息的相同安全协议中。最初作为隐私增强功能出现的技术，已经演变成一项有争议的技术，它挑战了数十年的网络管理实践，引发了关于中心化的问题，并迫使我们重新考虑隐私与控制之间的平衡。</p>
<p>本文将探讨 DoH 的工作原理、出现的原因、带来的好处，以及它给互联网生态系统带来的复杂挑战。</p>
<h2 id="理解-DNS：互联网的地址簿">理解 DNS：互联网的地址簿</h2>
<p>在深入了解 DoH 之前，我们需要理解它在保护什么。域名系统（DNS）是互联网的基础协议之一，它将人类可读的域名（如"<a target="_blank" rel="noopener" href="http://example.com">example.com</a>"）转换为计算机用于通信的 IP 地址（如"93.184.216.34"）。</p>
<p>传统 DNS 通过 UDP 端口 53（或 TCP 用于较大响应）运行，以明文形式发送查询和响应。当你访问网站时，你的设备会向解析器发送 DNS 查询——通常由你的 ISP 或像 Google DNS 或 Cloudflare 这样的公共服务提供。解析器要么返回缓存的答案，要么查询权威 DNS 服务器以找到正确的 IP 地址。</p>
<div class="admonition anote"><p class="admonition-title"><span class="mdi mdi-note-outline admonition-icon"></span>🔍 传统 DNS 流程</p><div class="admonition-content"><ol>
<li><strong>用户输入 URL</strong>：浏览器需要域名的 IP 地址</li>
<li><strong>发送查询</strong>：设备向配置的解析器发送 DNS 查询（端口 53，明文）</li>
<li><strong>解析器搜索</strong>：检查缓存或查询权威服务器</li>
<li><strong>返回响应</strong>：IP 地址返回给设备（明文）</li>
<li><strong>建立连接</strong>：浏览器连接到 IP 地址</li>
</ol>
<p>这个过程的每一步都对网络观察者可见。</p>
</div></div>
<h3 id="隐私问题">隐私问题</h3>
<p>传统 DNS 缺乏加密会造成几个隐私和安全漏洞：</p>
<ul>
<li><strong>监控</strong>：ISP、政府和网络运营商可以看到你查询的每个域名</li>
<li><strong>操纵</strong>：攻击者可以拦截和修改 DNS 响应（DNS 欺骗）</li>
<li><strong>审查</strong>：网络运营商可以通过过滤 DNS 查询来阻止访问</li>
<li><strong>跟踪</strong>：即使网站使用 HTTPS，DNS 查询也会暴露浏览模式</li>
<li><strong>数据泄露</strong>：DNS 查询暴露有关内部网络结构的信息</li>
</ul>
<p>虽然 HTTPS 加密了你的网页浏览内容，但 DNS 查询仍然可见，造成了重大的隐私缺口。观察者无法看到你在网站上做什么，但他们确切地知道你正在访问哪些网站。</p>
<h2 id="DNS-over-HTTPS-的工作原理">DNS over HTTPS 的工作原理</h2>
<p>DNS over HTTPS 通过将 DNS 查询隧道化到 HTTPS 连接中来解决这些漏洞，这与保护网络流量的加密协议相同。这个看似简单的改变对隐私和网络架构有着深远的影响。</p>
<h3 id="技术架构">技术架构</h3>
<p>DoH 将 DNS 查询封装在 HTTPS 请求中，通常使用 HTTP/2 或 HTTP/3 以提高效率。DoH 客户端不是向端口 53 发送查询，而是向 DoH 服务器的端点（通常是端口 443）发送 HTTPS POST 或 GET 请求。</p>
<div class="admonition anote"><p class="admonition-title"><span class="mdi mdi-note-outline admonition-icon"></span>🔐 DoH 请求流程</p><div class="admonition-content"><p><strong>传统 DNS 查询：</strong>
</p><pre class="language-none"><code class="language-none">客户端 → DNS 解析器（端口 53，UDP/TCP）<p></p>
</code></pre></div></div><code class="language-none">

查询："example.com 的 IP 是什么？"
响应："93.184.216.34"（网络可见所有内容）</code>
<pre><code>**DoH 查询：**
<pre class="language-none"><code class="language-none">客户端 → DoH 服务器（端口 443，HTTPS）
包含 DNS 查询的加密 POST 请求
包含 IP 地址的加密响应
（网络只能看到加密的 HTTPS 流量）</code></pre>
</code></pre>
<h3 id="协议规范">协议规范</h3>
<p>DoH 在 RFC 8484 中标准化，定义了如何在 HTTP 请求和响应中编码 DNS 查询。该协议支持两种方法：</p>
<p><strong>POST 方法：</strong></p>
<ul>
<li>DNS 查询编码在请求体中</li>
<li>Content-Type：<code>application/dns-message</code></li>
<li>二进制 DNS 消息格式</li>
<li>首选隐私保护（查询不在 URL 中）</li>
</ul>
<p><strong>GET 方法：</strong></p>
<ul>
<li>DNS 查询编码在 URL 参数中</li>
<li>查询参数：<code>?dns=&lt;base64url-encoded-query&gt;</code></li>
<li>可能被 HTTP 中间件缓存</li>
<li>适用于简单查询</li>
</ul>
<div class="admonition tip"><p class="admonition-title"><span class="mdi mdi-lightbulb-on-outline admonition-icon"></span>💡 线路格式兼容性</p><div class="admonition-content"><p>DoH 使用与传统 DNS 相同的二进制 DNS 消息格式，这使得现有 DNS 软件可以通过添加 HTTPS 包装器轻松支持 DoH。DNS 协议本身没有改变——只有传输机制改变了。</p>
</div></div>
<h3 id="DoH-与-DNS-over-TLS-DoT-的对比">DoH 与 DNS over TLS (DoT) 的对比</h3>
<p>DoH 不是唯一的加密 DNS 协议。DNS over TLS (DoT) 在 RFC 7858 中标准化，也加密 DNS 查询，但使用专用端口（853）和直接的 TLS 而不是 HTTPS。</p>
<table>
<thead>
<tr>
<th>特性</th>
<th>DoH（端口 443）</th>
<th>DoT（端口 853）</th>
<th>传统 DNS（端口 53）</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>加密</strong></td>
<td>是（HTTPS）</td>
<td>是（TLS）</td>
<td>否</td>
</tr>
<tr>
<td><strong>端口</strong></td>
<td>443（HTTPS）</td>
<td>853（专用）</td>
<td>53（UDP/TCP）</td>
</tr>
<tr>
<td><strong>可见性</strong></td>
<td>看起来像网络流量</td>
<td>清楚可识别</td>
<td>清楚可识别</td>
</tr>
<tr>
<td><strong>阻止</strong></td>
<td>困难（阻止所有 HTTPS）</td>
<td>容易（阻止端口 853）</td>
<td>容易（阻止端口 53）</td>
</tr>
<tr>
<td><strong>网络控制</strong></td>
<td>有限</td>
<td>可能</td>
<td>完全</td>
</tr>
<tr>
<td><strong>缓存</strong></td>
<td>可能 HTTP 缓存</td>
<td>无 HTTP 缓存</td>
<td>仅 DNS 缓存</td>
</tr>
</tbody>
</table>
<p>关键区别：DoH 流量与常规 HTTPS 网络流量无法区分，使得在不阻止所有 HTTPS 的情况下几乎不可能阻止它。DoT 使用专用端口，使其易于识别和控制。</p>
<h2 id="驱动因素：DoH-出现的原因">驱动因素：DoH 出现的原因</h2>
<p>推动加密 DNS 的努力并非凭空发生。几个汇聚的因素创造了对 DoH 采用的需求和动力。</p>
<h3 id="隐私担忧和监控">隐私担忧和监控</h3>
<p>2013 年斯诺登的揭露暴露了大规模监控计划的范围，包括 DNS 查询监控。这引发了科技行业更广泛的隐私运动，导致 HTTPS 的广泛采用。然而，DNS 仍然是一个未加密的弱点，削弱了 HTTPS 带来的隐私收益。</p>
<p>隐私倡导者认为，DNS 查询揭示了有关用户兴趣、健康问题、政治观点和个人关系的敏感信息。即使 HTTPS 保护网站内容，DNS 查询也会创建详细的在线行为地图。</p>
<div class="admonition warning"><p class="admonition-title"><span class="mdi mdi-alert-outline admonition-icon"></span>🕵️ 监控能力</p><div class="admonition-content"><p><strong>DNS 查询揭示的内容：</strong></p>
<ul>
<li>医疗状况（健康网站查询）</li>
<li>政治立场（新闻网站、竞选网站）</li>
<li>财务状况（银行网站、投资平台）</li>
<li>个人关系（约会网站、社交网络）</li>
<li>地理位置（本地商业查询）</li>
<li>工作模式（基于时间的查询模式）</li>
</ul>
<p>这些元数据对于用户画像通常比内容更有价值。</p>
</div></div>
<h3 id="ISP-行为和货币化">ISP 行为和货币化</h3>
<p>互联网服务提供商越来越多地通过各种方式将 DNS 数据货币化：</p>
<ul>
<li><strong>广告</strong>：在 DNS 错误页面中注入广告</li>
<li><strong>跟踪</strong>：向广告商出售 DNS 查询数据</li>
<li><strong>重定向</strong>：将失败的查询重定向到带有广告的搜索页面</li>
<li><strong>分析</strong>：从浏览模式构建用户画像</li>
</ul>
<p>这些做法虽然通常在服务条款中披露，但引发了对用户隐私和同意的担忧。DoH 消除了 ISP 对 DNS 查询的可见性，消除了这些货币化机会，并引发了 ISP 的强烈反对。</p>
<h3 id="审查和操纵">审查和操纵</h3>
<p>世界各地的政府和网络运营商使用 DNS 过滤进行审查，通过阻止 DNS 解析来阻止访问网站。虽然一些过滤服务于合法目的（阻止恶意软件、儿童剥削），但它也被用来压制政治异议和控制信息访问。</p>
<p>DNS 操纵攻击（DNS 欺骗、缓存投毒）可以将用户重定向到恶意网站或阻止访问合法资源。这些攻击利用了 DNS 缺乏身份验证和加密的特点。</p>
<p>DoH 使 DNS 过滤和操纵变得更加困难，将控制权从网络运营商转移到 DNS 解析器运营商和应用程序开发人员。</p>
<h3 id="浏览器供应商倡议">浏览器供应商倡议</h3>
<p>主要浏览器供应商——特别是 Mozilla 和 Google——将 DoH 作为更广泛隐私倡议的一部分进行推广。Mozilla 在 Firefox 中默认启用了 DoH（2020 年），而 Chrome 添加了用户控制的 DoH 支持。这些决定将 DoH 带给了数亿用户，尽管遭到 ISP 和网络管理员的反对，但仍加速了采用。</p>
<p>浏览器供应商认为，用户默认应该享有隐私，不应该需要技术专业知识来保护他们的 DNS 查询。批评者反驳说，浏览器越权并破坏了网络管理。</p>
<h2 id="优势：DoH-采用的理由">优势：DoH 采用的理由</h2>
<p>DoH 采用带来了切实的隐私和安全优势，尽管它引发了争议，但这些优势证明了其采用的合理性。</p>
<h3 id="增强隐私">增强隐私</h3>
<p>DoH 的主要优势是防止网络中间人对 DNS 查询的监控。ISP、公共 WiFi 运营商和其他网络观察者无法再看到用户正在查询哪些域名。这种隐私扩展到：</p>
<ul>
<li><strong>家庭网络</strong>：室友和家庭成员无法监控彼此的浏览</li>
<li><strong>公共 WiFi</strong>：咖啡店运营商无法跟踪客户浏览</li>
<li><strong>企业网络</strong>：雇主对员工浏览的可见性降低（有争议）</li>
<li><strong>ISP 监控</strong>：服务提供商无法从 DNS 数据构建画像</li>
</ul>
<div class="admonition tip"><p class="admonition-title"><span class="mdi mdi-lightbulb-on-outline admonition-icon"></span>🔒 隐私层次</p><div class="admonition-content"><p><strong>没有 DoH：</strong></p>
<ul>
<li>ISP 看到：DNS 查询（访问的域名）</li>
<li>网站看到：你的 IP 地址和浏览行为</li>
</ul>
<p><strong>有 DoH：</strong></p>
<ul>
<li>ISP 看到：到 DoH 服务器的加密 HTTPS 流量，然后到目标的加密流量</li>
<li>DoH 提供商看到：DNS 查询（信任转移）</li>
<li>网站看到：你的 IP 地址和浏览行为</li>
</ul>
<p>DoH 不提供完全匿名——它将信任从 ISP 转移到 DoH 提供商。</p>
</div></div>
<h3 id="防止操纵">防止操纵</h3>
<p>加密 DNS 查询可以防止修改 DNS 响应的中间人攻击。公共 WiFi 网络、受损路由器或恶意 ISP 上的攻击者无法通过 DNS 操纵将用户重定向到钓鱼网站或阻止访问合法资源。</p>
<p>DNSSEC（DNS 安全扩展）提供 DNS 响应的加密身份验证，但采用缓慢且不提供机密性。DoH 通过添加加密来补充 DNSSEC，创建更完整的安全解决方案。</p>
<h3 id="规避审查">规避审查</h3>
<p>对于生活在互联网审查国家的用户，DoH 提供了绕过基于 DNS 的阻止的工具。通过使用审查国家以外的 DoH 服务器，用户可以访问被阻止的网站，而无需像 VPN 这样的复杂规避工具。</p>
<div class="admonition anote"><p class="admonition-title"><span class="mdi mdi-note-outline admonition-icon"></span>🌍 抗审查</p><div class="admonition-content"><p><strong>传统 DNS 阻止：</strong></p>
<ul>
<li>政府控制本地 DNS 解析器</li>
<li>阻止对被禁域名的查询</li>
<li>用户看到"找不到域名"错误</li>
</ul>
<p><strong>有 DoH：</strong></p>
<ul>
<li>用户配置浏览器使用外国 DoH 服务器</li>
<li>DNS 查询加密并发送到外部服务器</li>
<li>阻止需要阻止所有 HTTPS（不切实际）</li>
</ul>
<p>这种能力使 DoH 在互联网控制严格的国家具有政治争议性。</p>
</div></div>
<h3 id="改善安全态势">改善安全态势</h3>
<p>DoH 减少了基于 DNS 的威胁的攻击面：</p>
<ul>
<li><strong>DNS 欺骗</strong>：加密查询无法被拦截和修改</li>
<li><strong>缓存投毒</strong>：更难注入虚假 DNS 记录</li>
<li><strong>DNS 隧道检测</strong>：加密流量使恶意 DNS 隧道更难检测（双刃剑）</li>
<li><strong>凭证盗窃</strong>：防止攻击者重定向登录页面</li>
</ul>
<p>使用受信任解析器的 DoH 组织可以防止绕过传统安全控制的基于 DNS 的攻击。</p>
<h3 id="性能优化">性能优化</h3>
<p>现代 DoH 实现利用 HTTP/2 和 HTTP/3 功能来提高性能：</p>
<ul>
<li><strong>多路复用</strong>：通过单个连接进行多个 DNS 查询</li>
<li><strong>连接重用</strong>：减少连接建立的延迟</li>
<li><strong>HTTP 缓存</strong>：中间缓存可以存储响应（有隐私考虑）</li>
<li><strong>0-RTT</strong>：HTTP/3 为重复查询启用零往返时间</li>
</ul>
<h2 id="挑战和争议">挑战和争议</h2>
<p>DoH 的优势伴随着重大挑战，使其成为近年来最具争议的互联网协议之一。</p>
<h3 id="网络管理和可见性">网络管理和可见性</h3>
<p>网络管理员依赖 DNS 可见性来实现合法目的：</p>
<ul>
<li><strong>安全监控</strong>：检测恶意软件通信、数据泄露</li>
<li><strong>内容过滤</strong>：阻止恶意网站、执行可接受使用策略</li>
<li><strong>故障排除</strong>：诊断网络问题、识别配置错误的系统</li>
<li><strong>合规性</strong>：满足内容过滤的监管要求</li>
</ul>
<p>DoH 通过加密 DNS 查询破坏了这些能力，迫使组织实施替代监控方法或完全阻止 DoH。</p>
<div class="admonition warning"><p class="admonition-title"><span class="mdi mdi-alert-outline admonition-icon"></span>⚠️ 企业担忧</p><div class="admonition-content"><p><strong>DoH 导致的能力丧失：</strong></p>
<ul>
<li>基于 DNS 的威胁检测（恶意软件域名、C2 服务器）</li>
<li>家长控制和内容过滤</li>
<li>网络使用分析</li>
<li>遵守数据保留法规</li>
<li>DNS 解析问题故障排除</li>
</ul>
<p><strong>缓解策略：</strong></p>
<ul>
<li>部署带有日志记录的内部 DoH 服务器</li>
<li>使用端点安全代理获得可见性</li>
<li>实施 TLS 检查（有争议）</li>
<li>阻止外部 DoH 服务器（军备竞赛）</li>
</ul>
</div></div>
<h3 id="中心化担忧">中心化担忧</h3>
<p>传统 DNS 高度分布，由 ISP、组织和公共服务运营的数千个解析器。DoH 采用使 DNS 流量集中在少数大型提供商中：</p>
<ul>
<li><strong>Cloudflare (1.1.1.1)</strong>：最受欢迎的 DoH 提供商之一</li>
<li><strong>Google (8.8.8.8)</strong>：庞大的 DoH 用户群</li>
<li><strong>Quad9</strong>：注重隐私的替代方案</li>
<li><strong>浏览器默认值</strong>：Mozilla 与 Cloudflare 合作，集中流量</li>
</ul>
<p>这种中心化引发了担忧：</p>
<ul>
<li><strong>单点故障</strong>：中断影响数百万用户</li>
<li><strong>监控风险</strong>：集中数据创造有吸引力的监控目标</li>
<li><strong>市场力量</strong>：少数提供商控制关键基础设施</li>
<li><strong>地缘政治影响</strong>：DNS 流量流经特定司法管辖区</li>
</ul>
<div class="admonition anote"><p class="admonition-title"><span class="mdi mdi-note-outline admonition-icon"></span>🏛️ 中心化与隐私权衡</p><div class="admonition-content"><p><strong>分布式 DNS（传统）：</strong></p>
<ul>
<li>许多小型运营商（ISP、本地解析器）</li>
<li>查询对本地网络运营商可见</li>
<li>对单一提供商故障具有弹性</li>
<li>更容易在本地监管</li>
</ul>
<p><strong>中心化 DoH：</strong></p>
<ul>
<li>少数大型提供商</li>
<li>查询对本地网络隐藏但对 DoH 提供商可见</li>
<li>容易受到提供商中断的影响</li>
<li>更难监管（跨境）</li>
</ul>
<p>两种模型都不明显优越——每种都涉及不同的信任假设。</p>
</div></div>
<h3 id="分割视界-DNS-和内部网络">分割视界 DNS 和内部网络</h3>
<p>许多组织使用分割视界 DNS，其中内部域名在企业网络上的解析与在公共互联网上的解析不同。像"intranet.company.local"这样的内部资源只能在公司网络上解析。</p>
<p>当客户端使用外部 DoH 服务器时，DoH 会破坏分割视界 DNS。内部域名查询会发送到无法解析它们的公共解析器，从而破坏对内部资源的访问。组织必须：</p>
<ul>
<li><strong>阻止外部 DoH</strong>：防止员工使用公共 DoH 服务器</li>
<li><strong>部署内部 DoH</strong>：需要基础设施投资和配置</li>
<li><strong>使用发现机制</strong>：实施 DoH 服务器发现协议（仍在成熟中）</li>
</ul>
<h3 id="性能开销">性能开销</h3>
<p>虽然 DoH 可以利用 HTTP 优化，但它也引入了开销：</p>
<ul>
<li><strong>连接建立</strong>：HTTPS 握手为第一个查询增加延迟</li>
<li><strong>加密开销</strong>：加密/解密查询的 CPU 成本</li>
<li><strong>HTTP 帧</strong>：与原始 DNS 相比的额外字节</li>
<li><strong>连接管理</strong>：维护持久连接</li>
</ul>
<p>对于大量 DNS 用户，这种开销可能是可测量的。然而，连接重用和 HTTP/2 多路复用减轻了大部分影响。</p>
<h3 id="法律和监管挑战">法律和监管挑战</h3>
<p>DoH 使围绕合法拦截、内容过滤和数据保留的法律框架变得复杂：</p>
<ul>
<li><strong>合法拦截</strong>：执法部门失去对 DNS 查询的可见性</li>
<li><strong>内容过滤授权</strong>：要求 ISP 级过滤的国家无法执行</li>
<li><strong>数据保留</strong>：要求 DNS 查询日志记录的法规变得更难执行</li>
<li><strong>管辖权</strong>：DNS 流量流向不同法律管辖区的提供商</li>
</ul>
<p>一些国家已经考虑或实施了对 DoH 的限制以维持监管控制。英国的互联网观察基金会表达了对 DoH 破坏儿童保护工作的担忧。</p>
<h2 id="实施方法">实施方法</h2>
<p>组织和用户有几种实施 DoH 的选项，每种都有不同的权衡。</p>
<h3 id="基于浏览器的-DoH">基于浏览器的 DoH</h3>
<p>现代浏览器包含内置的 DoH 支持，允许用户在不进行系统级更改的情况下启用加密 DNS：</p>
<p><strong>Firefox：</strong></p>
<ul>
<li>在某些地区默认启用 DoH</li>
<li>默认使用 Cloudflare 或 NextDNS</li>
<li>用户可以配置自定义 DoH 服务器</li>
<li>尊重企业策略以禁用 DoH</li>
</ul>
<p><strong>Chrome/Edge：</strong></p>
<ul>
<li>如果系统 DNS 解析器支持，则启用 DoH</li>
<li>在可用时将现有 DNS 升级到 DoH</li>
<li>尊重系统 DNS 配置</li>
<li>可以通过企业策略禁用</li>
</ul>
<p><strong>Safari：</strong></p>
<ul>
<li>通过系统级配置支持 DoH</li>
<li>没有内置的 DoH 服务器默认值</li>
<li>需要手动配置或配置文件</li>
</ul>
<div class="admonition tip"><p class="admonition-title"><span class="mdi mdi-lightbulb-on-outline admonition-icon"></span>🔧 浏览器 DoH 配置</p><div class="admonition-content"><p><strong>优势：</strong></p>
<ul>
<li>用户易于启用</li>
<li>不需要系统级更改</li>
<li>每个浏览器控制</li>
</ul>
<p><strong>劣势：</strong></p>
<ul>
<li>仅保护浏览器流量</li>
<li>其他应用程序仍使用传统 DNS</li>
<li>可能与网络策略冲突</li>
</ul>
</div></div>
<h3 id="系统级-DoH">系统级 DoH</h3>
<p>操作系统越来越多地在系统级支持 DoH，保护所有应用程序：</p>
<p><strong>Windows 11：</strong></p>
<ul>
<li>DNS 客户端中的原生 DoH 支持</li>
<li>通过设置或注册表配置</li>
<li>支持回退到传统 DNS</li>
</ul>
<p><strong>macOS：</strong></p>
<ul>
<li>通过配置文件支持 DoH</li>
<li>需要手动设置或 MDM 部署</li>
<li>系统范围保护</li>
</ul>
<p><strong>Linux：</strong></p>
<ul>
<li>systemd-resolved 支持 DoH</li>
<li>各种第三方 DoH 客户端可用</li>
<li>需要配置</li>
</ul>
<p><strong>Android/iOS：</strong></p>
<ul>
<li>私有 DNS 设置支持 DoH</li>
<li>基于 VPN 的 DoH 应用程序可用</li>
<li>每个网络配置可能</li>
</ul>
<h3 id="企业-DoH-部署">企业 DoH 部署</h3>
<p>部署 DoH 的组织面临独特的要求：</p>
<div class="admonition example"><p class="admonition-title"><span class="mdi mdi-file-code-outline admonition-icon"></span>🏢 企业 DoH 策略</p><div class="admonition-content"><p><strong>选项 1：内部 DoH 服务器</strong></p>
<ul>
<li>在企业网络内部署 DoH 服务器</li>
<li>维护 DNS 可见性和控制</li>
<li>支持分割视界 DNS</li>
<li>需要基础设施投资</li>
</ul>
<p><strong>选项 2：托管 DoH 服务</strong></p>
<ul>
<li>使用企业 DoH 提供商（Cisco Umbrella、Cloudflare for Teams）</li>
<li>集中管理和日志记录</li>
<li>维护安全可见性</li>
<li>订阅成本</li>
</ul>
<p><strong>选项 3：混合方法</strong></p>
<ul>
<li>企业设备的内部 DoH</li>
<li>允许 BYOD 的外部 DoH</li>
<li>基于策略的路由</li>
<li>复杂配置</li>
</ul>
</div></div>
<h3 id="DoH-服务器选择标准">DoH 服务器选择标准</h3>
<p>选择 DoH 提供商涉及评估几个因素：</p>
<table>
<thead>
<tr>
<th>标准</th>
<th>考虑因素</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>隐私政策</strong></td>
<td>日志记录实践、数据保留、第三方共享</td>
</tr>
<tr>
<td><strong>性能</strong></td>
<td>延迟、可靠性、地理分布</td>
</tr>
<tr>
<td><strong>安全性</strong></td>
<td>恶意软件阻止、威胁情报集成</td>
</tr>
<tr>
<td><strong>过滤</strong></td>
<td>内容过滤选项（家长控制、恶意软件）</td>
</tr>
<tr>
<td><strong>合规性</strong></td>
<td>数据驻留、监管合规</td>
</tr>
<tr>
<td><strong>成本</strong></td>
<td>免费与付费层级、企业定价</td>
</tr>
<tr>
<td><strong>透明度</strong></td>
<td>公开审计、透明度报告</td>
</tr>
</tbody>
</table>
<h2 id="现实世界的采用和影响">现实世界的采用和影响</h2>
<p>自 2018 年以来，DoH 采用显著增长，对互联网隐私和网络管理产生了可衡量的影响。</p>
<h3 id="采用统计">采用统计</h3>
<ul>
<li><strong>Firefox</strong>：2020 年为美国用户默认启用 DoH，扩展到其他地区</li>
<li><strong>Chrome</strong>：2020 年 DoH 支持，在可用时自动升级</li>
<li><strong>Cloudflare</strong>：每天处理数十亿次 DoH 查询</li>
<li><strong>Google Public DNS</strong>：DoH 流量显著增长</li>
<li><strong>企业</strong>：采用混合，许多组织阻止外部 DoH</li>
</ul>
<h3 id="案例研究">案例研究</h3>
<div class="admonition example"><p class="admonition-title"><span class="mdi mdi-file-code-outline admonition-icon"></span>💼 Mozilla 的 DoH 推出</p><div class="admonition-content"><p><strong>方法：</strong></p>
<ul>
<li>从美国开始逐步推出（2020 年）</li>
<li>与 Cloudflare 合作作为默认提供商</li>
<li>受信任递归解析器（TRR）计划用于提供商审查</li>
<li>企业策略覆盖企业网络</li>
</ul>
<p><strong>结果：</strong></p>
<ul>
<li>数百万用户默认受到保护</li>
<li>ISP 和网络运营商的强烈反对</li>
<li>迫使企业 DoH 解决方案的开发</li>
<li>提高了对 DNS 隐私问题的认识</li>
</ul>
</div></div>
<div class="admonition example"><p class="admonition-title"><span class="mdi mdi-file-code-outline admonition-icon"></span>🌐 Cloudflare 1.1.1.1</p><div class="admonition-content"><p><strong>提供：</strong></p>
<ul>
<li>免费公共 DoH 解析器</li>
<li>注重隐私（最少日志记录）</li>
<li>高性能（全球任播网络）</li>
<li>恶意软件阻止变体（1.1.1.2）</li>
</ul>
<p><strong>影响：</strong></p>
<ul>
<li>成为最大的 DoH 提供商之一</li>
<li>展示了注重隐私的 DNS 的可行性</li>
<li>引发了对中心化的担忧</li>
<li>影响其他提供商提供 DoH</li>
</ul>
</div></div>
<h3 id="对网络安全的影响">对网络安全的影响</h3>
<p>安全团队报告了对 DoH 的不同体验：</p>
<p><strong>积极影响：</strong></p>
<ul>
<li>减少来自外部网络的基于 DNS 的攻击</li>
<li>防止 ISP 级操纵</li>
<li>改善远程工作者的隐私</li>
</ul>
<p><strong>消极影响：</strong></p>
<ul>
<li>失去基于 DNS 的威胁检测</li>
<li>难以执行内容策略</li>
<li>安全监控复杂性增加</li>
<li>需要替代检测方法</li>
</ul>
<p>组织通过实施基于端点的安全、TLS 检查（有争议）和带有日志记录的内部 DoH 服务器来适应。</p>
<h2 id="未来方向">未来方向</h2>
<p>DoH 继续发展，几个趋势塑造了其未来发展。</p>
<h3 id="发现和配置">发现和配置</h3>
<p>当前的 DoH 部署需要手动配置或浏览器默认值。新兴标准旨在改善这一点：</p>
<ul>
<li><strong>指定解析器发现（DDR）</strong>：RFC 9462 启用 DoH 服务器的自动发现</li>
<li><strong>DHCP/RA 选项</strong>：网络提供的 DoH 服务器配置</li>
<li><strong>DNS SVCB 记录</strong>：通过 DNS 本身宣传 DoH 支持</li>
<li><strong>加密 ClientHello（ECH）</strong>：通过加密 SNI 补充 DoH</li>
</ul>
<p>这些机制使 DoH 采用无缝，同时尊重网络策略。</p>
<h3 id="不经意-DoH（ODoH）">不经意 DoH（ODoH）</h3>
<p>不经意 DoH（RFC 9230）通过分离查询可见性和 IP 地址可见性来解决 DoH 的信任集中问题：</p>
<div class="mermaid">sequenceDiagram
    participant Client as 客户端
    participant Proxy as 代理
    participant Target as DoH 服务器
    
    Client-&gt;&gt;Client: 使用目标的公钥加密查询
    Client-&gt;&gt;Proxy: 发送加密查询
    Note over Client,Proxy: 代理看到客户端 IP 但看不到查询
    Proxy-&gt;&gt;Target: 转发加密查询
    Note over Proxy,Target: 目标看到查询但看不到客户端 IP
    Target-&gt;&gt;Target: 解密并解析查询
    Target-&gt;&gt;Proxy: 发送加密响应
    Proxy-&gt;&gt;Client: 转发加密响应
    Client-&gt;&gt;Client: 解密响应</div>
<div class="admonition anote"><p class="admonition-title"><span class="mdi mdi-note-outline admonition-icon"></span>🔐 ODoH 隐私模型</p><div class="admonition-content"><p><strong>传统 DoH：</strong></p>
<ul>
<li>DoH 提供商同时看到你的 IP 地址和查询</li>
<li>单一信任点</li>
</ul>
<p><strong>不经意 DoH：</strong></p>
<ul>
<li>代理看到你的 IP 但看不到查询（加密）</li>
<li>目标看到查询但看不到你的 IP（来自代理）</li>
<li>需要串通才能链接 IP 和查询</li>
<li>更强的隐私保证</li>
</ul>
</div></div>
<p>ODoH 仍处于采用早期，但代表了 DNS 隐私的下一个演变。</p>
<h3 id="与零信任架构集成">与零信任架构集成</h3>
<p>DoH 越来越多地集成到零信任安全模型中：</p>
<ul>
<li><strong>身份感知 DNS</strong>：DoH 查询与用户/设备身份绑定</li>
<li><strong>策略执行</strong>：基于用户上下文的 DNS 策略</li>
<li><strong>威胁情报</strong>：与 DoH 集成的实时威胁源</li>
<li><strong>条件访问</strong>：基于安全态势的 DNS 解析</li>
</ul>
<p>这种集成在不牺牲隐私的情况下实现安全。</p>
<h3 id="监管演变">监管演变</h3>
<p>政府和监管机构正在为加密 DNS 制定框架：</p>
<ul>
<li><strong>合法访问</strong>：执法部门访问 DoH 日志的机制</li>
<li><strong>内容过滤</strong>：DoH 提供商实施过滤的要求</li>
<li><strong>数据本地化</strong>：DNS 数据留在境内的要求</li>
<li><strong>透明度</strong>：DoH 提供商实践的强制报告</li>
</ul>
<p>这些法规将塑造 DoH 的演变以及哪些提供商在不同司法管辖区运营。</p>
<h3 id="性能优化-2">性能优化</h3>
<p>减少 DoH 开销的持续工作：</p>
<ul>
<li><strong>HTTP/3 采用</strong>：基于 QUIC 的传输减少延迟</li>
<li><strong>0-RTT 恢复</strong>：消除重复连接的握手延迟</li>
<li><strong>自适应 TTL</strong>：基于查询模式的智能缓存</li>
<li><strong>预取</strong>：对可能查询的预测性 DNS 解析</li>
</ul>
<h2 id="结论">结论</h2>
<p>DNS over HTTPS 代表了互联网隐私的根本转变，加密了几十年来一直可见的协议。通过将 DNS 查询包装在 HTTPS 中，DoH 防止了网络中间人的监控、操纵和审查。优势是明确的：增强隐私、防止攻击和规避基于 DNS 的阻止。</p>
<p>然而，DoH 的采用一直存在争议，挑战了既定的网络管理实践，并引发了对中心化、企业安全和监管控制的担忧。网络管理员失去了他们依赖的安全监控和故障排除的可见性。DNS 流量集中在少数大型提供商中，造成了新的风险。组织必须调整其安全策略以在没有 DNS 可见性的情况下保持保护。</p>
<div class="mermaid">graph TB
    A["DoH 采用"]
    
    B["隐私优势"]
    C["安全挑战"]
    D["未来演变"]
    
    A --&gt; B
    A --&gt; C
    A --&gt; D
    
    B --&gt; B1["防止 ISP 监控"]
    B --&gt; B2["操纵保护"]
    B --&gt; B3["抗审查"]
    B --&gt; B4["攻击面减少"]
    
    C --&gt; C1["网络可见性丧失"]
    C --&gt; C2["中心化风险"]
    C --&gt; C3["企业管理"]
    C --&gt; C4["监管合规"]
    
    D --&gt; D1["不经意 DoH"]
    D --&gt; D2["发现标准"]
    D --&gt; D3["零信任集成"]
    D --&gt; D4["监管框架"]
    
    style A fill:#e3f2fd,stroke:#1976d2,stroke-width:3px
    style B fill:#e8f5e9,stroke:#388e3c
    style C fill:#fff3e0,stroke:#f57c00
    style D fill:#f3e5f5,stroke:#7b1fa2</div>
<p>围绕 DoH 的辩论反映了互联网治理中更广泛的紧张关系：隐私与控制、中心化与分布、用户自主权与网络管理。没有完美的解决方案——每种方法都涉及权衡和不同的信任假设。</p>
<p>对于个人而言，DoH 以最小的努力提供有意义的隐私保护。基于浏览器的 DoH 或系统级配置提供即时好处，特别是在不受信任的网络上。从 ISP 到 DoH 提供商的信任转移通常是有利的，因为 DoH 提供商通常有更强的隐私承诺并面临更多的公众监督。</p>
<p>对于组织而言，DoH 需要仔细考虑。阻止外部 DoH 并部署内部 DoH 服务器可以在提供加密优势的同时保持安全可见性。托管 DoH 服务提供了一个中间地带，提供具有日志记录和过滤等企业功能的加密。关键是调整安全策略以在不仅仅依赖 DNS 可见性的情况下工作。</p>
<p>展望未来，DoH 将继续发展。不经意 DoH 通过分离查询可见性和 IP 地址可见性来解决中心化问题。发现机制将使 DoH 采用无缝，同时尊重网络策略。与零信任架构的集成将在不牺牲隐私的情况下实现安全。监管框架将出现，塑造 DoH 在不同司法管辖区的运作方式。</p>
<p>更广泛的含义是明确的：互联网正在向默认加密迈进。DNS 是最后一个以明文传输的主要协议之一。DoH 弥补了这一差距，将 HTTPS 的隐私保护扩展到互联网命名的基础层。这种转变是不可逆转的——隐私优势太重要了，技术部署太广泛了，无法回滚。</p>
<p>对于那些评估 DoH 的人来说，问题不是是否采用加密 DNS，而是如何以平衡隐私、安全和运营要求的方式这样做。该技术已经成熟，得到广泛支持，并且越来越成为默认。理解其影响并深思熟虑地实施它对于任何管理网络或关心互联网隐私的人来说都是必不可少的。</p>
<p>DNS 的未来是加密的。DoH 正在构建这个未来，一次一个查询。</p>
<h2 id="亲自尝试">亲自尝试</h2>
<p>想看看 DoH 的实际效果吗？试试我们的 <a href="/tools/doh-lookup/">DNS over HTTPS 查询工具</a>，通过 Cloudflare、Google 或 Quad9 执行加密 DNS 查询。查询多种记录类型，亲身体验隐私优势。</p>
<h2 id="参考资料和资源">参考资料和资源</h2>
<ul>
<li><strong>RFC 8484</strong>：DNS Queries over HTTPS (DoH) - <a target="_blank" rel="noopener" href="https://datatracker.ietf.org/doc/html/rfc8484">IETF RFC 8484</a></li>
<li><strong>RFC 7858</strong>：Specification for DNS over Transport Layer Security (DoT) - <a target="_blank" rel="noopener" href="https://datatracker.ietf.org/doc/html/rfc7858">IETF RFC 7858</a></li>
<li><strong>RFC 9230</strong>：Oblivious DNS over HTTPS - <a target="_blank" rel="noopener" href="https://datatracker.ietf.org/doc/html/rfc9230">IETF RFC 9230</a></li>
<li><strong>RFC 9462</strong>：Discovery of Designated Resolvers (DDR) - <a target="_blank" rel="noopener" href="https://datatracker.ietf.org/doc/html/rfc9462">IETF RFC 9462</a></li>
<li><strong>Cloudflare 1.1.1.1</strong>：<a target="_blank" rel="noopener" href="https://1.1.1.1/">https://1.1.1.1/</a></li>
<li><strong>Google Public DNS</strong>：<a target="_blank" rel="noopener" href="https://developers.google.com/speed/public-dns">https://developers.google.com/speed/public-dns</a></li>
<li><strong>Quad9</strong>：<a target="_blank" rel="noopener" href="https://www.quad9.net/">https://www.quad9.net/</a></li>
<li><strong>Mozilla 受信任递归解析器计划</strong>：<a target="_blank" rel="noopener" href="https://wiki.mozilla.org/Security/DOH-resolver-policy">https://wiki.mozilla.org/Security/DOH-resolver-policy</a></li>
</ul>

        </div>
        
        <footer class="article-footer">
            
    <a data-url="https://neo01.com/zh-CN/2025/04/DNS-over-HTTPS-Securing-Internet-Foundation/" data-id="754c7343" class="article-share-link"><i class="fa fa-share"></i>分享到</a>
<script>
    (function ($) {
        $('body').on('click', function() {
            $('.article-share-box.on').removeClass('on');
        }).on('click', '.article-share-link', function(e) {
            e.stopPropagation();

            var $this = $(this),
                url = $this.attr('data-url').replace("http://","https://"),
                encodedUrl = encodeURIComponent(url),
                id = 'article-share-box-' + $this.attr('data-id'),
                offset = $this.offset(),
                box;

            if ($('#' + id).length) {
                box = $('#' + id);

                if (box.hasClass('on')){
                    box.removeClass('on');
                    return;
                }
            } else {
                var html = [
                    '<div id="' + id + '" class="article-share-box">',
                        '<input class="article-share-input" value="' + url + '">',
                        '<div class="article-share-links">',
                            '<a href="https://twitter.com/intent/tweet?url=' + encodedUrl + '" class="article-share-twitter" target="_blank" title="Twitter"></a>',
                            '<a href="https://www.facebook.com/sharer.php?u=' + encodedUrl + '" class="article-share-facebook" target="_blank" title="Facebook"></a>',
                            '<a href="http://pinterest.com/pin/create/button/?url=' + encodedUrl + '" class="article-share-pinterest" target="_blank" title="Pinterest"></a>',
                        '</div>',
                    '</div>'
                ].join('');

              box = $(html);

              $('body').append(box);
            }

            $('.article-share-box.on').hide();

            box.css({
                top: offset.top + 25,
                left: offset.left
            }).addClass('on');

        }).on('click', '.article-share-box', function (e) {
            e.stopPropagation();
        }).on('click', '.article-share-box-input', function () {
            $(this).select();
        }).on('click', '.article-share-box-link', function (e) {
            e.preventDefault();
            e.stopPropagation();

            window.open(this.href, 'article-share-box-window-' + Date.now(), 'width=500,height=450');
        });
    })(jQuery);
</script>

        </footer>
    </div>
    <!--script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "BlogPosting",
        "author": {
            "@type": "Person",
            "name": "Neo Alienson"
        },
        "headline": "DNS over HTTPS：保护互联网的基础设施",
        "image": "https://neo01.com/assets/futuristic/mesh.png",
        "keywords": "DNS Networking Privacy Security",
        "genre": "Cybersecurity",
        "datePublished": "2025-04-02",
        "dateCreated": "2025-04-02",
        "dateModified": "2025-11-01",
        "url": "https://neo01.com//zh-CN/2025/04/DNS-over-HTTPS-Securing-Internet-Foundation/",
        "description": "探索 DNS over HTTPS (DoH) 如何通过加密 DNS 查询来改变互联网隐私，防止监控和操纵，同时重塑安全与网络控制之间的平衡。",
        "wordCount": 1107
    }
</script-->

</article>

                        </div>
                    </section>
                    
<aside id="sidebar">
    <a class="sidebar-toggle" title="Expand Sidebar"><i class="toggle icon"></i></a>
    <div class="sidebar-top">
        <p>关注我 :</p>
        <ul class="social-links">
                <li>
                    <a class="social-tooltip" title="stack-exchange" href="https://stackexchange.com/users/2122053/neo?tab=accounts" target="_blank" rel="noopener">
                        <i class="icon fa-brands fa-stack-exchange"></i>
                    </a>
                </li>
                <li>
                    <a class="social-tooltip" title="stack-overflow" href="https://stackoverflow.com/users/1885105/neo" target="_blank" rel="noopener">
                        <i class="icon fa-brands fa-stack-overflow"></i>
                    </a>
                </li>
                <li>
                    <a class="social-tooltip" title="github" href="https://github.com/neoalienson" target="_blank" rel="noopener">
                        <i class="icon fa-brands fa-github"></i>
                    </a>
                </li>
                <li>
                    <a class="social-tooltip" title="linkedin" href="https://linkedin.com/in/neo01" target="_blank" rel="noopener">
                        <i class="icon fa-brands fa-linkedin"></i>
                    </a>
                </li>
                <li>
                    <a class="social-tooltip" title="rss" href="/atom.xml" target="_blank" rel="noopener">
                        <i class="icon fa fa-rss"></i>
                    </a>
                </li>
        </ul>
    </div>
    <div class="widgets-container">

        
            
                
                <div class="widget-wrap widget-list">
    <h3 class="widget-title">链接</h3>
    <div class="widget">
        <ul><li><a href="/zh-CN/ai">AI 游乐场</a></li><li><a href="/zh-CN/tools">工具</a></li><li><a href="/zh-CN/games">游戏</a></li><li><a href="/zh-CN/pages/useful-information">实用信息</a></li><li><a href="/zh-CN/pages/Hexo-Blogging-Cheatsheet">Hexo 博客速查表</a></li></ul>
    </div>
</div>

                
            
                
                
                
            
                
                    <div class="widget-wrap">
        <h3 class="widget-title">最新文章</h3>
        <div class="widget">
            <ul id="recent-post" class="">
                    <li>
                        <div class="item-thumbnail">
                            <a href="/zh-CN/2025/10/Enabling-i18n-in-Hexo/" class="thumbnail">
        <span style="background-image:url(/assets/hexo/thumbnail.png)" alt="在 Hexo 中启用 i18n：多语言博客完整指南" class="thumbnail-image"></span>
</a>
                        </div>
                        <div class="item-inner">
                            <p class="item-category"><a class="article-category-link" style="cursor: default; pointer-events: none;">开发</a></p>
                            <p class="item-title"><a href="/zh-CN/2025/10/Enabling-i18n-in-Hexo/" class="title">在 Hexo 中启用 i18n：多语言博客完整指南</a></p>
                            <p class="item-date"><time datetime="2025-10-29T16:00:00.000Z" itemprop="datePublished">2025-10-30</time></p>
                        </div>
                    </li>
                    <li>
                        <div class="item-thumbnail">
                            <a href="/zh-CN/2025/10/CISP-Advanced-Security-Topics/" class="thumbnail">
        <span style="background-image:url(/assets/cisp/thumbnail_80.png)" alt="CISP学习指南：高级安全主题" class="thumbnail-image"></span>
</a>
                        </div>
                        <div class="item-inner">
                            <p class="item-category"><a class="article-category-link" style="cursor: default; pointer-events: none;">网络安全</a></p>
                            <p class="item-title"><a href="/zh-CN/2025/10/CISP-Advanced-Security-Topics/" class="title">CISP学习指南：高级安全主题</a></p>
                            <p class="item-date"><time datetime="2025-10-22T16:00:00.000Z" itemprop="datePublished">2025-10-23</time></p>
                        </div>
                    </li>
                    <li>
                        <div class="item-thumbnail">
                            <a href="/zh-CN/2025/10/CISP-Email-Security/" class="thumbnail">
        <span style="background-image:url(/assets/cisp/thumbnail_80.png)" alt="CISP学习指南：电子邮件安全与网络协议" class="thumbnail-image"></span>
</a>
                        </div>
                        <div class="item-inner">
                            <p class="item-category"><a class="article-category-link" style="cursor: default; pointer-events: none;">网络安全</a></p>
                            <p class="item-title"><a href="/zh-CN/2025/10/CISP-Email-Security/" class="title">CISP学习指南：电子邮件安全与网络协议</a></p>
                            <p class="item-date"><time datetime="2025-10-22T16:00:00.000Z" itemprop="datePublished">2025-10-23</time></p>
                        </div>
                    </li>
                    <li>
                        <div class="item-thumbnail">
                            <a href="/zh-CN/2025/10/CISP-Access-Control-Audit-WAPI/" class="thumbnail">
        <span style="background-image:url(/assets/cisp/thumbnail_80.png)" alt="CISP学习指南：访问控制机制、蜜网、审计系统与WAPI" class="thumbnail-image"></span>
</a>
                        </div>
                        <div class="item-inner">
                            <p class="item-category"><a class="article-category-link" style="cursor: default; pointer-events: none;">网络安全</a></p>
                            <p class="item-title"><a href="/zh-CN/2025/10/CISP-Access-Control-Audit-WAPI/" class="title">CISP学习指南：访问控制机制、蜜网、审计系统与WAPI</a></p>
                            <p class="item-date"><time datetime="2025-10-21T16:00:00.000Z" itemprop="datePublished">2025-10-22</time></p>
                        </div>
                    </li>
                    <li>
                        <div class="item-thumbnail">
                            <a href="/zh-CN/2025/10/CISP-China-Information-Security-Laws/" class="thumbnail">
        <span style="background-image:url(/assets/cisp/thumbnail_80.png)" alt="CISP学习指南：中国信息安全法律法规体系" class="thumbnail-image"></span>
</a>
                        </div>
                        <div class="item-inner">
                            <p class="item-category"><a class="article-category-link" style="cursor: default; pointer-events: none;">网络安全</a></p>
                            <p class="item-title"><a href="/zh-CN/2025/10/CISP-China-Information-Security-Laws/" class="title">CISP学习指南：中国信息安全法律法规体系</a></p>
                            <p class="item-date"><time datetime="2025-10-21T16:00:00.000Z" itemprop="datePublished">2025-10-22</time></p>
                        </div>
                    </li>
            </ul>
        </div>
    </div>

                
            
                
                
    
    
    <div class="widget-wrap widget-list">
        <h3 class="widget-title">归档</h3>
        <div class="widget">
            <ul class="archive-list">
            
                <li class="archive-list-item">
                    <a class="archive-list-link" href="/zh-CN/archives/2025/">2025</a>
                    <span class="archive-list-count">74</span>
                </li>
            
                <li class="archive-list-item">
                    <a class="archive-list-link" href="/zh-CN/archives/2024/">2024</a>
                    <span class="archive-list-count">25</span>
                </li>
            
                <li class="archive-list-item">
                    <a class="archive-list-link" href="/zh-CN/archives/2023/">2023</a>
                    <span class="archive-list-count">16</span>
                </li>
            
                <li class="archive-list-item">
                    <a class="archive-list-link" href="/zh-CN/archives/2022/">2022</a>
                    <span class="archive-list-count">18</span>
                </li>
            
                <li class="archive-list-item">
                    <a class="archive-list-link" href="/zh-CN/archives/2021/">2021</a>
                    <span class="archive-list-count">14</span>
                </li>
            
                <li class="archive-list-item">
                    <a class="archive-list-link" href="/zh-CN/archives/2020/">2020</a>
                    <span class="archive-list-count">13</span>
                </li>
            
                <li class="archive-list-item">
                    <a class="archive-list-link" href="/zh-CN/archives/2019/">2019</a>
                    <span class="archive-list-count">12</span>
                </li>
            
                <li class="archive-list-item">
                    <a class="archive-list-link" href="/zh-CN/archives/2018/">2018</a>
                    <span class="archive-list-count">2</span>
                </li>
            
                <li class="archive-list-item">
                    <a class="archive-list-link" href="/zh-CN/archives/2017/">2017</a>
                    <span class="archive-list-count">5</span>
                </li>
            
                <li class="archive-list-item">
                    <a class="archive-list-link" href="/zh-CN/archives/2016/">2016</a>
                    <span class="archive-list-count">4</span>
                </li>
            
                <li class="archive-list-item">
                    <a class="archive-list-link" href="/zh-CN/archives/2015/">2015</a>
                    <span class="archive-list-count">6</span>
                </li>
            
                <li class="archive-list-item">
                    <a class="archive-list-link" href="/zh-CN/archives/2014/">2014</a>
                    <span class="archive-list-count">7</span>
                </li>
            
                <li class="archive-list-item">
                    <a class="archive-list-link" href="/zh-CN/archives/2013/">2013</a>
                    <span class="archive-list-count">2</span>
                </li>
            
            </ul>
        </div>
    </div>


                
            
        

    </div>
</aside>


                </div>
            </div>
        </div>
        
<footer id="footer">
    <div class="container">
        <div class="container-inner">
            <a id="back-to-top" href="javascript:;"><i class="icon fa fa-angle-up"></i></a>

            <div class="qrcode-share-wrapper">
                <div class="qrcode-text">https://neo01.com/l#3f88acae</div>
                <img src="/qr/qr-38c8f188d44b967daf3e19a999a86c66.svg" width="200" height="200" alt="QR Code for https://neo01.com/l#3f88acae">
            </div>
            <div class="credit">
                <h1 class="logo-wrap">
                    <a href="/" title="Homepage" class="logo"></a>
                </h1>
                
                <p>© 2025 Neo Alienson. 版权所有.
                  <a href="/zh-CN/terms-and-conditions">使用条款</a></p>
                
            </div>
            <div class="footer-plugins">
              


            </div>
        </div>
    </div>
</footer>

        
        
    
        


        


        


        


        


        


        


        


        


    



<!-- Custom Scripts -->




        
    </div>
<!-- hexo injector body_end start --><script type="text/javascript" src="/js/bundle_last.js"></script><!-- hexo injector body_end end -->

<script>CookieConsent.run({"palette":{"popup":{"background":"#000"},"button":{"background":"#f1d600"}},"guiOptions":{"consentModal":{"layout":"box","position":"bottom right","equalWeightButtons":true,"flipButtons":false},"preferencesModal":{"layout":"box","position":"right","equalWeightButtons":false,"flipButtons":false}},"categories":{"necessary":{"readOnly":true},"functionality":{},"analytics":{}},"language":{"default":"en","autoDetect":"browser","translations":{"en":{"consentModal":{"title":"Hello traveler, it's cookie time!","description":"🍪 This site uses cookies to serve you the best experience—no crumbs left behind! Want to know what cookies really are? Check out this easy-to-understand cookie explanation. And for the legal nitty-gritty, here’s our website cookie policy to keep you in the loop! 🚀\n","acceptAllBtn":"Accept all","acceptNecessaryBtn":"Reject all","showPreferencesBtn":"Manage preferences","footer":"<a href=\"#link\">Privacy Policy</a>\n<a href=\"/terms-and-conditions/\">Terms and conditions</a>\n"},"preferencesModal":{"title":"Consent Preferences Center","acceptAllBtn":"Accept all","acceptNecessaryBtn":"Reject all","savePreferencesBtn":"Save preferences","closeIconLabel":"Close modal","serviceCounterLabel":"Service|Services","sections":[{"title":"Cookie Usage","description":"We use cookies to make your visit smoother, faster, and tailored just for you. Cookies help us remember your preferences, improve site performance, and deliver personalized content while keeping things secure and user-friendly.\n"},{"title":"Strictly Necessary Cookies <span class=\"pm__badge\">Always Enabled</span>","description":"These cookies are essential for the website to function properly. They enable core features like security, page navigation, and access to secure areas. Without these, the site cannot operate correctly.\n","linkedCategory":"necessary"},{"title":"Functionality Cookies","description":"Functionality cookies remember your choices to provide a more personalized experience. For example, they save your language preference or login details so you don’t have to keep entering them each time.\n","linkedCategory":"functionality"},{"title":"Analytics Cookies","description":"Analytics cookies help us understand how visitors interact with our site by collecting information anonymously. This insight allows us to improve functionality, fix issues, and make the website better for you.\n","linkedCategory":"analytics"},{"title":"More information","description":"Please refer to our <a href='/pages/cookie-policy'>cookie policy</a> for full details on how we use cookies and your options to manage them.\n"}]}}}}})</script></body></html>