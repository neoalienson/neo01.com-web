<!DOCTYPE html><html lang="en"><head><!-- hexo injector head_begin start --><!-- Google tag (gtag.js) begins-->
    <script async="" src="https://www.googletagmanager.com/gtag/js?id=G-3DZR3TQYCY"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
    
      gtag('config', 'G-3DZR3TQYCY');
    </script>
    <!-- Google tag (gtag.js) ends-->
    <!-- hexo injector head_begin end -->
    <meta charset="utf-8">
    <!-- security headers starts -->
    <!-- meta http-equiv="content-security-policy" content="script-src 'sha256-B5nfCL2Dym3Ba4YJFI7wB3f4vtClbrYJZ32A5erBEdg=' 'sha256-lJjk3/dvd+wXqRFjV7T5L/nXJXr5NjUjmsKSPEe+ass=';" -->
    <!-- security headers ends -->
    <!-- favicon starts -->    
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <!-- favicon ends -->
    

    
    <title>Federated Identity: One Login to Rule Them All | Decoding Digital Anomalies</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    
    <meta name="keywords" content="">
    
    
    <meta name="description" content="Delegate authentication to external identity providers to simplify development, reduce administrative overhead, and improve user experience across multiple applications and organizations.">
<meta property="og:type" content="article">
<meta property="og:title" content="Federated Identity: One Login to Rule Them All">
<meta property="og:url" content="https://neo01.com/2019/12/Federated-Identity-Pattern/index.html">
<meta property="og:site_name" content="Decoding Digital Anomalies">
<meta property="og:description" content="Delegate authentication to external identity providers to simplify development, reduce administrative overhead, and improve user experience across multiple applications and organizations.">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://neo01.com/assets/architecture/thumbnail.png">
<meta property="article:published_time" content="2019-12-14T16:00:00.000Z">
<meta property="article:modified_time" content="2025-10-13T16:01:20.146Z">
<meta property="article:author" content="Neo Alienson">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://neo01.com/assets/architecture/thumbnail.png">
    
            <link rel="alternate" href="/atom.xml" title="Decoding Digital Anomalies" type="application/atom+xml">
    

    

    

    

    

    

    

    
    
        


    
    
        


    

<!-- hexo injector head_end start --><link rel="stylesheet" type="text/css" href="/css/bundle.css"><script type="text/javascript" src="/js/bundle_first.js"></script><!-- hexo injector head_end end --><meta name="generator" content="Hexo 7.3.0"><style id="admonition-styles">.admonition {
  margin: 1em 0;
  padding: 0rem;
  border-left: 0.3rem solid;
  border-radius: 0.4rem;
  background-color: #f9f9f9;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.04);
  overflow: hidden;
  page-break-inside: avoid;
}

.admonition-title {
  display: flex;
  align-items: center;
  font-weight: 600;
  padding: 0rem 1rem 0.1rem 0.75rem;
  font-size: 1.05em;
  background-color: rgba(0, 0, 0, 0.03);
  border-top-left-radius: 0.4rem;
  border-top-right-radius: 0.4rem;
  margin: 0 !important;
}

.admonition-icon {
  font-size: 1.2em;
  margin-right: 0.6rem;
  opacity: 0.85;
  margin-top: 0.1rem;
}

/* ÂÜÖÂÆπÂå∫Âüü margin */
.admonition > *:not(.admonition-title) {
  margin: 0.6rem 1rem 0.6rem 1rem;
}

/* NOTE Á±ªÂûã */
.admonition.anote {
  border-color: #448aff;
}
.admonition.anote > .admonition-title {
  background-color: #448aff1a;
  color: #2962ff;
}

/* INFO / TODO Á±ªÂûã */
.admonition.info,
.admonition.todo {
  border-color: #00b8d4;
}
.admonition.info > .admonition-title,
.admonition.todo > .admonition-title {
  background-color: rgba(0, 184, 212, 0.1);
  color: #007c91;
}

/* Ë≠¶ÂëäÁ±ª */
.admonition.warning,
.admonition.attention,
.admonition.caution {
  border-color: #ff9100;
}
.admonition.warning > .admonition-title,
.admonition.attention > .admonition-title,
.admonition.caution > .admonition-title {
  background-color: rgba(255, 145, 0, 0.1);
  color: #c66900;
}

/* ÈîôËØØÁ±ª */
.admonition.failure,
.admonition.missing,
.admonition.fail,
.admonition.error,
.admonition.danger,
.admonition.bug {
  border-color: #ff5252;
}
.admonition.failure > .admonition-title,
.admonition.missing > .admonition-title,
.admonition.fail > .admonition-title,
.admonition.error > .admonition-title,
.admonition.danger > .admonition-title,
.admonition.bug > .admonition-title {
  background-color: rgba(255, 82, 82, 0.1);
  color: #b71c1c;
}

/* TIP Á±ªÂûã */
.admonition.tip {
  border-color: #00bfa5;
}
.admonition.tip > .admonition-title {
  background-color: #00bfa51a;
  color: #00796b;
}

/* SUCCESS Á±ªÂûã */
.admonition.success {
  border-color: #00c853;
}
.admonition.success > .admonition-title {
  background-color: #00c8531a;
  color: #2e7d32;
}

/* QUESTION Á±ªÂûã */
.admonition.question {
  border-color: #64dd17;
}
.admonition.question > .admonition-title {
  background-color: #64dd171a;
  color: #558b2f;
}

/* EXAMPLE Á±ªÂûã */
.admonition.example {
  border-color: #7c4dff;
}
.admonition.example > .admonition-title {
  background-color: #7c4dff1a;
  color: #512da8;
}

/* QUOTE Á±ªÂûã */
.admonition.quote {
  border-color: #9e9e9e;
}
.admonition.quote > .admonition-title {
  background-color: #9e9e9e1a;
  color: #424242;
}

/*ÈªëÊöóÊ®°Âºè*/
/* Â§úÈó¥Ê®°ÂºèÂü∫Á°ÄÊ†∑Âºè */
[data-theme="dark"] .admonition {
  background-color: #1e1e1e;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.4);
}

[data-theme="dark"] .admonition-title {
  background-color: rgba(255, 255, 255, 0.05);
}

/* anote */
[data-theme="dark"] .admonition.anote {
  border-color: #82b1ff;
}
[data-theme="dark"] .admonition.anote > .admonition-title {
  background-color: #82b1ff1a;
  color: #bbdefb;
}

/* tip */
[data-theme="dark"] .admonition.tip {
  border-color: #64ffda;
}
[data-theme="dark"] .admonition.tip > .admonition-title {
  background-color: #64ffda1a;
  color: #1de9b6;
}

/* success */
[data-theme="dark"] .admonition.success {
  border-color: #69f0ae;
}
[data-theme="dark"] .admonition.success > .admonition-title {
  background-color: #69f0ae1a;
  color: #00e676;
}

/* question */
[data-theme="dark"] .admonition.question {
  border-color: #b2ff59;
}
[data-theme="dark"] .admonition.question > .admonition-title {
  background-color: #b2ff591a;
  color: #aeea00;
}

/* example */
[data-theme="dark"] .admonition.example {
  border-color: #b388ff;
}
[data-theme="dark"] .admonition.example > .admonition-title {
  background-color: #b388ff1a;
  color: #b39ddb;
}

/* quote */
[data-theme="dark"] .admonition.quote {
  border-color: #bdbdbd;
}
[data-theme="dark"] .admonition.quote > .admonition-title {
  background-color: #bdbdbd1a;
  color: #eeeeee;
}

/* warning / attention / caution */
[data-theme="dark"] .admonition.warning,
[data-theme="dark"] .admonition.attention,
[data-theme="dark"] .admonition.caution {
  border-color: #ffb300;
}
[data-theme="dark"] .admonition.warning > .admonition-title,
[data-theme="dark"] .admonition.attention > .admonition-title,
[data-theme="dark"] .admonition.caution > .admonition-title {
  background-color: #ffb3001a;
  color: #ffe082;
}

/* error / fail / failure / bug / danger / missing */
[data-theme="dark"] .admonition.error,
[data-theme="dark"] .admonition.fail,
[data-theme="dark"] .admonition.failure,
[data-theme="dark"] .admonition.bug,
[data-theme="dark"] .admonition.missing,
[data-theme="dark"] .admonition.danger {
  border-color: #ef5350;
}
[data-theme="dark"] .admonition.error > .admonition-title,
[data-theme="dark"] .admonition.fail > .admonition-title,
[data-theme="dark"] .admonition.failure > .admonition-title,
[data-theme="dark"] .admonition.bug > .admonition-title,
[data-theme="dark"] .admonition.missing > .admonition-title,
[data-theme="dark"] .admonition.danger > .admonition-title {
  background-color: #ef53501a;
  color: #ff8a80;
}</style><script id="mermaid-scripts" src="/cache/mermaid.min.local.js"></script>
<script>mermaid.initialize({theme: 'default'});</script></head>

<body>
    <div id="wrap">
        <header id="header">
    <div id="header-outer" class="outer">
        <div class="container">
            <div class="container-inner">
                <div id="header-title">
                    <h1 class="logo-wrap">
                        <a href="/" title="Homepage" class="logo"></a>
                    </h1>
                        <h2 class="subtitle-wrap">
                            <p class="title">Decoding Digital Anomalies</p>
                          <p class="subtitle">Sometimes the feature is the bug in the digital rabbit hole, and vice versa</p>
                        </h2>
                    <div id="lang-selector">
                        <span class="lang-icon">üåê</span>
                        
                            <a href="/zh-TW/2019/12/Federated-Identity-Pattern/" class="lang-link">ÁπÅÈ´î‰∏≠Êñá</a>
<span class="lang-sep">|</span>                            <a href="/zh-CN/2019/12/Federated-Identity-Pattern/" class="lang-link">ÁÆÄ‰Ωì‰∏≠Êñá</a>
                    </div>
                </div>
                <div id="header-inner" class="nav-container">
                    <a id="main-nav-toggle" class="nav-icon fa fa-bars"></a>
                    <div class="nav-container-inner">
                        <ul id="main-nav">
                            
                                <li class="main-nav-list-item">
                                    <a class="main-nav-list-link" href="/">Home</a>
                                </li>
                                                                    <ul class="main-nav-list"><li class="main-nav-list-item"><a class="main-nav-list-link" href="/categories/AI/">AI</a><ul class="main-nav-list-child"><li class="main-nav-list-item"><a class="main-nav-list-link" href="/categories/AI/Art-Gallery/">Art Gallery</a></li></ul></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/categories/Architecture/">Architecture</a></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/categories/Cybersecurity/">Cybersecurity</a></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/categories/Development/">Development</a></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/categories/Misc/">Misc</a></li></ul>
                                <li class="main-nav-list-item">
                                    <a class="main-nav-list-link" href="/about-me">About</a>
                                </li>
                            
                        </ul>
                        <nav id="sub-nav">
                            <div id="search-form-wrap">

    <form class="search-form">
        <input type="text" class="ins-search-input search-form-input" id="search-form-input" placeholder="Search">
        <button type="submit" title="Search" class="search-form-submit"></button>
    </form>
    <div class="ins-search">
    <div class="ins-search-mask"></div>
    <div class="ins-search-container">
        <div class="ins-input-wrapper">
            <input type="text" class="ins-search-input" id="ins-search-input" placeholder="Type something...">
            <span class="ins-close ins-selectable"><i class="fa fa-times-circle"></i></span>
        </div>
        <div class="ins-section-wrapper">
            <div class="ins-section-container"></div>
        </div>
    </div>
</div>
<script integrity="sha256-B5nfCL2Dym3Ba4YJFI7wB3f4vtClbrYJZ32A5erBEdg=">
(function (window) {
    var INSIGHT_CONFIG = {
        TRANSLATION: {
            POSTS: 'Posts',
            PAGES: 'Pages',
            CATEGORIES: 'Categories',
            TAGS: 'Tags',
            UNTITLED: '(Untitled)',
        },
        ROOT_URL: '/',
        CONTENT_URL: '/content.json',
        LANG: 'en',
    };
    window.INSIGHT_CONFIG = INSIGHT_CONFIG;
})(window);
</script>




</div>
                        </nav>
                    </div>
                </div>
            </div>
        </div>
    </div>
</header>
        <div class="container">
            <div class="main-body container-inner">
                <div class="main-body-inner">
                    <section id="main">
                        <div class="main-body-header">
    <h1 class="header">
    
    <a class="page-title-link" href="/categories/Architecture/">Architecture</a>
    </h1>
</div>

                        <div class="main-body-content">
                            <article id="post-2019/12/Federated-Identity-Pattern" class="article article-single article-type-post" itemscope="" itemprop="blogPost">
    <div class="article-inner responsive-content">
        
            <header class="article-header">
                
    
        <h1 class="article-title" itemprop="name">
        Federated Identity: One Login to Rule Them All
        </h1>
    

            </header>
        
        
            <div class="article-meta">
                
    <div class="article-date">
      <i class="fa fa-calendar"></i>
        
          Created <time datetime="2019-12-14T16:00:00.000Z" itemprop="datePublished">2019-12-15</time>
          &nbsp;<i class="fa fa-calendar"></i>
          Updated <time datetime="2025-10-13T16:01:20.146Z" itemprop="datePublished">2025-10-14</time>
        
    </div>


                

                
            </div>
        
        
        <div class="article-entry" itemprop="articleBody">
            <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#The-Challenge-Too-Many-Passwords-Too-Many-Problems"><span class="toc-text">The Challenge: Too Many Passwords, Too Many Problems</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#The-Solution-Federated-Identity"><span class="toc-text">The Solution: Federated Identity</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Core-Components"><span class="toc-text">Core Components</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Implementation-Example"><span class="toc-text">Implementation Example</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Home-Realm-Discovery"><span class="toc-text">Home Realm Discovery</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Benefits-of-Federated-Identity"><span class="toc-text">Benefits of Federated Identity</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Design-Considerations"><span class="toc-text">Design Considerations</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#When-to-Use-This-Pattern"><span class="toc-text">When to Use This Pattern</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Real-World-Example-Multi-Tenant-SaaS"><span class="toc-text">Real-World Example: Multi-Tenant SaaS</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Summary"><span class="toc-text">Summary</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Reference"><span class="toc-text">Reference</span></a></li></ol>
            <p>Imagine carrying a different key for every building you need to enter‚Äîyour office, the gym, the library, your apartment. Now imagine having one master key that works everywhere, but each building still controls who gets access. This is the essence of federated identity: one set of credentials, trusted across multiple systems, while each system maintains control over what you can do.</p>
<h2 id="The-Challenge-Too-Many-Passwords-Too-Many-Problems">The Challenge: Too Many Passwords, Too Many Problems</h2>
<p>In today‚Äôs interconnected world, users work with applications from multiple organizations‚Äîtheir employer, business partners, cloud service providers, and third-party tools. Each application traditionally requires its own authentication system.</p>
<h3 id="The-Traditional-Approach-Separate-Credentials-Everywhere">The Traditional Approach: Separate Credentials Everywhere</h3>
<pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token comment">// Each application manages its own users</span>
<span class="token keyword">class</span> <span class="token class-name">TraditionalAuthSystem</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>users <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Map</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  
  <span class="token keyword">async</span> <span class="token function">register</span><span class="token punctuation">(</span><span class="token parameter">username<span class="token punctuation">,</span> password<span class="token punctuation">,</span> email</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Store credentials in application database</span>
    <span class="token keyword">const</span> hashedPassword <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">hashPassword</span><span class="token punctuation">(</span>password<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>users<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>username<span class="token punctuation">,</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">password</span><span class="token operator">:</span> hashedPassword<span class="token punctuation">,</span>
      <span class="token literal-property property">email</span><span class="token operator">:</span> email<span class="token punctuation">,</span>
      <span class="token literal-property property">createdAt</span><span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  
  <span class="token keyword">async</span> <span class="token function">login</span><span class="token punctuation">(</span><span class="token parameter">username<span class="token punctuation">,</span> password</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> user <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>users<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>username<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>user<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">'User not found'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token keyword">const</span> isValid <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">verifyPassword</span><span class="token punctuation">(</span>password<span class="token punctuation">,</span> user<span class="token punctuation">.</span>password<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>isValid<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">'Invalid password'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">createSession</span><span class="token punctuation">(</span>username<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre>
<div class="admonition warning"><p class="admonition-title"><span class="mdi mdi-alert-outline admonition-icon"></span>‚ö†Ô∏è Problems with Traditional Authentication</p><div class="admonition-content"><p><strong>Disjointed User Experience</strong>: Users forget credentials when managing multiple accounts</p>
<p><strong>Security Vulnerabilities</strong>: Departing employees' accounts may not be deprovisioned promptly</p>
<p><strong>Administrative Burden</strong>: Managing users, passwords, and permissions across systems</p>
<p><strong>Development Overhead</strong>: Building and maintaining authentication infrastructure</p>
</div></div>
<h2 id="The-Solution-Federated-Identity">The Solution: Federated Identity</h2>
<p>Delegate authentication to trusted external identity providers. Users authenticate once with their identity provider, then access multiple applications without re-entering credentials.</p>
<div class="mermaid">graph LR
    User([User]) --&gt;|1. Access App| App[Application]
    App --&gt;|2. Redirect to IdP| IdP[Identity Provider]
    User --&gt;|3. Authenticate| IdP
    IdP --&gt;|4. Issue Token| STS[Security Token Service]
    STS --&gt;|5. Return Token with Claims| App
    App --&gt;|6. Grant Access| User
    
    style User fill:#4dabf7,stroke:#1971c2
    style App fill:#51cf66,stroke:#2f9e44
    style IdP fill:#ffd43b,stroke:#f59f00
    style STS fill:#ff8787,stroke:#c92a2a</div>
<h3 id="How-It-Works">How It Works</h3>
<ol>
<li><strong>User attempts to access application</strong>: The application detects the user is not authenticated</li>
<li><strong>Redirect to Identity Provider</strong>: Application redirects user to trusted identity provider</li>
<li><strong>User authenticates</strong>: User provides credentials to their identity provider</li>
<li><strong>Token issuance</strong>: Identity provider issues a security token containing claims about the user</li>
<li><strong>Token validation</strong>: Application validates the token and extracts user information</li>
<li><strong>Access granted</strong>: User accesses the application without creating new credentials</li>
</ol>
<h2 id="Core-Components">Core Components</h2>
<h3 id="1-Identity-Provider-IdP">1. Identity Provider (IdP)</h3>
<p>The trusted authority that authenticates users and issues tokens:</p>
<pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">class</span> <span class="token class-name">IdentityProvider</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">userDirectory</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>userDirectory <span class="token operator">=</span> userDirectory<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>trustedApplications <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Set</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  
  <span class="token keyword">async</span> <span class="token function">authenticate</span><span class="token punctuation">(</span><span class="token parameter">username<span class="token punctuation">,</span> password<span class="token punctuation">,</span> applicationId</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Verify application is trusted</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span>trustedApplications<span class="token punctuation">.</span><span class="token function">has</span><span class="token punctuation">(</span>applicationId<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">'Untrusted application'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token comment">// Authenticate user against directory</span>
    <span class="token keyword">const</span> user <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>userDirectory<span class="token punctuation">.</span><span class="token function">validateCredentials</span><span class="token punctuation">(</span>
      username<span class="token punctuation">,</span> 
      password
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>user<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">'Authentication failed'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token comment">// Issue token with claims</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">issueToken</span><span class="token punctuation">(</span>user<span class="token punctuation">,</span> applicationId<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  
  <span class="token function">issueToken</span><span class="token punctuation">(</span><span class="token parameter">user<span class="token punctuation">,</span> applicationId</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> claims <span class="token operator">=</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">userId</span><span class="token operator">:</span> user<span class="token punctuation">.</span>id<span class="token punctuation">,</span>
      <span class="token literal-property property">username</span><span class="token operator">:</span> user<span class="token punctuation">.</span>username<span class="token punctuation">,</span>
      <span class="token literal-property property">email</span><span class="token operator">:</span> user<span class="token punctuation">.</span>email<span class="token punctuation">,</span>
      <span class="token literal-property property">roles</span><span class="token operator">:</span> user<span class="token punctuation">.</span>roles<span class="token punctuation">,</span>
      <span class="token literal-property property">department</span><span class="token operator">:</span> user<span class="token punctuation">.</span>department<span class="token punctuation">,</span>
      <span class="token literal-property property">issuer</span><span class="token operator">:</span> <span class="token string">'corporate-idp'</span><span class="token punctuation">,</span>
      <span class="token literal-property property">audience</span><span class="token operator">:</span> applicationId<span class="token punctuation">,</span>
      <span class="token literal-property property">issuedAt</span><span class="token operator">:</span> Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token literal-property property">expiresAt</span><span class="token operator">:</span> Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token number">3600</span> <span class="token operator">*</span> <span class="token number">1000</span><span class="token punctuation">)</span> <span class="token comment">// 1 hour</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    
    <span class="token comment">// Sign the token</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">signToken</span><span class="token punctuation">(</span>claims<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre>
<h3 id="2-Security-Token-Service-STS">2. Security Token Service (STS)</h3>
<p>Transforms and augments tokens, establishing trust between identity providers and applications:</p>
<pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">class</span> <span class="token class-name">SecurityTokenService</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">trustedIdPs</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>trustedIdPs <span class="token operator">=</span> trustedIdPs<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>claimMappings <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Map</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  
  <span class="token keyword">async</span> <span class="token function">transformToken</span><span class="token punctuation">(</span><span class="token parameter">incomingToken<span class="token punctuation">,</span> targetApplication</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Verify token is from trusted IdP</span>
    <span class="token keyword">const</span> tokenInfo <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">validateToken</span><span class="token punctuation">(</span>incomingToken<span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span>trustedIdPs<span class="token punctuation">.</span><span class="token function">has</span><span class="token punctuation">(</span>tokenInfo<span class="token punctuation">.</span>issuer<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">'Token from untrusted issuer'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token comment">// Transform claims for target application</span>
    <span class="token keyword">const</span> transformedClaims <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">transformClaims</span><span class="token punctuation">(</span>
      tokenInfo<span class="token punctuation">.</span>claims<span class="token punctuation">,</span>
      targetApplication
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token comment">// Issue new token for target application</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">issueToken</span><span class="token punctuation">(</span>transformedClaims<span class="token punctuation">,</span> targetApplication<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  
  <span class="token function">transformClaims</span><span class="token punctuation">(</span><span class="token parameter">claims<span class="token punctuation">,</span> targetApplication</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> mapping <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>claimMappings<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>targetApplication<span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>mapping<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> claims<span class="token punctuation">;</span> <span class="token comment">// No transformation needed</span>
    <span class="token punctuation">}</span>
    
    <span class="token keyword">const</span> transformed <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
    
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token punctuation">[</span>sourceClaim<span class="token punctuation">,</span> targetClaim<span class="token punctuation">]</span> <span class="token keyword">of</span> mapping<span class="token punctuation">.</span><span class="token function">entries</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>claims<span class="token punctuation">[</span>sourceClaim<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        transformed<span class="token punctuation">[</span>targetClaim<span class="token punctuation">]</span> <span class="token operator">=</span> claims<span class="token punctuation">[</span>sourceClaim<span class="token punctuation">]</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    
    <span class="token comment">// Add application-specific claims</span>
    transformed<span class="token punctuation">.</span>applicationId <span class="token operator">=</span> targetApplication<span class="token punctuation">;</span>
    transformed<span class="token punctuation">.</span>transformedAt <span class="token operator">=</span> Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token keyword">return</span> transformed<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre>
<h3 id="3-Claims-Based-Access-Control">3. Claims-Based Access Control</h3>
<p>Applications authorize access based on claims in the token:</p>
<pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">class</span> <span class="token class-name">ClaimsBasedAuthorization</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>policies <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Map</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  
  <span class="token function">definePolicy</span><span class="token punctuation">(</span><span class="token parameter">resource<span class="token punctuation">,</span> requiredClaims</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>policies<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>resource<span class="token punctuation">,</span> requiredClaims<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  
  <span class="token keyword">async</span> <span class="token function">authorize</span><span class="token punctuation">(</span><span class="token parameter">token<span class="token punctuation">,</span> resource</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Extract claims from token</span>
    <span class="token keyword">const</span> claims <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">extractClaims</span><span class="token punctuation">(</span>token<span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token comment">// Get required claims for resource</span>
    <span class="token keyword">const</span> required <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>policies<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>resource<span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>required<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span> <span class="token comment">// No policy defined, allow access</span>
    <span class="token punctuation">}</span>
    
    <span class="token comment">// Check if user has required claims</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">evaluateClaims</span><span class="token punctuation">(</span>claims<span class="token punctuation">,</span> required<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  
  <span class="token function">evaluateClaims</span><span class="token punctuation">(</span><span class="token parameter">userClaims<span class="token punctuation">,</span> requiredClaims</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token punctuation">[</span>claimType<span class="token punctuation">,</span> requiredValue<span class="token punctuation">]</span> <span class="token keyword">of</span> Object<span class="token punctuation">.</span><span class="token function">entries</span><span class="token punctuation">(</span>requiredClaims<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> userValue <span class="token operator">=</span> userClaims<span class="token punctuation">[</span>claimType<span class="token punctuation">]</span><span class="token punctuation">;</span>
      
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>userValue<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span> <span class="token comment">// Missing required claim</span>
      <span class="token punctuation">}</span>
      
      <span class="token keyword">if</span> <span class="token punctuation">(</span>Array<span class="token punctuation">.</span><span class="token function">isArray</span><span class="token punctuation">(</span>requiredValue<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// Check if user has any of the required values</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>requiredValue<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span>userValue<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>userValue <span class="token operator">!==</span> requiredValue<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    
    <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// Usage example</span>
<span class="token keyword">const</span> authz <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ClaimsBasedAuthorization</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Define access policies</span>
authz<span class="token punctuation">.</span><span class="token function">definePolicy</span><span class="token punctuation">(</span><span class="token string">'/admin'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">role</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'admin'</span><span class="token punctuation">,</span> <span class="token string">'superuser'</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

authz<span class="token punctuation">.</span><span class="token function">definePolicy</span><span class="token punctuation">(</span><span class="token string">'/reports/financial'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">role</span><span class="token operator">:</span> <span class="token string">'manager'</span><span class="token punctuation">,</span>
  <span class="token literal-property property">department</span><span class="token operator">:</span> <span class="token string">'finance'</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Check authorization</span>
<span class="token keyword">const</span> canAccess <span class="token operator">=</span> <span class="token keyword">await</span> authz<span class="token punctuation">.</span><span class="token function">authorize</span><span class="token punctuation">(</span>userToken<span class="token punctuation">,</span> <span class="token string">'/admin'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<h2 id="Implementation-Example">Implementation Example</h2>
<p>Here‚Äôs a complete federated authentication flow:</p>
<pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">class</span> <span class="token class-name">FederatedApplication</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">identityProviderUrl<span class="token punctuation">,</span> applicationId<span class="token punctuation">,</span> secretKey</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>identityProviderUrl <span class="token operator">=</span> identityProviderUrl<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>applicationId <span class="token operator">=</span> applicationId<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>secretKey <span class="token operator">=</span> secretKey<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>authorization <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ClaimsBasedAuthorization</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  
  <span class="token comment">// Middleware to protect routes</span>
  <span class="token function">requireAuthentication</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> token <span class="token operator">=</span> req<span class="token punctuation">.</span>headers<span class="token punctuation">.</span>authorization<span class="token operator">?.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token string">'Bearer '</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>token<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// Redirect to identity provider</span>
        <span class="token keyword">const</span> redirectUrl <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">buildAuthenticationUrl</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>originalUrl<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token function">redirect</span><span class="token punctuation">(</span>redirectUrl<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      
      <span class="token keyword">try</span> <span class="token punctuation">{</span>
        <span class="token comment">// Validate token</span>
        <span class="token keyword">const</span> claims <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">validateToken</span><span class="token punctuation">(</span>token<span class="token punctuation">)</span><span class="token punctuation">;</span>
        
        <span class="token comment">// Attach user information to request</span>
        req<span class="token punctuation">.</span>user <span class="token operator">=</span> claims<span class="token punctuation">;</span>
        <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        res<span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span><span class="token number">401</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">error</span><span class="token operator">:</span> <span class="token string">'Invalid token'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  
  <span class="token function">buildAuthenticationUrl</span><span class="token punctuation">(</span><span class="token parameter">returnUrl</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> params <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">URLSearchParams</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token literal-property property">client_id</span><span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>applicationId<span class="token punctuation">,</span>
      <span class="token literal-property property">return_url</span><span class="token operator">:</span> returnUrl<span class="token punctuation">,</span>
      <span class="token literal-property property">response_type</span><span class="token operator">:</span> <span class="token string">'token'</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token keyword">return</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>identityProviderUrl<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/authenticate?</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>params<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  
  <span class="token keyword">async</span> <span class="token function">handleCallback</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> token <span class="token punctuation">}</span> <span class="token operator">=</span> req<span class="token punctuation">.</span>query<span class="token punctuation">;</span>
    
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
      <span class="token comment">// Validate token from IdP</span>
      <span class="token keyword">const</span> claims <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">validateToken</span><span class="token punctuation">(</span>token<span class="token punctuation">)</span><span class="token punctuation">;</span>
      
      <span class="token comment">// Create application session</span>
      <span class="token keyword">const</span> sessionToken <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">createSession</span><span class="token punctuation">(</span>claims<span class="token punctuation">)</span><span class="token punctuation">;</span>
      
      <span class="token comment">// Redirect to original destination</span>
      <span class="token keyword">const</span> returnUrl <span class="token operator">=</span> req<span class="token punctuation">.</span>query<span class="token punctuation">.</span>return_url <span class="token operator">||</span> <span class="token string">'/'</span><span class="token punctuation">;</span>
      res<span class="token punctuation">.</span><span class="token function">redirect</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>returnUrl<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">?token=</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>sessionToken<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      res<span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span><span class="token number">401</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">error</span><span class="token operator">:</span> <span class="token string">'Authentication failed'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  
  <span class="token keyword">async</span> <span class="token function">validateToken</span><span class="token punctuation">(</span><span class="token parameter">token</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Verify token signature</span>
    <span class="token keyword">const</span> payload <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">verifySignature</span><span class="token punctuation">(</span>token<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>secretKey<span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token comment">// Check expiration</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>payload<span class="token punctuation">.</span>expiresAt <span class="token operator">&lt;</span> Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">'Token expired'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token comment">// Verify audience</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>payload<span class="token punctuation">.</span>audience <span class="token operator">!==</span> <span class="token keyword">this</span><span class="token punctuation">.</span>applicationId<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">'Token not intended for this application'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token keyword">return</span> payload<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// Setup application</span>
<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> federatedApp <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FederatedApplication</span><span class="token punctuation">(</span>
  <span class="token string">'https://idp.company.com'</span><span class="token punctuation">,</span>
  <span class="token string">'my-application-id'</span><span class="token punctuation">,</span>
  process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">SECRET_KEY</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Callback endpoint for IdP</span>
app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/auth/callback'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  federatedApp<span class="token punctuation">.</span><span class="token function">handleCallback</span><span class="token punctuation">(</span>req<span class="token punctuation">,</span> res<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Protected routes</span>
app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/dashboard'</span><span class="token punctuation">,</span> 
  federatedApp<span class="token punctuation">.</span><span class="token function">requireAuthentication</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token literal-property property">message</span><span class="token operator">:</span> <span class="token string">'Welcome to dashboard'</span><span class="token punctuation">,</span>
      <span class="token literal-property property">user</span><span class="token operator">:</span> req<span class="token punctuation">.</span>user
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<h2 id="Home-Realm-Discovery">Home Realm Discovery</h2>
<p>When multiple identity providers are available, the system must determine which one to use:</p>
<pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">class</span> <span class="token class-name">HomeRealmDiscovery</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>providerMappings <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Map</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>defaultProvider <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  
  <span class="token function">registerProvider</span><span class="token punctuation">(</span><span class="token parameter">identifier<span class="token punctuation">,</span> providerUrl</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>providerMappings<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>identifier<span class="token punctuation">,</span> providerUrl<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  
  <span class="token function">setDefaultProvider</span><span class="token punctuation">(</span><span class="token parameter">providerUrl</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>defaultProvider <span class="token operator">=</span> providerUrl<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  
  <span class="token function">discoverProvider</span><span class="token punctuation">(</span><span class="token parameter">userIdentifier</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Extract domain from email</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>userIdentifier<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span><span class="token string">'@'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> domain <span class="token operator">=</span> userIdentifier<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">'@'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
      
      <span class="token comment">// Check if domain has mapped provider</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>providerMappings<span class="token punctuation">.</span><span class="token function">has</span><span class="token punctuation">(</span>domain<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>providerMappings<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>domain<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    
    <span class="token comment">// Check for subdomain-based discovery</span>
    <span class="token keyword">const</span> subdomain <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">extractSubdomain</span><span class="token punctuation">(</span>userIdentifier<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>subdomain <span class="token operator">&amp;&amp;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>providerMappings<span class="token punctuation">.</span><span class="token function">has</span><span class="token punctuation">(</span>subdomain<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>providerMappings<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>subdomain<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token comment">// Return default provider</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>defaultProvider<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  
  <span class="token keyword">async</span> <span class="token function">promptUserSelection</span><span class="token punctuation">(</span><span class="token parameter">availableProviders</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Present user with list of identity providers</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">providers</span><span class="token operator">:</span> Array<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>providerMappings<span class="token punctuation">.</span><span class="token function">entries</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>
        <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">[</span>name<span class="token punctuation">,</span> url<span class="token punctuation">]</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span> name<span class="token punctuation">,</span> url <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// Usage</span>
<span class="token keyword">const</span> discovery <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HomeRealmDiscovery</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Map domains to identity providers</span>
discovery<span class="token punctuation">.</span><span class="token function">registerProvider</span><span class="token punctuation">(</span><span class="token string">'company.com'</span><span class="token punctuation">,</span> <span class="token string">'https://idp.company.com'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
discovery<span class="token punctuation">.</span><span class="token function">registerProvider</span><span class="token punctuation">(</span><span class="token string">'partner.com'</span><span class="token punctuation">,</span> <span class="token string">'https://sso.partner.com'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
discovery<span class="token punctuation">.</span><span class="token function">registerProvider</span><span class="token punctuation">(</span><span class="token string">'social'</span><span class="token punctuation">,</span> <span class="token string">'https://social-idp.com'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Discover provider for user</span>
<span class="token keyword">const</span> provider <span class="token operator">=</span> discovery<span class="token punctuation">.</span><span class="token function">discoverProvider</span><span class="token punctuation">(</span><span class="token string">'user@company.com'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// Returns: https://idp.company.com</span></code></pre>
<h2 id="Benefits-of-Federated-Identity">Benefits of Federated Identity</h2>
<h3 id="1-Single-Sign-On-SSO">1. Single Sign-On (SSO)</h3>
<p>Users authenticate once and access multiple applications:</p>
<div class="mermaid">sequenceDiagram
    participant User
    participant App1
    participant App2
    participant IdP
    
    User-&gt;&gt;App1: Access Application 1
    App1-&gt;&gt;IdP: Redirect for authentication
    User-&gt;&gt;IdP: Provide credentials
    IdP-&gt;&gt;App1: Return token
    App1-&gt;&gt;User: Grant access
    
    Note over User,App2: Later, user accesses App2
    
    User-&gt;&gt;App2: Access Application 2
    App2-&gt;&gt;IdP: Check authentication
    IdP-&gt;&gt;App2: Return existing token
    App2-&gt;&gt;User: Grant access (no login required)</div>
<h3 id="2-Centralized-Identity-Management">2. Centralized Identity Management</h3>
<p>Identity provider manages all user accounts:</p>
<pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">class</span> <span class="token class-name">CentralizedIdentityManagement</span> <span class="token punctuation">{</span>
  <span class="token keyword">async</span> <span class="token function">onboardEmployee</span><span class="token punctuation">(</span><span class="token parameter">employee</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Create account in identity provider</span>
    <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>identityProvider<span class="token punctuation">.</span><span class="token function">createUser</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token literal-property property">username</span><span class="token operator">:</span> employee<span class="token punctuation">.</span>email<span class="token punctuation">,</span>
      <span class="token literal-property property">name</span><span class="token operator">:</span> employee<span class="token punctuation">.</span>name<span class="token punctuation">,</span>
      <span class="token literal-property property">department</span><span class="token operator">:</span> employee<span class="token punctuation">.</span>department<span class="token punctuation">,</span>
      <span class="token literal-property property">roles</span><span class="token operator">:</span> employee<span class="token punctuation">.</span>roles
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token comment">// Employee automatically has access to all applications</span>
    <span class="token comment">// No need to create accounts in each application</span>
  <span class="token punctuation">}</span>
  
  <span class="token keyword">async</span> <span class="token function">offboardEmployee</span><span class="token punctuation">(</span><span class="token parameter">employeeId</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Disable account in identity provider</span>
    <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>identityProvider<span class="token punctuation">.</span><span class="token function">disableUser</span><span class="token punctuation">(</span>employeeId<span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token comment">// Employee immediately loses access to all applications</span>
    <span class="token comment">// No need to deactivate accounts in each application</span>
  <span class="token punctuation">}</span>
  
  <span class="token keyword">async</span> <span class="token function">updateEmployeeRole</span><span class="token punctuation">(</span><span class="token parameter">employeeId<span class="token punctuation">,</span> newRole</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Update role in identity provider</span>
    <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>identityProvider<span class="token punctuation">.</span><span class="token function">updateUser</span><span class="token punctuation">(</span>employeeId<span class="token punctuation">,</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">roles</span><span class="token operator">:</span> <span class="token punctuation">[</span>newRole<span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token comment">// Role change propagates to all applications</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre>
<h3 id="3-Reduced-Development-Overhead">3. Reduced Development Overhead</h3>
<p>Applications don‚Äôt need to implement authentication:</p>
<pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token comment">// Before: Complex authentication logic</span>
<span class="token keyword">class</span> <span class="token class-name">ApplicationWithAuth</span> <span class="token punctuation">{</span>
  <span class="token keyword">async</span> <span class="token function">register</span><span class="token punctuation">(</span><span class="token parameter">user</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">/* ... */</span> <span class="token punctuation">}</span>
  <span class="token keyword">async</span> <span class="token function">login</span><span class="token punctuation">(</span><span class="token parameter">credentials</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">/* ... */</span> <span class="token punctuation">}</span>
  <span class="token keyword">async</span> <span class="token function">resetPassword</span><span class="token punctuation">(</span><span class="token parameter">email</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">/* ... */</span> <span class="token punctuation">}</span>
  <span class="token keyword">async</span> <span class="token function">verifyEmail</span><span class="token punctuation">(</span><span class="token parameter">token</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">/* ... */</span> <span class="token punctuation">}</span>
  <span class="token keyword">async</span> <span class="token function">enable2FA</span><span class="token punctuation">(</span><span class="token parameter">userId</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">/* ... */</span> <span class="token punctuation">}</span>
  <span class="token comment">// ... hundreds of lines of auth code</span>
<span class="token punctuation">}</span>

<span class="token comment">// After: Delegate to identity provider</span>
<span class="token keyword">class</span> <span class="token class-name">ApplicationWithFederation</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">identityProvider</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>identityProvider <span class="token operator">=</span> identityProvider<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  
  <span class="token keyword">async</span> <span class="token function">authenticate</span><span class="token punctuation">(</span><span class="token parameter">token</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Simply validate token</span>
    <span class="token keyword">return</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>identityProvider<span class="token punctuation">.</span><span class="token function">validateToken</span><span class="token punctuation">(</span>token<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre>
<h2 id="Design-Considerations">Design Considerations</h2>
<h3 id="1-Single-Point-of-Failure">1. Single Point of Failure</h3>
<p>Identity provider availability is critical:</p>
<div class="admonition warning"><p class="admonition-title"><span class="mdi mdi-alert-outline admonition-icon"></span>üîí Reliability Considerations</p><div class="admonition-content"><p><strong>Deploy across multiple datacenters</strong>: Ensure identity provider has high availability</p>
<p><strong>Implement caching</strong>: Cache tokens and validation results to handle temporary outages</p>
<p><strong>Graceful degradation</strong>: Allow limited functionality when IdP is unavailable</p>
<p><strong>Monitor health</strong>: Continuously monitor identity provider availability</p>
</div></div>
<pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">class</span> <span class="token class-name">ResilientTokenValidation</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">identityProvider<span class="token punctuation">,</span> cache</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>identityProvider <span class="token operator">=</span> identityProvider<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>cache <span class="token operator">=</span> cache<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  
  <span class="token keyword">async</span> <span class="token function">validateToken</span><span class="token punctuation">(</span><span class="token parameter">token</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Check cache first</span>
    <span class="token keyword">const</span> cached <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>cache<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">token:</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>token<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>cached<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> cached<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
      <span class="token comment">// Validate with identity provider</span>
      <span class="token keyword">const</span> claims <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>identityProvider<span class="token punctuation">.</span><span class="token function">validate</span><span class="token punctuation">(</span>token<span class="token punctuation">)</span><span class="token punctuation">;</span>
      
      <span class="token comment">// Cache successful validation</span>
      <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>cache<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">token:</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>token<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> claims<span class="token punctuation">,</span> <span class="token number">300</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 5 minutes</span>
      
      <span class="token keyword">return</span> claims<span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// If IdP is unavailable, check if we have cached validation</span>
      <span class="token keyword">const</span> fallback <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>cache<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">token:fallback:</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>token<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>fallback<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">warn</span><span class="token punctuation">(</span><span class="token string">'Using cached token validation due to IdP unavailability'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> fallback<span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      
      <span class="token keyword">throw</span> error<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre>
<h3 id="2-Social-Identity-Providers">2. Social Identity Providers</h3>
<p>Social providers offer limited user information:</p>
<pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">class</span> <span class="token class-name">SocialIdentityIntegration</span> <span class="token punctuation">{</span>
  <span class="token keyword">async</span> <span class="token function">handleSocialLogin</span><span class="token punctuation">(</span><span class="token parameter">socialToken<span class="token punctuation">,</span> provider</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Extract claims from social provider</span>
    <span class="token keyword">const</span> socialClaims <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">validateSocialToken</span><span class="token punctuation">(</span>socialToken<span class="token punctuation">,</span> provider<span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token comment">// Social providers typically only provide:</span>
    <span class="token comment">// - Unique identifier</span>
    <span class="token comment">// - Email (sometimes)</span>
    <span class="token comment">// - Name (sometimes)</span>
    
    <span class="token comment">// Check if user exists in application</span>
    <span class="token keyword">let</span> user <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">findUserBySocialId</span><span class="token punctuation">(</span>
      provider<span class="token punctuation">,</span>
      socialClaims<span class="token punctuation">.</span>id
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>user<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// First time login - need to register</span>
      user <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">registerSocialUser</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token literal-property property">socialProvider</span><span class="token operator">:</span> provider<span class="token punctuation">,</span>
        <span class="token literal-property property">socialId</span><span class="token operator">:</span> socialClaims<span class="token punctuation">.</span>id<span class="token punctuation">,</span>
        <span class="token literal-property property">email</span><span class="token operator">:</span> socialClaims<span class="token punctuation">.</span>email<span class="token punctuation">,</span>
        <span class="token literal-property property">name</span><span class="token operator">:</span> socialClaims<span class="token punctuation">.</span>name
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token comment">// Augment claims with application-specific information</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      <span class="token operator">...</span>socialClaims<span class="token punctuation">,</span>
      <span class="token literal-property property">userId</span><span class="token operator">:</span> user<span class="token punctuation">.</span>id<span class="token punctuation">,</span>
      <span class="token literal-property property">roles</span><span class="token operator">:</span> user<span class="token punctuation">.</span>roles<span class="token punctuation">,</span>
      <span class="token literal-property property">preferences</span><span class="token operator">:</span> user<span class="token punctuation">.</span>preferences
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre>
<h3 id="3-Token-Lifetime-and-Refresh">3. Token Lifetime and Refresh</h3>
<p>Manage token expiration and renewal:</p>
<pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">class</span> <span class="token class-name">TokenLifecycleManager</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">identityProvider</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>identityProvider <span class="token operator">=</span> identityProvider<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  
  <span class="token keyword">async</span> <span class="token function">issueTokenPair</span><span class="token punctuation">(</span><span class="token parameter">user</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Short-lived access token</span>
    <span class="token keyword">const</span> accessToken <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">createToken</span><span class="token punctuation">(</span>user<span class="token punctuation">,</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">'access'</span><span class="token punctuation">,</span>
      <span class="token literal-property property">expiresIn</span><span class="token operator">:</span> <span class="token number">900</span> <span class="token comment">// 15 minutes</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token comment">// Long-lived refresh token</span>
    <span class="token keyword">const</span> refreshToken <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">createToken</span><span class="token punctuation">(</span>user<span class="token punctuation">,</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">'refresh'</span><span class="token punctuation">,</span>
      <span class="token literal-property property">expiresIn</span><span class="token operator">:</span> <span class="token number">2592000</span> <span class="token comment">// 30 days</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token keyword">return</span> <span class="token punctuation">{</span> accessToken<span class="token punctuation">,</span> refreshToken <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  
  <span class="token keyword">async</span> <span class="token function">refreshAccessToken</span><span class="token punctuation">(</span><span class="token parameter">refreshToken</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Validate refresh token</span>
    <span class="token keyword">const</span> claims <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">validateToken</span><span class="token punctuation">(</span>refreshToken<span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token keyword">if</span> <span class="token punctuation">(</span>claims<span class="token punctuation">.</span>type <span class="token operator">!==</span> <span class="token string">'refresh'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">'Invalid token type'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token comment">// Issue new access token</span>
    <span class="token keyword">return</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">createToken</span><span class="token punctuation">(</span>claims<span class="token punctuation">,</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">'access'</span><span class="token punctuation">,</span>
      <span class="token literal-property property">expiresIn</span><span class="token operator">:</span> <span class="token number">900</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre>
<h2 id="When-to-Use-This-Pattern">When to Use This Pattern</h2>
<div class="admonition tip"><p class="admonition-title"><span class="mdi mdi-lightbulb-on-outline admonition-icon"></span>‚úÖ Ideal Scenarios</p><div class="admonition-content"><p><strong>Enterprise Single Sign-On</strong>: Employees access multiple corporate applications</p>
<p><strong>Multi-Partner Collaboration</strong>: Business partners need access without corporate accounts</p>
<p><strong>SaaS Applications</strong>: Multi-tenant applications where each tenant uses their own identity provider</p>
<p><strong>Consumer Applications</strong>: Allow users to sign in with social identity providers</p>
</div></div>
<div class="admonition warning"><p class="admonition-title"><span class="mdi mdi-alert-outline admonition-icon"></span>‚ùå Not Suitable When</p><div class="admonition-content"><p><strong>Single Identity Provider</strong>: All users authenticate with one system accessible to the application</p>
<p><strong>Legacy Systems</strong>: Application cannot handle modern authentication protocols</p>
<p><strong>Highly Isolated Systems</strong>: Security requirements prohibit external authentication</p>
</div></div>
<h2 id="Real-World-Example-Multi-Tenant-SaaS">Real-World Example: Multi-Tenant SaaS</h2>
<pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">class</span> <span class="token class-name">MultiTenantSaaS</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>tenants <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Map</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>sts <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SecurityTokenService</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  
  <span class="token keyword">async</span> <span class="token function">registerTenant</span><span class="token punctuation">(</span><span class="token parameter">tenantId<span class="token punctuation">,</span> identityProviderConfig</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Register tenant's identity provider</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>tenants<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>tenantId<span class="token punctuation">,</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">id</span><span class="token operator">:</span> tenantId<span class="token punctuation">,</span>
      <span class="token literal-property property">identityProvider</span><span class="token operator">:</span> identityProviderConfig<span class="token punctuation">,</span>
      <span class="token literal-property property">users</span><span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">Set</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token comment">// Configure STS to trust tenant's IdP</span>
    <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>sts<span class="token punctuation">.</span><span class="token function">addTrustedProvider</span><span class="token punctuation">(</span>
      identityProviderConfig<span class="token punctuation">.</span>issuer<span class="token punctuation">,</span>
      identityProviderConfig<span class="token punctuation">.</span>publicKey
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  
  <span class="token keyword">async</span> <span class="token function">authenticateUser</span><span class="token punctuation">(</span><span class="token parameter">token</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Validate token with STS</span>
    <span class="token keyword">const</span> claims <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>sts<span class="token punctuation">.</span><span class="token function">validateToken</span><span class="token punctuation">(</span>token<span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token comment">// Determine tenant from token</span>
    <span class="token keyword">const</span> tenantId <span class="token operator">=</span> claims<span class="token punctuation">.</span>tenantId<span class="token punctuation">;</span>
    <span class="token keyword">const</span> tenant <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>tenants<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>tenantId<span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>tenant<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">'Unknown tenant'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token comment">// Verify user belongs to tenant</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>tenant<span class="token punctuation">.</span>users<span class="token punctuation">.</span><span class="token function">has</span><span class="token punctuation">(</span>claims<span class="token punctuation">.</span>userId<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// First time user - add to tenant</span>
      tenant<span class="token punctuation">.</span>users<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>claims<span class="token punctuation">.</span>userId<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">user</span><span class="token operator">:</span> claims<span class="token punctuation">,</span>
      <span class="token literal-property property">tenant</span><span class="token operator">:</span> tenant
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre>
<h2 id="Summary">Summary</h2>
<p>Federated identity transforms authentication from a burden into an enabler. By delegating authentication to trusted identity providers, you:</p>
<ul>
<li><strong>Improve user experience</strong> with single sign-on</li>
<li><strong>Enhance security</strong> with centralized identity management</li>
<li><strong>Reduce development effort</strong> by avoiding custom authentication</li>
<li><strong>Enable collaboration</strong> across organizational boundaries</li>
</ul>
<p>The pattern is particularly powerful in enterprise and multi-tenant scenarios where users need seamless access to multiple applications while maintaining security and control.</p>
<h2 id="Reference">Reference</h2>
<ul>
<li><a target="_blank" rel="noopener" href="https://learn.microsoft.com/en-us/azure/architecture/patterns/federated-identity">Federated Identity Pattern - Microsoft Learn</a></li>
</ul>

        </div>
        <footer class="article-footer">
            
    <a data-url="https://neo01.com/2019/12/Federated-Identity-Pattern/" data-id="2f643d80" class="article-share-link"><i class="fa fa-share"></i>Share</a>
<script>
    (function ($) {
        $('body').on('click', function() {
            $('.article-share-box.on').removeClass('on');
        }).on('click', '.article-share-link', function(e) {
            e.stopPropagation();

            var $this = $(this),
                url = $this.attr('data-url').replace("http://","https://"),
                encodedUrl = encodeURIComponent(url),
                id = 'article-share-box-' + $this.attr('data-id'),
                offset = $this.offset(),
                box;

            if ($('#' + id).length) {
                box = $('#' + id);

                if (box.hasClass('on')){
                    box.removeClass('on');
                    return;
                }
            } else {
                var html = [
                    '<div id="' + id + '" class="article-share-box">',
                        '<input class="article-share-input" value="' + url + '">',
                        '<div class="article-share-links">',
                            '<a href="https://twitter.com/intent/tweet?url=' + encodedUrl + '" class="article-share-twitter" target="_blank" title="Twitter"></a>',
                            '<a href="https://www.facebook.com/sharer.php?u=' + encodedUrl + '" class="article-share-facebook" target="_blank" title="Facebook"></a>',
                            '<a href="http://pinterest.com/pin/create/button/?url=' + encodedUrl + '" class="article-share-pinterest" target="_blank" title="Pinterest"></a>',
                        '</div>',
                    '</div>'
                ].join('');

              box = $(html);

              $('body').append(box);
            }

            $('.article-share-box.on').hide();

            box.css({
                top: offset.top + 25,
                left: offset.left
            }).addClass('on');

        }).on('click', '.article-share-box', function (e) {
            e.stopPropagation();
        }).on('click', '.article-share-box-input', function () {
            $(this).select();
        }).on('click', '.article-share-box-link', function (e) {
            e.preventDefault();
            e.stopPropagation();

            window.open(this.href, 'article-share-box-window-' + Date.now(), 'width=500,height=450');
        });
    })(jQuery);
</script>

        </footer>
    </div>
    <!--script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "BlogPosting",
        "author": {
            "@type": "Person",
            "name": "Neo Alienson"
        },
        "headline": "Federated Identity: One Login to Rule Them All",
        "image": "https://neo01.com/assets/architecture/thumbnail.png",
        "keywords": "",
        "genre": "Architecture",
        "datePublished": "2019-12-15",
        "dateCreated": "2019-12-15",
        "dateModified": "2025-10-14",
        "url": "https://neo01.com/2019/12/Federated-Identity-Pattern/",
        "description": "Delegate authentication to external identity providers to simplify development, reduce administrative overhead, and improve user experience across multiple applications and organizations.",
        "wordCount": 7476
    }
</script-->

</article>

                        </div>
                    </section>
                    <aside id="sidebar">
    <a class="sidebar-toggle" title="Expand Sidebar"><i class="toggle icon"></i></a>
    <div class="sidebar-top">
        <p>follow:</p>
        <ul class="social-links">
                <li>
                    <a class="social-tooltip" title="stack-exchange" href="https://stackexchange.com/users/2122053/neo?tab=accounts" target="_blank" rel="noopener">
                        <i class="icon fa-brands fa-stack-exchange"></i>
                    </a>
                </li>
                <li>
                    <a class="social-tooltip" title="stack-overflow" href="https://stackoverflow.com/users/1885105/neo" target="_blank" rel="noopener">
                        <i class="icon fa-brands fa-stack-overflow"></i>
                    </a>
                </li>
                <li>
                    <a class="social-tooltip" title="github" href="https://github.com/neoalienson" target="_blank" rel="noopener">
                        <i class="icon fa-brands fa-github"></i>
                    </a>
                </li>
                <li>
                    <a class="social-tooltip" title="linkedin" href="https://linkedin.com/in/neo01" target="_blank" rel="noopener">
                        <i class="icon fa-brands fa-linkedin"></i>
                    </a>
                </li>
                <li>
                    <a class="social-tooltip" title="rss" href="/atom.xml" target="_blank" rel="noopener">
                        <i class="icon fa fa-rss"></i>
                    </a>
                </li>
        </ul>
    </div>
    <div class="widgets-container">
        
            
                <div class="widget-wrap widget-list">
    <h3 class="widget-title">links</h3>
    <div class="widget">
        <ul><li><a href="/ai">AI Playground</a></li><li><a href="/tools">Tools</a></li><li><a href="/games">Games</a></li><li><a href="/pages/useful-information">Useful Information</a></li><li><a href="/pages/Hexo-Blogging-Cheatsheet">Hexo Blogging Cheatsheet</a></li></ul>
    </div>
</div>

            
                    <div class="widget-wrap">
        <h3 class="widget-title">recents</h3>
        <div class="widget">
            <ul id="recent-post" class="">
                    <li>
                        <div class="item-thumbnail">
                            <a href="/2025/10/Tools-Games-And-Browser-Built-In-AI/" class="thumbnail">
        <span style="background-image:url(/2025/10/Tools-Games-And-Browser-Built-In-AI/thumbnail.jpeg)" alt="Tools, Games and Browser Built-in AI Playground" class="thumbnail-image"></span>
</a>
                        </div>
                        <div class="item-inner">
                            <p class="item-category"><a class="article-category-link" href="/categories/AI/">AI</a></p>
                            <p class="item-title"><a href="/2025/10/Tools-Games-And-Browser-Built-In-AI/" class="title">Tools, Games and Browser Built-in AI Playground</a></p>
                            <p class="item-date"><time datetime="2025-10-01T16:00:00.000Z" itemprop="datePublished">2025-10-02</time></p>
                        </div>
                    </li>
                    <li>
                        <div class="item-thumbnail">
                            <a href="/2025/09/The_Rise_of_Agentic_Coding_AI_Powered_Software_Engineering/" class="thumbnail">
        <span style="background-image:url(/2025/09/The_Rise_of_Agentic_Coding_AI_Powered_Software_Engineering/thumbnail.jpeg)" alt="The Rise of Agentic Coding: AI-Powered Software Engineering" class="thumbnail-image"></span>
</a>
                        </div>
                        <div class="item-inner">
                            <p class="item-category"><a class="article-category-link" href="/categories/AI/">AI</a></p>
                            <p class="item-title"><a href="/2025/09/The_Rise_of_Agentic_Coding_AI_Powered_Software_Engineering/" class="title">The Rise of Agentic Coding: AI-Powered Software Engineering</a></p>
                            <p class="item-date"><time datetime="2025-09-19T16:00:00.000Z" itemprop="datePublished">2025-09-20</time></p>
                        </div>
                    </li>
                    <li>
                        <div class="item-thumbnail">
                            <a href="/2025/08/Understanding_Ephemeral_Ports_Part2/" class="thumbnail">
        <span style="background-image:url(/2025/08/Understanding_Ephemeral_Ports_Part1/thumbnail.png)" alt="Understanding Ephemeral Ports Part 2: Why Server Applications Should Avoid Dynamic Ports" class="thumbnail-image"></span>
</a>
                        </div>
                        <div class="item-inner">
                            <p class="item-category"><a class="article-category-link" href="/categories/Development/">Development</a></p>
                            <p class="item-title"><a href="/2025/08/Understanding_Ephemeral_Ports_Part2/" class="title">Understanding Ephemeral Ports Part 2: Why Server Applications Should Avoid Dynamic Ports</a></p>
                            <p class="item-date"><time datetime="2025-08-30T16:00:00.000Z" itemprop="datePublished">2025-08-31</time></p>
                        </div>
                    </li>
                    <li>
                        <div class="item-thumbnail">
                            <a href="/2025/08/Understanding_Ephemeral_Ports_Part1/" class="thumbnail">
        <span style="background-image:url(/2025/08/Understanding_Ephemeral_Ports_Part1/thumbnail.png)" alt="Understanding Ephemeral Ports: The Invisible Workers of Network Communication" class="thumbnail-image"></span>
</a>
                        </div>
                        <div class="item-inner">
                            <p class="item-category"><a class="article-category-link" href="/categories/Development/">Development</a></p>
                            <p class="item-title"><a href="/2025/08/Understanding_Ephemeral_Ports_Part1/" class="title">Understanding Ephemeral Ports: The Invisible Workers of Network Communication</a></p>
                            <p class="item-date"><time datetime="2025-08-29T16:00:00.000Z" itemprop="datePublished">2025-08-30</time></p>
                        </div>
                    </li>
                    <li>
                        <div class="item-thumbnail">
                            <a href="/2025/07/Architecture_As_Code_Part_2_Building_the_Foundation/" class="thumbnail">
        <span style="background-image:url(/2025/07/Architecture_As_Code_Part_2_Building_the_Foundation/thumbnail.jpg)" alt="Architecture as Code: Part 2 - Building the Foundation" class="thumbnail-image"></span>
</a>
                        </div>
                        <div class="item-inner">
                            <p class="item-category"><a class="article-category-link" href="/categories/Architecture/">Architecture</a></p>
                            <p class="item-title"><a href="/2025/07/Architecture_As_Code_Part_2_Building_the_Foundation/" class="title">Architecture as Code: Part 2 - Building the Foundation</a></p>
                            <p class="item-date"><time datetime="2025-07-19T16:00:00.000Z" itemprop="datePublished">2025-07-20</time></p>
                        </div>
                    </li>
            </ul>
        </div>
    </div>

            
                
    
    
    <div class="widget-wrap widget-list">
        <h3 class="widget-title">archives</h3>
        <div class="widget">
            <ul class="archive-list">
            
                <li class="archive-list-item">
                    <a class="archive-list-link" href="/archives/2025/">2025</a>
                    <span class="archive-list-count">11</span>
                </li>
            
                <li class="archive-list-item">
                    <a class="archive-list-link" href="/archives/2024/">2024</a>
                    <span class="archive-list-count">24</span>
                </li>
            
                <li class="archive-list-item">
                    <a class="archive-list-link" href="/archives/2023/">2023</a>
                    <span class="archive-list-count">12</span>
                </li>
            
                <li class="archive-list-item">
                    <a class="archive-list-link" href="/archives/2022/">2022</a>
                    <span class="archive-list-count">2</span>
                </li>
            
                <li class="archive-list-item">
                    <a class="archive-list-link" href="/archives/2020/">2020</a>
                    <span class="archive-list-count">5</span>
                </li>
            
                <li class="archive-list-item">
                    <a class="archive-list-link" href="/archives/2019/">2019</a>
                    <span class="archive-list-count">12</span>
                </li>
            
                <li class="archive-list-item">
                    <a class="archive-list-link" href="/archives/2018/">2018</a>
                    <span class="archive-list-count">2</span>
                </li>
            
                <li class="archive-list-item">
                    <a class="archive-list-link" href="/archives/2017/">2017</a>
                    <span class="archive-list-count">5</span>
                </li>
            
                <li class="archive-list-item">
                    <a class="archive-list-link" href="/archives/2016/">2016</a>
                    <span class="archive-list-count">4</span>
                </li>
            
                <li class="archive-list-item">
                    <a class="archive-list-link" href="/archives/2015/">2015</a>
                    <span class="archive-list-count">6</span>
                </li>
            
                <li class="archive-list-item">
                    <a class="archive-list-link" href="/archives/2014/">2014</a>
                    <span class="archive-list-count">7</span>
                </li>
            
                <li class="archive-list-item">
                    <a class="archive-list-link" href="/archives/2013/">2013</a>
                    <span class="archive-list-count">2</span>
                </li>
            
            </ul>
        </div>
    </div>


            
        
    </div>
</aside>

                </div>
            </div>
        </div>
        <!-- disable caching cause each page has different footer from qrcode -->
        <!-- common/footer, null, {cache: !config.relative_link})  -->
        <footer id="footer">
    <div class="container">
        <div class="container-inner">
            <a id="back-to-top" href="javascript:;"><i class="icon fa fa-angle-up"></i></a>
            <div class="qrcode-share-wrapper">
                <div class="qrcode-text">https://neo01.com/l#6975e4f5</div>
                <img src="/qr/qr-ad465879044662de641ba70a145fd1f9.svg" width="200" height="200" alt="QR Code for https://neo01.com/l#6975e4f5">
            </div>
            <div class="credit">
                <h1 class="logo-wrap">
                    <a href="/" title="Homepage" class="logo"></a>
                </h1>
                
                <p>¬© 2025 Neo Alienson. All rights reserved.
                  <a href="/terms-and-conditions">Terms and Conditions</a></p>
                
            </div>
            <div class="footer-plugins">
              


            </div>
        </div>
    </div>
</footer>

        
    
        


        


        


        


        


        


        


        


        


    



<!-- Custom Scripts -->




    </div>
<!-- hexo injector body_end start --><script type="text/javascript" src="/js/bundle_last.js"></script><!-- hexo injector body_end end -->

</body></html>